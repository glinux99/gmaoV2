import{T as De}from"./index-CrFEKHH1.js";import{u as Ae,a as Ne,b as Le,r as b,d as S,T as Re,w as W,l as m,i as r,f as c,g as e,z as ce,m as E,F as L,c as Q,o as d,Z as Oe,j as s,t as i,p as f,n as Z,s as Ie,k as Ke,q as M,e as y,A as Ee,h as G}from"./app-gDNqx2_D.js";import{_ as Me}from"./AppLayout-SGD7JHFV.js";import{u as He,s as qe}from"./index-DXCPR8lg.js";import{s as x}from"./index-BFXGy4uN.js";import{s as D}from"./index-DnMOyY1I.js";import{a as Be,s as g}from"./index-C2t85Ev4.js";import{s as ue}from"./index-bSGFH6Vt.js";import{s as z}from"./index-qtJx-Jx6.js";import{s as pe}from"./index-CadKbAM9.js";import{s as Pe}from"./index-psDJnd0s.js";import{s as We}from"./index-D4DTux10.js";import{a as Qe,s as Ze}from"./index-3Y3FmX7C.js";import{s as I}from"./index-BHExvObj.js";import{s as Ge}from"./index-tkdp3lW-.js";import{s as Je}from"./index-LIEjb82k.js";import{s as Xe}from"./index-5fxx7ZJm.js";import{s as Ye}from"./index-CgEOIfNi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DIW2SyDI.js";import"./index-E0OnojZQ.js";import"./index-qcYzN5_Q.js";import"./index-DWMCXZ5G.js";import"./index-Sf75UUsw.js";import"./index-Dqyvdu4C.js";import"./index-C57fO0mp.js";import"./index-CaNPRaEQ.js";const et={class:"p-4 lg:p-10 bg-[#F8FAFC] min-h-screen"},tt={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-10"},st={class:"flex items-center gap-4"},lt=s("div",{class:"w-14 h-14 bg-primary-600 rounded-2xl flex items-center justify-center shadow-xl shadow-primary-100 rotate-3"},[s("i",{class:"pi pi-key text-white text-xl"})],-1),at=["innerHTML"],ot={class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},nt={class:"flex gap-3 bg-white p-2 rounded-2xl shadow-sm border border-slate-100"},it={key:0,class:"flex gap-2"},rt={class:"flex gap-2"},dt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},ct={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},ut=s("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[s("i",{class:"pi pi-key text-2xl text-slate-500"})],-1),pt={class:"text-2xl font-black text-slate-800"},mt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},ft={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},_t=s("div",{class:"w-14 h-14 rounded-xl bg-green-50 flex items-center justify-center"},[s("i",{class:"pi pi-check-circle text-2xl text-green-500"})],-1),xt={class:"text-2xl font-black text-slate-800"},bt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},vt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},ht=s("div",{class:"w-14 h-14 rounded-xl bg-red-50 flex items-center justify-center"},[s("i",{class:"pi pi-exclamation-triangle text-2xl text-red-500"})],-1),yt={class:"text-2xl font-black text-slate-800"},gt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},kt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},wt=s("div",{class:"w-14 h-14 rounded-xl bg-sky-50 flex items-center justify-center"},[s("i",{class:"pi pi-inbox text-2xl text-sky-500"})],-1),Vt={class:"text-2xl font-black text-slate-800"},Ct={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Tt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},St={class:"lg:col-span-2"},zt={class:"text-sm font-black text-slate-600 uppercase tracking-widest mb-4"},Ft={key:0,class:"flex flex-wrap gap-4"},Ut=["onClick"],$t=s("div",{class:"w-10 h-10 rounded-lg bg-sky-100 flex items-center justify-center"},[s("i",{class:"pi pi-map-marker text-lg text-sky-600"})],-1),jt={class:"text-xl font-black text-slate-800"},Dt={class:"text-[10px] font-bold text-slate-500 uppercase tracking-wider"},At={key:1,class:"text-center py-4 bg-white rounded-xl border border-slate-200 text-slate-400 italic text-sm"},Nt={key:2,class:"mt-6 p-6 bg-primary-50 border-2 border-dashed border-primary-200 rounded-2xl animate-fade-in"},Lt={class:"flex justify-between items-center mb-4"},Rt={class:"text-sm font-black text-primary-800 uppercase tracking-widest"},Ot={class:"text-primary-600"},It={class:"flex flex-wrap gap-3"},Kt=s("div",{class:"w-8 h-8 rounded-md bg-primary-100 flex items-center justify-center"},[s("i",{class:"pi pi-compass text-sm text-primary-700"})],-1),Et={class:"text-lg font-black text-slate-800"},Mt={class:"text-[9px] font-bold text-primary-600/80 uppercase tracking-wider"},Ht={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm"},qt={class:"text-sm font-black text-slate-600 uppercase tracking-widest mb-4"},Bt={class:"flex justify-center items-center h-48"},Pt={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-200/60 overflow-hidden"},Wt={class:"flex justify-between items-center p-4"},Qt={class:"flex items-center gap-2"},Zt={class:"flex items-center gap-4"},Gt=s("div",{class:"w-12 h-12 rounded-xl flex items-center justify-center bg-slate-100"},[s("i",{class:"pi pi-key text-slate-500"})],-1),Jt={class:"flex flex-col"},Xt=["onClick"],Yt={class:"text-[10px] font-mono text-slate-400 tracking-tighter"},es=["href"],ts=s("i",{class:"pi pi-user text-primary-400 text-xs group-hover:text-primary-600"},null,-1),ss={class:"text-sm font-bold text-slate-600 group-hover:text-primary-600 group-hover:underline"},ls={key:1,class:"text-slate-400 text-xs italic"},as=["href"],os=s("i",{class:"pi pi-bolt text-primary-400 text-xs group-hover:text-primary-600"},null,-1),ns={class:"text-sm font-bold text-slate-600 group-hover:text-primary-600 group-hover:underline"},is={key:1,class:"text-slate-400 text-xs italic"},rs={class:"text-xs font-medium text-slate-500"},ds={class:"text-xs font-medium text-slate-500"},cs={class:"text-xs font-medium text-slate-500"},us={class:"text-xs font-medium text-slate-500"},ps={class:"text-xs font-medium text-slate-500"},ms=["title"],fs={class:"flex gap-2 justify-end"},_s={class:"text-sm font-black text-slate-800 mb-4"},xs={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50 rounded-xl"},bs={class:"flex items-center gap-4"},vs=s("div",{class:"p-2.5 bg-blue-500/20 rounded-xl border border-blue-500/30"},[s("i",{class:"pi pi-key text-blue-400 text-xl"})],-1),hs={class:"flex flex-col"},ys={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},gs={class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"},ks={class:"p-8 bg-white max-h-[70vh] overflow-y-auto scroll-smooth"},ws={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 py-4"},Vs={class:"flex flex-col gap-2 md:col-span-2"},Cs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Ts={class:"flex flex-col gap-2"},Ss={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},zs={class:"flex flex-col gap-2"},Fs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Us={class:"flex flex-col gap-2"},$s={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},js={class:"flex flex-col gap-2"},Ds={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},As={class:"flex flex-col gap-2"},Ns={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Ls={key:0,class:"flex items-center gap-2 overflow-hidden"},Rs={class:"flex flex-row items-center gap-2 truncate"},Os={class:"text-xs font-semibold text-slate-900 leading-none"},Is={class:"text-[10px] text-indigo-600 font-bold uppercase leading-none"},Ks={key:0,class:"pi pi-exclamation-triangle text-red-500 text-[10px]"},Es={key:1,class:"text-xs text-slate-400 font-normal"},Ms={class:"flex items-center justify-between w-full py-0"},Hs={class:"flex flex-col py-1"},qs={class:"text-xs font-bold text-slate-800 leading-tight"},Bs={class:"flex items-center gap-1"},Ps={class:"text-[9px] text-slate-500 uppercase tracking-tighter"},Ws={class:"flex gap-1"},Qs={class:"py-1 px-3 border-t bg-slate-50 text-[9px] text-slate-400 italic"},Zs={class:"flex flex-col gap-2"},Gs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Js={key:0},Xs={key:1},Ys={class:"flex justify-between items-center w-full"},el={class:"font-bold"},tl={key:0,class:"text-xs text-slate-500 ml-4 flex items-center gap-1"},sl=s("i",{class:"pi pi-user text-[9px]"},null,-1),ll={class:"flex flex-col gap-2"},al={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},ol={class:"flex flex-col gap-2"},nl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},il={class:"flex flex-col gap-2"},rl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},dl={class:"flex flex-col gap-2 md:col-span-2"},cl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},ul={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},pl={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50 rounded-xl"},ml={class:"flex items-center gap-4"},fl=s("div",{class:"p-2.5 bg-blue-500/20 rounded-xl border border-blue-500/30"},[s("i",{class:"pi pi-arrows-h text-blue-400 text-xl"})],-1),_l={class:"flex flex-col"},xl={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},bl=s("span",{class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"},"Mouvement inter-régional",-1),vl={class:"p-8 bg-white max-h-[70vh] overflow-y-auto scroll-smooth space-y-6"},hl={class:"flex flex-col gap-2"},yl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},gl={key:0,class:"p-error"},kl={class:"flex flex-col gap-2"},wl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Vl={class:"flex items-center justify-between w-full"},Cl={class:"flex flex-col"},Tl={class:"font-bold text-sm"},Sl={class:"flex items-center gap-2 text-xs text-slate-500"},zl=s("i",{class:"pi pi-map-marker text-[10px]"},null,-1),Fl={class:"font-semibold text-slate-600"},Ul=s("i",{class:"pi pi-angle-right text-[8px] text-primary-500"},null,-1),$l={class:"font-black text-primary-600"},jl={class:"p-4 bg-slate-50 rounded-2xl border border-slate-100"},Dl={class:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3"},Al={class:"max-h-48 overflow-y-auto space-y-2 pr-2"},Nl={class:"text-sm font-bold text-slate-700"},Ll={key:0,class:"text-center py-4 text-slate-400 italic text-xs"},Rl={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},ua={__name:"Keypads",props:{keypads:Object,filters:Object,connections:Array,regions:Array,zones:Array,meters:Array,queryParams:Object,installed:Number,available:Number,faulty:Number,total:Number},setup(k){var re,de;const{t:l}=Ae(),_=k,R=Ne(),J=Le(),X=b(),U=b(!1),w=b(!1),C=b([]),Y=b(),me=b([{field:"serial_number",header:l("keypads.table.serial_number")},{field:"model",header:l("keypads.table.model")},{field:"manufacturer",header:l("keypads.table.manufacturer")},{field:"type",header:l("keypads.table.type")},{field:"status",header:l("keypads.table.status")},{field:"connection_full_name",header:l("keypads.table.connection_full_name")},{field:"meter_serial_number",header:l("keypads.table.meter_serial_number")},{field:"installation_date",header:l("keypads.table.installation_date")},{field:"region_name",header:l("keypads.table.region_name")},{field:"zone_name",header:l("keypads.table.zone_name")},{field:"notes",header:l("keypads.table.notes")}]),v=b(["serial_number","status","connection_full_name","meter_serial_number","region_name"]),$=b(),ee=()=>{$.value={global:{value:null,matchMode:L.CONTAINS},serial_number:{operator:Q.AND,constraints:[{value:null,matchMode:L.STARTS_WITH}]},type:{value:null,matchMode:L.EQUALS},status:{value:null,matchMode:L.EQUALS},"connection.full_name":{operator:Q.AND,constraints:[{value:null,matchMode:L.STARTS_WITH}]},"meter.serial_number":{operator:Q.AND,constraints:[{value:null,matchMode:L.STARTS_WITH}]}}};ee();const H=b(!1),V=b({first:_.keypads.from-1,rows:_.keypads.per_page,sortField:((re=_.queryParams)==null?void 0:re.sortField)||"created_at",sortOrder:((de=_.queryParams)==null?void 0:de.sortOrder)==="desc"?-1:1,filters:$.value}),q=o=>{H.value=!0,V.value={...V.value,...o};const a={...V.value,page:V.value.first/V.value.rows+1,sortOrder:V.value.sortOrder===1?"asc":"desc"};G.get(route("keypads.index"),a,{preserveState:!0,onFinish:()=>{H.value=!1}})},fe=o=>q(o),_e=o=>q(o),xe=o=>{V.value.filters=$.value,q(o)},j=S(()=>({total:_.total,available:_.available??0,installed:_.installed,faulty:_.faulty??0})),te=S(()=>{const o={};return _.keypads.data.forEach(a=>{var u;if(a.status==="available"&&a.region){const t=((u=a.region)==null?void 0:u.designation)||"Non spécifiée";o[t]||(o[t]=0),o[t]++}}),Object.entries(o).map(([a,u])=>({name:a,count:u}))}),se=S(()=>{if(!T.value)return[];const o={};return _.keypads.data.forEach(a=>{var t,p;const u=((t=a.region)==null?void 0:t.designation)||"Non spécifiée";if(a.status==="available"&&u===T.value){const h=((p=a.zone)==null?void 0:p.nomenclature)||"Hors-zone";o[h]||(o[h]=0),o[h]++}}),Object.entries(o).map(([a,u])=>({name:a,count:u})).sort((a,u)=>a.name.localeCompare(u.name))}),be=S(()=>{var u,t,p;const o=getComputedStyle(document.documentElement),a=(h,A)=>o.getPropertyValue(h).trim()||A;return{labels:[l("keypads.stats.installed"),l("keypads.stats.available"),l("keypads.stats.faulty")],datasets:[{data:[((u=j.value)==null?void 0:u.installed)||0,((t=j.value)==null?void 0:t.available)||0,((p=j.value)==null?void 0:p.faulty)||0],backgroundColor:[a("--indigo-500","#6366f1"),a("--orange-500","#f59e0b"),a("--rose-500","#f43f5e")],hoverBackgroundColor:[a("--indigo-400","#818cf8"),a("--orange-400","#fbbf24"),a("--rose-400","#fb7185")]}]}}),ve=b({plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,font:{weight:"bold"}}}}}),le=b(["standard","avancé"]),ae=b(["available","installed","faulty"]),oe=o=>({installed:"success",available:"info",faulty:"danger"})[o]||"secondary",n=Re({id:null,serial_number:"",model:"",manufacturer:"",type:"standard",status:"available",installation_date:null,connection_id:null,region_id:null,zone_id:null,meter_id:null,notes:""}),he=()=>{n.reset(),w.value=!1,n.installation_date=new Date,U.value=!0},ne=o=>{n.id=o.id,n.serial_number=o.serial_number,n.model=o.model,n.manufacturer=o.manufacturer,n.type=o.type,n.status=o.status,n.installation_date=o.installation_date,n.connection_id=o.connection_id,n.region_id=o.region_id,n.meter_id=o.meter_id,n.notes=o.notes,w.value=!0,U.value=!0},ye=()=>{const o=w.value?route("keypads.update",n.id):route("keypads.store"),a=w.value?"put":"post";n.transform(u=>({...u,installation_date:u.installation_date?new Date(u.installation_date).toISOString().split("T")[0]:null})).submit(a,o,{onSuccess:()=>{U.value=!1,R.add({severity:"success",summary:l("common.success"),detail:`Clavier ${w.value?"mis à jour":"créé"} avec succès.`,life:3e3})},onError:u=>{const t=Object.values(u).join(", ");R.add({severity:"error",summary:"Erreur de sauvegarde",detail:t,life:5e3})}})},ge=o=>{J.require({message:l("keypads.confirm.deleteMessage",{serial_number:o.serial_number}),header:l("keypads.confirm.deleteHeader"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{G.delete(route("keypads.destroy",o.id),{onSuccess:()=>R.add({severity:"success",summary:l("common.success"),detail:l("keypads.toast.deleteSuccess"),life:3e3})})}})},ke=()=>{J.require({message:l("keypads.confirm.bulkDeleteMessage",{count:C.value.length}),header:l("keypads.confirm.bulkDeleteHeader"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",acceptLabel:l("common.delete"),rejectLabel:l("common.cancel"),accept:()=>{we()}})},we=()=>{G.post(route("keypads.bulkdestroy"),{ids:C.value.map(o=>o.id)},{onSuccess:()=>{R.add({severity:"success",summary:l("common.success"),detail:l("keypads.toast.bulkDeleteSuccess"),life:3e3}),C.value=[]},onError:()=>{R.add({severity:"error",summary:l("common.error"),detail:l("keypads.toast.bulkDeleteError"),life:3e3})}})},Ve=S(()=>_.keypads.data),{transferDialog:O,transferForm:F,itemsToTransfer:K,transferSearchQuery:B,availableItemsForTransfer:Ce,openTransferDialog:Te,confirmTransfer:Se,searchItemsForTransfer:ze,addItemToTransfer:Fe,removeItemFromTransfer:Ue}=He({allItems:Ve,selectedItems:C,transferRouteName:route("keypads.bulk-transfer"),idKey:"keypad_ids",stockStatus:"available",translations:{attention:l("common.attention"),selectDestinationRegion:l("keypads.toast.selectDestinationRegion"),success:l("common.success"),transferSuccess:o=>l("keypads.toast.transferSuccess",{count:o}),transferError:l("keypads.toast.transferError")}}),$e=S(()=>_.keypads.data.map(o=>{var a,u,t;return{...o,connection_full_name:o.connection?`${o.connection.first_name} ${o.connection.last_name}`.trim():l("keypads.table.unassigned"),meter_serial_number:((a=o.meter)==null?void 0:a.serial_number)||l("keypads.table.unassigned"),region_name:((u=o.region)==null?void 0:u.designation)||l("common.notApplicable"),zone_name:((t=o.zone)==null?void 0:t.nomenclature)||l("common.notApplicable")}})),P=S(()=>n.region_id?_.zones.filter(o=>o.region_id===n.region_id):[]);W(()=>n.region_id,o=>{w.value||P.value.some(a=>a.id===n.zone_id)||(n.zone_id=null)}),W(()=>n.meter_id,o=>{if(!w.value)if(n.connection_id||(n.region_id=null,n.zone_id=null),o){const a=_.meters.find(u=>u.id===o);a&&(n.connection_id||(n.region_id=a.region_id,n.zone_id=a.zone_id)),console.log(n.region_id,n.zone_id,a)}else n.connection_id||(n.region_id=null,n.zone_id=null)}),W(()=>n.connection_id,o=>{if(!w.value&&(n.region_id=null,n.zone_id=null,n.meter_id=null,o)){const a=_.connections.find(u=>u.id===o);a&&(n.region_id=a.region_id,n.zone_id=a.zone_id,n.meter_id=a.meter_id)}});const ie=S(()=>{const o=new Set(_.keypads.data.map(a=>a.meter_id).filter(a=>a!=null));return _.meters.filter(a=>{const u=!o.has(a.id),t=w.value&&n.meter_id===a.id;return u||t})});S(()=>n.connection_id?_.connections.find(o=>o.id===n.connection_id):null);const T=b(null),je=o=>{T.value===o?T.value=null:T.value=o};return(o,a)=>{const u=De;return d(),m(E,null,[r(Me,null,{default:c(()=>[r(e(Oe),{title:e(l)("keypads.title")},null,8,["title"]),s("div",et,[s("div",tt,[s("div",st,[lt,s("div",null,[s("h1",{class:"text-2xl font-black tracking-tighter text-slate-900 uppercase",innerHTML:e(l)("keypads.titleHtml")},null,8,at),s("p",ot,i(e(l)("keypads.subtitle")),1)])]),s("div",nt,[C.value.length>0?(d(),m("div",it,[r(e(x),{label:e(l)("keypads.actions.transfer")+` (${C.value.length})`,icon:"pi pi-arrows-h",severity:"info",onClick:e(Te),class:"rounded-xl px-4"},null,8,["label","onClick"]),r(e(x),{label:e(l)("keypads.actions.delete")+` (${C.value.length})`,icon:"pi pi-trash",severity:"danger",onClick:ke,class:"rounded-xl px-4"},null,8,["label"])])):f("",!0),s("div",rt,[r(e(x),{label:e(l)("keypads.actions.add"),icon:"pi pi-plus",raised:"",onClick:he,class:"rounded-xl px-6"},null,8,["label"])])])]),s("div",dt,[s("div",ct,[ut,s("div",null,[s("div",pt,i(j.value.total),1),s("div",mt,i(e(l)("keypads.stats.total")),1)])]),s("div",ft,[_t,s("div",null,[s("div",xt,i(j.value.installed),1),s("div",bt,i(e(l)("keypads.stats.installed")),1)])]),s("div",vt,[ht,s("div",null,[s("div",yt,i(j.value.faulty),1),s("div",gt,i(e(l)("keypads.stats.faulty")),1)])]),s("div",kt,[wt,s("div",null,[s("div",Vt,i(j.value.available),1),s("div",Ct,i(e(l)("keypads.stats.available")),1)])])]),s("div",Tt,[s("div",St,[s("h3",zt,i(e(l)("keypads.stats.stock_by_region")),1),te.value.length>0?(d(),m("div",Ft,[(d(!0),m(E,null,Z(te.value,t=>(d(),m("div",{key:t.name,onClick:p=>je(t.name),class:Ie(["p-4 bg-white rounded-xl border-2 shadow-sm flex items-center gap-4 cursor-pointer transition-all duration-300",T.value===t.name?"border-primary-500 ring-4 ring-primary-100":"border-slate-200 hover:border-primary-300"])},[$t,s("div",null,[s("div",jt,i(t.count),1),s("div",Dt,i(t.name),1)])],10,Ut))),128))])):(d(),m("div",At,i(e(l)("keypads.messages.no_stock")),1)),T.value&&se.value.length>0?(d(),m("div",Nt,[s("div",Lt,[s("h3",Rt,[Ke(i(e(l)("keypads.stats.stock_detail_for"))+" ",1),s("span",Ot,i(T.value),1)]),M(r(e(x),{icon:"pi pi-times",text:"",rounded:"",severity:"secondary",onClick:a[0]||(a[0]=t=>T.value=null)},null,512),[[u,e(l)("keypads.actions.close_details"),void 0,{bottom:!0}]])]),s("div",It,[(d(!0),m(E,null,Z(se.value,t=>(d(),m("div",{key:t.name,class:"p-3 bg-white rounded-lg border border-primary-100 shadow-sm flex items-center gap-3"},[Kt,s("div",null,[s("div",Et,i(t.count),1),s("div",Mt,i(t.name),1)])]))),128))])])):f("",!0)]),s("div",Ht,[s("h3",qt,i(e(l)("keypads.stats.distribution_by_status")),1),s("div",Bt,[r(e(Ye),{type:"doughnut",data:be.value,options:ve.value,class:"w-full md:w-48"},null,8,["data","options"])])])]),s("div",Pt,[r(e(Be),{ref_key:"dt",ref:X,value:$e.value,selection:C.value,"onUpdate:selection":a[4]||(a[4]=t=>C.value=t),filters:$.value,"onUpdate:filters":a[5]||(a[5]=t=>$.value=t),dataKey:"id",loading:H.value,paginator:!0,rows:k.keypads.per_page,totalRecords:k.keypads.total,lazy:!0,onPage:a[6]||(a[6]=t=>fe(t)),onFilter:a[7]||(a[7]=t=>xe(t)),onSort:a[8]||(a[8]=t=>_e(t)),first:V.value.first,"onUpdate:first":a[9]||(a[9]=t=>V.value.first=t),sortField:V.value.sortField,sortOrder:V.value.sortOrder,filterDisplay:"menu",globalFilterFields:["serial_number","model","manufacturer","type","status","connection_full_name","meter_serial_number"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:e(l)("keypads.table.report"),class:"ultimate-table"},{header:c(()=>[s("div",Wt,[r(e(Qe),{iconPosition:"left"},{default:c(()=>[r(e(Ze),{class:"pi pi-search text-primary-500"}),r(e(D),{modelValue:$.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>$.value.global.value=t),placeholder:e(l)("keypads.table.search_placeholder"),class:"w-full md:w-96 rounded-2xl border-none bg-slate-100"},null,8,["modelValue","placeholder"])]),_:1}),s("div",Qt,[M(r(e(x),{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:ee,class:"rounded-xl"},null,512),[[u,e(l)("common.resetFilters"),void 0,{bottom:!0}]]),M(r(e(x),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:a[2]||(a[2]=t=>X.value.exportCSV())},null,512),[[u,e(l)("common.exportCSV"),void 0,{bottom:!0}]]),M(r(e(x),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:a[3]||(a[3]=t=>Y.value.toggle(t))},null,512),[[u,e(l)("common.selectColumns"),void 0,{bottom:!0}]])])])]),default:c(()=>[r(e(g),{selectionMode:"multiple",headerStyle:"width: 3rem",frozen:""}),v.value.includes("serial_number")?(d(),y(e(g),{key:0,field:"serial_number",header:e(l)("keypads.table.serial_number"),sortable:"",filterField:"serial_number",frozen:"",class:"min-w-[250px]"},{body:c(({data:t})=>[s("div",Zt,[Gt,s("div",Jt,[s("a",{href:"#",onClick:Ee(p=>ne(t),["prevent"]),class:"font-black text-slate-800 leading-none mb-1 hover:text-primary-600 hover:underline"},i(t.serial_number),9,Xt),s("span",Yt,i(t.manufacturer)+" - "+i(t.model),1)])])]),filter:c(({filterModel:t})=>[r(e(D),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,type:"text",class:"p-column-filter",placeholder:e(l)("keypads.filter.by_serial")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):f("",!0),v.value.includes("status")?(d(),y(e(g),{key:1,field:"status",header:e(l)("keypads.table.status"),sortable:"",filterField:"status"},{body:c(({data:t})=>[r(e(I),{value:t.status,severity:oe(t.status),class:"rounded-lg px-3 font-black text-[10px] uppercase"},null,8,["value","severity"])]),filter:c(({filterModel:t})=>[r(e(z),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,options:ae.value,placeholder:e(l)("keypads.filter.by_status"),class:"w-full",showClear:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"])):f("",!0),v.value.includes("type")?(d(),y(e(g),{key:2,field:"type",header:e(l)("keypads.table.type"),sortable:"",filterField:"type"},{body:c(({data:t})=>[r(e(I),{value:t.type,class:"rounded-lg px-3 font-black text-[10px] uppercase border-none"},null,8,["value"])]),filter:c(({filterModel:t})=>[r(e(z),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,options:le.value,placeholder:e(l)("keypads.filter.by_type"),class:"w-full",showClear:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"])):f("",!0),v.value.includes("connection_full_name")?(d(),y(e(g),{key:3,field:"connection_full_name",header:e(l)("keypads.table.connection_full_name"),sortable:"",filterField:"connection.full_name"},{body:c(({data:t})=>[t.connection?(d(),m("a",{key:0,href:o.route("connections.show",t.connection.id),class:"flex items-center gap-2 group"},[ts,s("span",ss,i(t.connection_full_name),1)],8,es)):(d(),m("span",ls,i(e(l)("keypads.table.unassigned")),1))]),filter:c(({filterModel:t})=>[r(e(D),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,type:"text",class:"p-column-filter",placeholder:e(l)("keypads.filter.by_client")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):f("",!0),v.value.includes("meter_serial_number")?(d(),y(e(g),{key:4,field:"meter_serial_number",header:e(l)("keypads.table.meter_serial_number"),sortable:"",filterField:"meter.serial_number"},{body:c(({data:t})=>[t.meter?(d(),m("a",{key:0,href:o.route("meters.index",{global:t.meter.serial_number}),class:"flex items-center gap-2 group"},[os,s("span",ns,i(t.meter_serial_number),1)],8,as)):(d(),m("span",is,i(e(l)("keypads.table.unassigned")),1))]),filter:c(({filterModel:t})=>[r(e(D),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,type:"text",class:"p-column-filter",placeholder:e(l)("keypads.filter.by_meter")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):f("",!0),v.value.includes("installation_date")?(d(),y(e(g),{key:5,field:"installation_date",header:e(l)("keypads.table.installation_date"),sortable:"",filterField:"installation_date",dataType:"date"},{body:c(({data:t})=>[s("span",rs,i(t.installation_date?new Date(t.installation_date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):e(l)("common.notApplicableShort")),1)]),filter:c(({filterModel:t})=>[r(e(pe),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,dateFormat:"dd/mm/yy",placeholder:e(l)("common.date_format_placeholder"),mask:"99/99/9999"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):f("",!0),v.value.includes("region_name")?(d(),y(e(g),{key:6,field:"region_name",header:e(l)("keypads.table.region_name"),sortable:""},{body:c(({data:t})=>[s("span",ds,i(t.region_name),1)]),_:1},8,["header"])):f("",!0),v.value.includes("zone_name")?(d(),y(e(g),{key:7,field:"zone_name",header:e(l)("keypads.table.zone_name"),sortable:""},{body:c(({data:t})=>[s("span",cs,i(t.zone_name),1)]),_:1},8,["header"])):f("",!0),v.value.includes("model")?(d(),y(e(g),{key:8,field:"model",header:e(l)("keypads.table.model")},{body:c(({data:t})=>[s("span",us,i(t.model||"N/A"),1)]),_:1},8,["header"])):f("",!0),v.value.includes("manufacturer")?(d(),y(e(g),{key:9,field:"manufacturer",header:e(l)("keypads.table.manufacturer")},{body:c(({data:t})=>[s("span",ps,i(t.manufacturer||"N/A"),1)]),_:1},8,["header"])):f("",!0),v.value.includes("notes")?(d(),y(e(g),{key:10,field:"notes",header:e(l)("keypads.table.notes"),class:"min-w-[250px]"},{body:c(({data:t})=>[s("p",{class:"text-xs text-slate-500 truncate",title:t.notes},i(t.notes||e(l)("common.notApplicableShort")),9,ms)]),_:1},8,["header"])):f("",!0),r(e(g),{header:e(l)("common.actions"),alignFrozen:"right",frozen:""},{body:c(({data:t})=>[s("div",fs,[r(e(x),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:p=>ne(t)},null,8,["onClick"]),r(e(x),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:p=>ge(t)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","selection","filters","loading","rows","totalRecords","first","sortField","sortOrder","currentPageReportTemplate"])]),r(e(Je),{ref_key:"op",ref:Y,appendTo:"body",id:"column_op",class:"p-4"},{default:c(()=>[s("h4",_s,i(e(l)("common.customize_columns")),1),r(e(Xe),{modelValue:v.value,"onUpdate:modelValue":a[10]||(a[10]=t=>v.value=t),options:me.value,optionLabel:"header",optionValue:"field",placeholder:e(l)("common.selectColumns"),display:"chip",class:"w-full max-w-xs"},null,8,["modelValue","options","placeholder"])]),_:1},512)]),r(e(ue),{visible:U.value,"onUpdate:visible":a[24]||(a[24]=t=>U.value=t),modal:"",header:!1,closable:!1,style:{width:"95vw",maxWidth:"650px"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:c(()=>[s("div",ul,[r(e(x),{label:e(l)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[23]||(a[23]=t=>U.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},{loadingicon:c(t=>[]),_:1},8,["label"]),r(e(x),{label:w.value?e(l)("common.update"):e(l)("common.save"),icon:"pi pi-check-circle",severity:"indigo",onClick:ye,loading:e(n).processing,class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs"},null,8,["label","loading"])])]),default:c(()=>[s("div",null,[s("div",xs,[s("div",bs,[vs,s("div",hs,[s("h2",ys,i(w.value?e(l)("keypads.dialog.editTitle"):e(l)("keypads.dialog.createTitle")),1),s("span",gs,i(e(l)("keypads.dialog.subtitle")),1)])]),r(e(x),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[11]||(a[11]=t=>U.value=!1),class:"text-white hover:bg-white/10"})]),s("div",ks,[s("div",ws,[s("div",Vs,[s("label",Cs,i(e(l)("keypads.form.serial_number")),1),r(e(D),{modelValue:e(n).serial_number,"onUpdate:modelValue":a[12]||(a[12]=t=>e(n).serial_number=t),class:"w-full",placeholder:e(l)("keypads.form.serial_number_placeholder"),invalid:e(n).errors.serial_number},null,8,["modelValue","placeholder","invalid"])]),s("div",Ts,[s("label",Ss,i(e(l)("keypads.form.manufacturer")),1),r(e(D),{modelValue:e(n).manufacturer,"onUpdate:modelValue":a[13]||(a[13]=t=>e(n).manufacturer=t),class:"w-full",placeholder:e(l)("keypads.form.manufacturer_placeholder")},null,8,["modelValue","placeholder"])]),s("div",zs,[s("label",Fs,i(e(l)("keypads.form.model")),1),r(e(D),{modelValue:e(n).model,"onUpdate:modelValue":a[14]||(a[14]=t=>e(n).model=t),class:"w-full",placeholder:e(l)("keypads.form.model_placeholder")},null,8,["modelValue","placeholder"])]),s("div",Us,[s("label",$s,i(e(l)("keypads.form.type")),1),r(e(z),{modelValue:e(n).type,"onUpdate:modelValue":a[15]||(a[15]=t=>e(n).type=t),options:le.value,class:"w-full",placeholder:e(l)("keypads.form.type_placeholder")},null,8,["modelValue","options","placeholder"])]),s("div",js,[s("label",Ds,i(e(l)("keypads.form.status")),1),r(e(z),{modelValue:e(n).status,"onUpdate:modelValue":a[16]||(a[16]=t=>e(n).status=t),options:ae.value,class:"w-full",placeholder:e(l)("keypads.form.status_placeholder")},null,8,["modelValue","options","placeholder"])]),s("div",As,[s("label",Ns,i(e(l)("keypads.form.connection")),1),r(e(z),{modelValue:e(n).connection_id,"onUpdate:modelValue":a[17]||(a[17]=t=>e(n).connection_id=t),options:k.connections,optionValue:"id",filter:"",class:"w-full shadow-sm border-slate-200",placeholder:e(l)("keypads.form.connection_placeholder"),showClear:"","filter-fields":["full_name","first_name","last_name","customer_code"]},{value:c(t=>{var p,h,A;return[t.value?(d(),m("div",Ls,[s("div",Rs,[s("span",Os,i((p=k.connections.find(N=>N.id===t.value))==null?void 0:p.full_name),1),s("span",Is,i((h=k.connections.find(N=>N.id===t.value))==null?void 0:h.customer_code),1),(A=k.connections.find(N=>N.id===t.value))!=null&&A.keypad_id?(d(),m("i",Ks)):f("",!0)])])):(d(),m("span",Es,i(t.placeholder),1))]}),option:c(t=>[s("div",Ms,[s("div",Hs,[s("span",qs,i(t.option.full_name),1),s("div",Bs,[s("span",Ps,i(t.option.customer_code),1)])]),s("div",Ws,[t.option.zone?(d(),y(e(I),{key:0,value:t.option.zone,severity:"secondary",class:"text-[8px] px-1 h-3.5"},null,8,["value"])):f("",!0),t.option.keypad_id?(d(),y(e(I),{key:1,value:e(l)("keypads.form.has_keypad"),severity:"warning",class:"text-[8px] px-1 h-3.5"},null,8,["value"])):f("",!0)])])]),footer:c(()=>[s("div",Qs,i(k.connections.length)+" "+i(e(l)("connections.headTitle").toLowerCase()),1)]),_:1},8,["modelValue","options","placeholder"])]),s("div",Zs,[s("label",Gs,i(e(l)("keypads.form.meter")),1),r(e(z),{modelValue:e(n).meter_id,"onUpdate:modelValue":a[18]||(a[18]=t=>e(n).meter_id=t),options:ie.value,optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.meter_placeholder"),showClear:""},{value:c(t=>{var p;return[t.value?(d(),m("div",Js,i((p=ie.value.find(h=>h.id===t.value))==null?void 0:p.serial_number),1)):(d(),m("span",Xs,i(t.placeholder),1))]}),option:c(t=>[s("div",Ys,[s("span",el,i(t.option.serial_number),1),t.option.connection?(d(),m("div",tl,[sl,s("span",null,i(t.option.connection.full_name),1)])):f("",!0)])]),_:1},8,["modelValue","options","placeholder"])]),s("div",ll,[s("label",al,i(e(l)("keypads.form.installation_date")),1),r(e(pe),{modelValue:e(n).installation_date,"onUpdate:modelValue":a[19]||(a[19]=t=>e(n).installation_date=t),dateFormat:"dd/mm/yy",showIcon:"",iconDisplay:"input",class:"w-full",placeholder:e(l)("common.date_format_placeholder")},null,8,["modelValue","placeholder"])]),s("div",ol,[s("label",nl,i(e(l)("keypads.form.region")),1),r(e(z),{modelValue:e(n).region_id,"onUpdate:modelValue":a[20]||(a[20]=t=>e(n).region_id=t),options:k.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.region_placeholder"),disabled:!!e(n).meter_id},null,8,["modelValue","options","placeholder","disabled"])]),s("div",il,[s("label",rl,i(e(l)("keypads.form.zone")),1),r(e(z),{modelValue:e(n).zone_id,"onUpdate:modelValue":a[21]||(a[21]=t=>e(n).zone_id=t),options:P.value,optionLabel:"nomenclature",optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.zone_placeholder"),disabled:!!e(n).meter_id||!e(n).region_id||P.value.length===0},null,8,["modelValue","options","placeholder","disabled"])]),s("div",dl,[s("label",cl,i(e(l)("keypads.form.notes")),1),r(e(Ge),{modelValue:e(n).notes,"onUpdate:modelValue":a[22]||(a[22]=t=>e(n).notes=t),rows:"3",class:"w-full",placeholder:e(l)("keypads.form.notes_placeholder")},null,8,["modelValue","placeholder"])])])])])]),_:1},8,["visible"]),r(e(Pe),{position:"bottom-right"}),r(e(We))]),_:1}),r(e(ue),{visible:e(O),"onUpdate:visible":a[30]||(a[30]=t=>ce(O)?O.value=t:null),modal:"",header:!1,closable:!1,style:{width:"95vw",maxWidth:"600px"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:c(()=>[s("div",Rl,[r(e(x),{label:e(l)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[29]||(a[29]=t=>O.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),r(e(x),{label:e(l)("keypads.actions.confirm_transfer"),icon:"pi pi-check-circle",onClick:e(Se),loading:e(F).processing,class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",disabled:e(K).length===0},null,8,["label","onClick","loading","disabled"])])]),default:c(()=>[s("div",pl,[s("div",ml,[fl,s("div",_l,[s("h2",xl,i(e(l)("keypads.dialog.transfer_title")),1),bl])]),r(e(x),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[25]||(a[25]=t=>O.value=!1),class:"text-white hover:bg-white/10"})]),s("div",vl,[s("div",hl,[s("label",yl,i(e(l)("keypads.dialog.destination_region")),1),r(e(z),{modelValue:e(F).region_id,"onUpdate:modelValue":a[26]||(a[26]=t=>e(F).region_id=t),options:k.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.region_placeholder"),invalid:e(F).errors.region_id},null,8,["modelValue","options","placeholder","invalid"]),e(F).errors.region_id?(d(),m("small",gl,i(e(F).errors.region_id),1)):f("",!0)]),s("div",kl,[s("label",wl,i(e(l)("keypads.dialog.add_by_serial")),1),r(e(qe),{modelValue:e(B),"onUpdate:modelValue":a[27]||(a[27]=t=>ce(B)?B.value=t:null),suggestions:e(Ce),onComplete:a[28]||(a[28]=t=>e(ze)(t)),onItemSelect:e(Fe),field:"serial_number",placeholder:"Rechercher et ajouter un clavier disponible...",class:"w-full",inputClass:"p-inputtext-lg"},{option:c(t=>{var p,h;return[s("div",Vl,[s("div",Cl,[s("span",Tl,i(t.option.serial_number),1),s("div",Sl,[zl,s("span",Fl,i(((p=t.option.region)==null?void 0:p.designation)||e(l)("common.notApplicable")),1),Ul,s("span",$l,i(e(F).region_id?(h=k.regions.find(A=>A.id===e(F).region_id))==null?void 0:h.designation:"..."),1)])]),s("div",null,[r(e(I),{value:e(l)(`keypads.status.${t.option.status}`),severity:oe(t.option.status)},null,8,["value","severity"])])])]}),_:1},8,["modelValue","suggestions","onItemSelect"])]),s("div",jl,[s("h4",Dl,i(e(l)("keypads.dialog.to_transfer_count",{count:e(K).length})),1),s("div",Al,[(d(!0),m(E,null,Z(e(K),t=>(d(),m("div",{key:t.id,class:"flex items-center justify-between bg-white p-2 rounded-lg border border-slate-200"},[s("span",Nl,i(t.serial_number),1),r(e(x),{icon:"pi pi-times",text:"",rounded:"",severity:"danger",onClick:p=>e(Ue)(t.id),class:"w-6 h-6"},null,8,["onClick"])]))),128)),e(K).length===0?(d(),m("div",Ll,i(e(l)("keypads.messages.no_keypad_selected")),1)):f("",!0)])])])]),_:1},8,["visible"])],64)}}};export{ua as default};
