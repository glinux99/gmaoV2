import{u as se,a as te,r as b,Y as le,T as B,d as j,w as ae,h as D,e as P,f as p,o as d,i as l,g as t,Z as oe,j as e,t as u,q as A,ac as R,l as m,n as k,p as ie,m as C,k as I,s as F,x as re,y as ne}from"./app-DlduAWKf.js";import{_ as de}from"./AppLayout-D_JPO1-D.js";import{p as ce}from"./lodash-BpaTjLcN.js";import{s as h}from"./index-CnzqN9d3.js";import{s as N}from"./index-B-_-q9gt.js";import{s as O,a as pe}from"./index-D91TOBxc.js";import{s as U}from"./index-a9PRqMaA.js";import{a as z,s as E}from"./index-BLVnNnMn.js";import{s as ue}from"./index-8z2yMFcP.js";import{s as me}from"./index-q2zg7rKM.js";import{s as xe}from"./index-DbTmqpmk.js";import{s as fe}from"./index-D4BnT4fz.js";import{s as he}from"./index-C4OTDIwl.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DF0J99-Y.js";import"./index-C9R50wYM.js";import"./index-C_kRDVS3.js";import"./index-B298Qu7_.js";import"./index-DEclfOQi.js";import"./index-CNkdB_e-.js";import"./index-Ch-n-CSZ.js";import"./index-BQ2NgWYf.js";import"./index-BZHgS7zr.js";const n=x=>(re("data-v-6f31d554"),x=x(),ne(),x),be={class:"quantum-v11-container p-4 lg:p-8 bg-[#f8fafc] min-h-screen"},ve={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},_e={class:"flex items-center gap-4"},ye=n(()=>e("div",{class:"flex h-16 w-16 items-center justify-center rounded-[1rem] bg-primary-600 shadow-xl shadow-primary-100"},[e("i",{class:"pi pi-users text-2xl text-white"})],-1)),we={class:"text-2xl font-black tracking-tighter text-slate-900 uppercase"},ke=n(()=>e("p",{class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},"Hiérarchie & Privilèges",-1)),Ce={class:"flex gap-2"},Se={class:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8"},Ve={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},$e=n(()=>e("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[e("i",{class:"pi pi-tags text-2xl text-slate-500"})],-1)),je={class:"text-2xl font-black text-slate-800"},Pe=n(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Rôles Définis",-1)),Ae={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Re=n(()=>e("div",{class:"w-14 h-14 rounded-xl bg-primary-50 flex items-center justify-center"},[e("i",{class:"pi pi-verified text-2xl text-primary-500"})],-1)),Ie={class:"text-2xl font-black text-slate-800"},Ne=n(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Accès Total",-1)),Ue={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},qe=n(()=>e("div",{class:"w-14 h-14 rounded-xl bg-amber-50 flex items-center justify-center"},[e("i",{class:"pi pi-sliders-h text-2xl text-amber-500"})],-1)),Le={class:"text-2xl font-black text-slate-800"},Te=n(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Accès Limité",-1)),Be={class:"card-v11 overflow-hidden border border-slate-200 rounded-2xl bg-white shadow-sm"},De={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},Fe={class:"flex items-center gap-2"},Oe={key:0,class:"font-bold text-slate-800"},ze=["onClick"],Ee={key:0,class:"text-xs font-bold text-green-600 underline decoration-dotted"},Ge={key:1,class:"text-xs font-medium text-slate-500 group-hover:text-primary-600 transition-colors"},He=n(()=>e("i",{class:"pi pi-external-link text-[10px] text-slate-300"},null,-1)),Me={key:3,class:"text-slate-500 text-xs font-mono"},Ye={class:"flex gap-1"},Ze={class:"px-8 py-4 bg-slate-900 rounded-xl text-white flex justify-between items-center shadow-lg relative z-50"},Je=n(()=>e("div",{class:"flex items-center gap-4"},[e("div",{class:"p-2 bg-primary-500/20 rounded-lg border border-primary-500/30"},[e("i",{class:"pi pi-plus-circle text-primary-400 text-xl"})]),e("div",{class:"flex flex-col"},[e("h2",{class:"text-sm font-black uppercase tracking-widest text-white leading-none"},"Nouveau Rôle"),e("span",{class:"text-[9px] text-primary-300 font-bold uppercase tracking-tighter mt-1 italic italic"},"Security Provisioning Console")])],-1)),Ke={class:"p-6 space-y-6"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},We={class:"p-4 bg-slate-50 rounded-xl border border-slate-100"},Xe=n(()=>e("label",{class:"text-[10px] font-black uppercase text-slate-400 tracking-widest block mb-2"},"Nom Technique",-1)),es={class:"p-4 bg-slate-50 rounded-xl border border-slate-100"},ss=n(()=>e("label",{class:"text-[10px] font-black uppercase text-slate-400 tracking-widest block mb-2"},"Guard",-1)),ts={class:"flex gap-2"},ls=["onClick"],as={class:"p-4 bg-white rounded-xl border border-slate-200 shadow-inner"},os={class:"flex justify-between items-center mb-4"},is=n(()=>e("h3",{class:"text-xs font-black uppercase text-slate-800 tracking-tight"},"Sélection des Privilèges",-1)),rs={class:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[250px] overflow-y-auto pr-2 custom-scrollbar"},ns=["for"],ds={class:"flex justify-between items-center w-full px-2"},cs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest"},ps={class:"text-primary-500"},us=n(()=>e("div",{class:"font-semibold mb-3 text-[10px] uppercase tracking-widest text-slate-400"},"Colonnes",-1)),ms={class:"px-8 py-4 bg-slate-900 rounded-xl text-white flex justify-between items-center"},xs={class:"flex items-center gap-4"},fs=n(()=>e("div",{class:"p-2 bg-primary-500/20 rounded-lg border border-primary-500/30"},[e("i",{class:"pi pi-lock-open text-primary-400"})],-1)),hs={class:"text-sm font-black uppercase tracking-widest"},gs={class:"p-6"},bs={class:"grid grid-cols-2 gap-2 max-h-[50vh] overflow-y-auto custom-scrollbar"},vs={class:"flex items-center gap-4 py-4"},_s=n(()=>e("i",{class:"pi pi-exclamation-circle text-red-500 text-3xl"},null,-1)),ys={class:"text-sm text-slate-600"},ws={class:"font-bold text-slate-900"},ks={class:"flex justify-end gap-2"},Cs={__name:"Index",props:{title:String,filters:Object,permissions:Object,roles:Object,perPage:Number},setup(x){const{debounce:G,pickBy:H,cloneDeep:M}=ce,r=x;se();const q=te(),L=b(),v=b(!1),y=b(!1),_=b(!1),f=le({params:{search:r.filters.search,field:r.filters.field,order:r.filters.order},role:null}),Y=B({}),i=B({name:"",guard_name:"web",permissions:[]}),S=j(()=>({total:r.roles.total||0,fullAccess:r.roles.data.filter(o=>o.permissions.length===r.permissions.length).length,customAccess:r.roles.data.filter(o=>o.permissions.length>0&&o.permissions.length<r.permissions.length).length})),V=[{field:"name",header:"Nom du Rôle",sortable:!0},{field:"guard_name",header:"Guard",sortable:!0},{field:"permissions",header:"Capacités",sortable:!1},{field:"created_at",header:"Création",sortable:!0}],$=b(V.map(o=>o.field)),Z=j(()=>V.filter(o=>$.value.includes(o.field))),w=b(""),J=j(()=>w.value?r.permissions.filter(o=>o.name.toLowerCase().includes(w.value.toLowerCase())):r.permissions),K=()=>{i.reset(),i.clearErrors(),_.value=!0},Q=()=>{i.post(route("role.store"),{onSuccess:()=>{_.value=!1,i.reset(),q.add({severity:"success",summary:"Succès",detail:"Rôle créé avec succès",life:3e3})}})},W=()=>{var o;Y.delete(route("role.destroy",(o=f.role)==null?void 0:o.id),{onSuccess:()=>{v.value=!1,q.add({severity:"info",summary:"Supprimé",detail:"Rôle retiré",life:3e3})}})},X=()=>{i.permissions.length===r.permissions.length?i.permissions=[]:i.permissions=r.permissions.map(o=>o.id)},ee=o=>{D.get(route("role.index"),{page:o.page+1},{preserveState:!0})};return ae(()=>M(f.params),G(()=>{let o=H(f.params);D.get(route("role.index"),o,{replace:!0,preserveState:!0})},150)),(o,a)=>(d(),P(de,null,{default:p(()=>[l(t(oe),{title:r.title},null,8,["title"]),l(t(ue)),e("div",be,[e("div",ve,[e("div",_e,[ye,e("div",null,[e("h1",we,u(r.title),1),ke])]),e("div",Ce,[A(l(t(h),{label:"Nouveau Rôle",icon:"pi pi-plus-circle",class:"shadow-lg shadow-primary-100 severity-primary",onClick:K},null,512),[[R,o.can(["create role"])]])])]),e("div",Se,[e("div",Ve,[$e,e("div",null,[e("div",je,u(S.value.total),1),Pe])]),e("div",Ae,[Re,e("div",null,[e("div",Ie,u(S.value.fullAccess),1),Ne])]),e("div",Ue,[qe,e("div",null,[e("div",Le,u(S.value.customAccess),1),Te])])]),e("div",Be,[l(t(pe),{lazy:"",value:x.roles.data,rows:x.roles.per_page,totalRecords:x.roles.total,onPage:ee,paginator:"",class:"p-datatable-sm quantum-table",first:(x.roles.current_page-1)*x.roles.per_page},{header:p(()=>[e("div",De,[l(t(z),{iconPosition:"left"},{default:p(()=>[l(t(E),{class:"pi pi-search text-slate-400"}),l(t(U),{modelValue:f.params.search,"onUpdate:modelValue":a[0]||(a[0]=s=>f.params.search=s),placeholder:"Rechercher un rôle...",class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 text-sm"},null,8,["modelValue"])]),_:1}),e("div",Fe,[l(t(h),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:a[1]||(a[1]=s=>L.value.toggle(s))})])])]),default:p(()=>[(d(!0),m(C,null,k(Z.value,s=>(d(),P(t(O),{key:s.field,field:s.field,header:s.header,sortable:s.sortable},{body:p(({data:c,field:g})=>[g==="name"?(d(),m("span",Oe,u(c.name),1)):g==="guard_name"?(d(),P(t(xe),{key:1,value:c.guard_name,severity:"secondary",class:"text-[9px]"},null,8,["value"])):g==="permissions"?(d(),m("div",{key:2,onClick:T=>(y.value=!0,f.role=c),class:"cursor-pointer group flex items-center gap-2"},[c.permissions.length===r.permissions.length?(d(),m("span",Ee,"Accès Total")):(d(),m("span",Ge,u(c.permissions.length)+" Capacité(s) ",1)),He],8,ze)):g==="created_at"?(d(),m("span",Me,u(new Date(c.created_at).toLocaleDateString()),1)):ie("",!0)]),_:2},1032,["field","header","sortable"]))),128)),l(t(O),{header:"Actions",headerStyle:"width: 8rem"},{body:p(s=>[e("div",Ye,[A(l(t(h),{icon:"pi pi-pencil",text:"",rounded:"",severity:"secondary"},null,512),[[R,o.can(["update role"])]]),A(l(t(h),{icon:"pi pi-trash",text:"",rounded:"",'"':"",onClick:c=>{v.value=!0,f.role=s.data}},null,8,["onClick"]),[[R,o.can(["delete role"])]])])]),_:1})]),_:1},8,["value","rows","totalRecords","first"])])]),l(t(N),{visible:_.value,"onUpdate:visible":a[6]||(a[6]=s=>_.value=s),modal:"",header:!1,closable:!1,class:"quantum-dialog w-full max-w-2xl",pt:{mask:{style:"backdrop-filter: blur(4px)"}}},{footer:p(()=>[e("div",ds,[e("span",cs,[I("Capacités : "),e("span",ps,u(t(i).permissions.length),1)]),l(t(h),{label:"Confirmer",icon:"pi pi-shield",class:"px-6 shadow-lg shadow-primary-100 severity-primary",onClick:Q,loading:t(i).processing},null,8,["loading"])])]),default:p(()=>[e("div",Ze,[Je,l(t(h),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[2]||(a[2]=s=>_.value=!1),class:"text-white hover:bg-white/10"})]),e("div",Ke,[e("div",Qe,[e("div",We,[Xe,l(t(U),{modelValue:t(i).name,"onUpdate:modelValue":a[3]||(a[3]=s=>t(i).name=s),class:"w-full quantum-input",placeholder:"ex: Manager"},null,8,["modelValue"])]),e("div",es,[ss,e("div",ts,[(d(),m(C,null,k(["web","api"],s=>e("button",{key:s,onClick:c=>t(i).guard_name=s,class:F([t(i).guard_name===s?"bg-slate-900 text-white":"bg-white text-slate-400 border-slate-200","flex-1 py-2 rounded-lg text-[10px] font-black border transition-all uppercase underline-offset-4 tracking-widest"])},u(s),11,ls)),64))])])]),e("div",as,[e("div",os,[is,l(t(h),{label:t(i).permissions.length===r.permissions.length?"Désélectionner tout":"Sélectionner tout",onClick:X,text:"",class:"text-[10px] font-bold uppercase p-0"},null,8,["label"])]),l(t(z),{iconPosition:"left",class:"mb-4"},{default:p(()=>[l(t(E),{class:"pi pi-search text-[10px]"}),l(t(U),{modelValue:w.value,"onUpdate:modelValue":a[4]||(a[4]=s=>w.value=s),placeholder:"Rechercher une règle...",class:"w-full text-xs bg-slate-50 border-none rounded-lg"},null,8,["modelValue"])]),_:1}),e("div",rs,[(d(!0),m(C,null,k(J.value,s=>(d(),m("div",{key:s.id,class:F(["flex items-center gap-3 p-3 rounded-xl border border-transparent transition-all",{"bg-primary-50 border-primary-100":t(i).permissions.includes(s.id),"hover:bg-slate-50":!t(i).permissions.includes(s.id)}])},[l(t(he),{modelValue:t(i).permissions,"onUpdate:modelValue":a[5]||(a[5]=c=>t(i).permissions=c),inputId:"perm"+s.id,value:s.id},null,8,["modelValue","inputId","value"]),e("label",{for:"perm"+s.id,class:"text-xs font-bold text-slate-600 cursor-pointer"},u(s.name),9,ns)],2))),128))])])])]),_:1},8,["visible"]),l(t(me),{ref_key:"op",ref:L,class:"p-4"},{default:p(()=>[us,l(t(fe),{modelValue:$.value,"onUpdate:modelValue":a[7]||(a[7]=s=>$.value=s),options:V,optionLabel:"header",optionValue:"field",display:"chip",class:"w-full max-w-xs"},null,8,["modelValue"])]),_:1},512),l(t(N),{visible:y.value,"onUpdate:visible":a[9]||(a[9]=s=>y.value=s),modal:"",header:!1,closable:!1,class:"quantum-dialog w-full max-w-2xl"},{default:p(()=>{var s,c;return[e("div",ms,[e("div",xs,[fs,e("h2",hs,"Privilèges : "+u((s=f.role)==null?void 0:s.name),1)]),l(t(h),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[8]||(a[8]=g=>y.value=!1),class:"text-white hover:bg-white/10"})]),e("div",gs,[e("div",bs,[(d(!0),m(C,null,k((c=f.role)==null?void 0:c.permissions,(g,T)=>(d(),m("div",{key:T,class:"p-3 bg-slate-50 border border-slate-100 rounded-xl text-xs font-bold text-slate-700"},u(g.name),1))),128))])])]}),_:1},8,["visible"]),l(t(N),{visible:v.value,"onUpdate:visible":a[11]||(a[11]=s=>v.value=s),modal:"",header:"Confirmation",style:{width:"25rem"}},{footer:p(()=>[e("div",ks,[l(t(h),{label:"Annuler",text:"",severity:"secondary",onClick:a[10]||(a[10]=s=>v.value=!1)}),l(t(h),{label:"Supprimer",'"':"",onClick:W})])]),default:p(()=>{var s;return[e("div",vs,[_s,e("p",ys,[I("Supprimer le rôle "),e("span",ws,u((s=f.role)==null?void 0:s.name),1),I(" ?")])])]}),_:1},8,["visible"])]),_:1}))}},Zs=ge(Cs,[["__scopeId","data-v-6f31d554"]]);export{Zs as default};
