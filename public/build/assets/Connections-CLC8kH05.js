import{T as Ue}from"./index-CIbd6ueC.js";import{a as Te,b as Pe,u as $e,r as w,T as Ae,_ as Me,w as oe,d as $,F as f,c as V,e as I,f as c,o as _,i as a,g as t,Z as Ne,j as e,t as p,l as v,n as q,s as De,m as E,ae,p as Ie,q as R,X as Re,z as ze,h as ne,x as Fe,y as Le,k as z}from"./app-DlduAWKf.js";import{_ as Oe}from"./AppLayout-D_JPO1-D.js";import{s as H}from"./index-B-_-q9gt.js";import{s as C}from"./index-CNkdB_e-.js";import{s as W,a as je}from"./index-D91TOBxc.js";import{s as qe}from"./index-8z2yMFcP.js";import{s as x}from"./index-CnzqN9d3.js";import{s as m}from"./index-a9PRqMaA.js";import{s as ie}from"./index-D4BnT4fz.js";import{s as Ee}from"./index-CF9dEy5j.js";import{s as He}from"./index-q2zg7rKM.js";import{s as We}from"./index-C_kRDVS3.js";import{s as U}from"./index-Ch-n-CSZ.js";import{a as Be,s as Ke}from"./index-BLVnNnMn.js";import{s as Je}from"./index-DbTmqpmk.js";import{s as Qe}from"./index-wymrxioL.js";import{a as Ge,s as B}from"./index-BkbW9Xve.js";import{a as re}from"./index-C9R50wYM.js";import{u as Ze}from"./useSpareParts-C85k2kVV.js";import{_ as Xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DF0J99-Y.js";import"./index-BQ2NgWYf.js";import"./index-DEclfOQi.js";import"./index-C4OTDIwl.js";import"./index-BZHgS7zr.js";import"./index-BXQQtr1t.js";import"./index-BCORyR4y.js";import"./index-B298Qu7_.js";const n=k=>(Fe("data-v-1ecde1b7"),k=k(),Le(),k),Ye={class:"quantum-v11-container p-4 lg:p-8 bg-[#f8fafc] min-h-screen"},et={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},tt={class:"flex items-center gap-5"},st=n(()=>e("div",{class:"h-16 w-16 bg-slate-900 rounded-3xl flex items-center justify-center shadow-2xl"},[e("i",{class:"pi pi-bolt text-2xl text-yellow-400"})],-1)),lt=["innerHTML"],ot={class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},at={class:"flex items-center gap-2"},nt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},it={class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},rt={class:"text-2xl font-black text-slate-800"},dt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},ct={class:"card-v11 overflow-hidden border border-slate-200 rounded-2xl bg-white shadow-sm"},ut={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},pt={class:"flex items-center gap-2"},mt={key:0,class:"font-bold"},_t={key:2},bt={key:3},ft={key:4},xt={key:5},gt={key:6},ht={key:7},vt=["title"],wt={class:"font-semibold mb-3"},yt={class:"px-8 py-5 bg-slate-900 flex justify-between items-center shadow-xl relative z-10 rounded-xl"},Vt={class:"flex items-center gap-5"},kt=n(()=>e("div",{class:"p-3 bg-blue-500/10 rounded-2xl border border-blue-500/20 shadow-[0_0_15px_rgba(59,130,246,0.3)]"},[e("i",{class:"pi pi-bolt text-blue-400 text-2xl animate-pulse"})],-1)),St={class:"flex flex-col"},Ct={class:"text-lg font-black uppercase tracking-widest text-white"},Ut={class:"flex items-center gap-2 mt-1"},Tt={class:"px-2 py-0.5 bg-blue-500/20 text-blue-300 text-[10px] font-bold rounded uppercase tracking-tighter border border-blue-500/30"},Pt={class:"bg-white"},$t=n(()=>e("div",{class:"flex items-center gap-2 px-2"},[e("i",{class:"pi pi-user text-lg"}),e("span",{class:"font-bold"},"Informations Client")],-1)),At={class:"p-8 space-y-8 animate-fadein"},Mt={class:"flex flex-col md:flex-row gap-6 p-6 bg-blue-50/30 rounded-3xl border border-blue-100 items-end"},Nt={class:"flex flex-col gap-2 w-full md:w-1/3"},Dt=n(()=>e("label",{class:"text-[10px] font-black uppercase text-blue-600 tracking-[0.2em] ml-1 flex items-center gap-2"},[e("i",{class:"pi pi-lock text-[9px]"}),z(" Code Client Système ")],-1)),It={class:"relative"},Rt=n(()=>e("i",{class:"pi pi-id-card absolute left-4 top-1/2 -translate-y-1/2 text-blue-400"},null,-1)),zt=n(()=>e("p",{class:"text-[11px] text-blue-500/70 pb-2 italic font-medium"},[e("i",{class:"pi pi-info-circle mr-1"}),z(" Généré automatiquement.")],-1)),Ft={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Lt={class:"space-y-6 bg-white p-7 rounded-3xl border border-slate-200 shadow-sm relative overflow-hidden"},Ot=n(()=>e("div",{class:"absolute top-0 left-0 w-1.5 h-full bg-blue-500"},null,-1)),jt=n(()=>e("h3",{class:"text-xs font-black uppercase text-slate-800 tracking-widest flex items-center gap-2 mb-6"},"Identité & Contacts",-1)),qt={class:"grid grid-cols-2 gap-5"},Et={class:"flex flex-col gap-2"},Ht=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Prénom",-1)),Wt={class:"flex flex-col gap-2"},Bt=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Nom",-1)),Kt={class:"grid grid-cols-2 gap-5 pt-2"},Jt={class:"flex flex-col gap-2"},Qt=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Téléphone 1",-1)),Gt={class:"flex flex-col gap-2"},Zt=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Téléphone 2",-1)),Xt={class:"space-y-6 bg-white p-7 rounded-3xl border border-slate-200 shadow-sm relative overflow-hidden"},Yt=n(()=>e("div",{class:"absolute top-0 left-0 w-1.5 h-full bg-emerald-500"},null,-1)),es=n(()=>e("h3",{class:"text-xs font-black uppercase text-slate-800 tracking-widest flex items-center gap-2 mb-6"},"Secteur & Classification",-1)),ts={class:"grid grid-cols-2 gap-5"},ss={class:"flex flex-col gap-2"},ls=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Type",-1)),os={class:"flex flex-col gap-2"},as=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Agent",-1)),ns={class:"grid grid-cols-2 gap-5 pt-2"},is={class:"flex flex-col gap-2"},rs=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Région",-1)),ds={class:"flex flex-col gap-2"},cs=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Zone",-1)),us=n(()=>e("div",{class:"flex items-center gap-2 px-2"},[e("i",{class:"pi pi-cog text-lg"}),e("span",{class:"font-bold"},"Détails Techniques")],-1)),ps={class:"p-8 space-y-8 animate-fadein"},ms={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},_s={class:"p-6 bg-white rounded-3xl border border-slate-200 shadow-sm space-y-4"},bs=n(()=>e("label",{class:"text-[10px] font-black uppercase text-blue-600 tracking-widest block mb-4 underline decoration-2 underline-offset-8"},"Matériel Central",-1)),fs={class:"flex flex-col gap-1.5"},xs=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500"},"Compteur",-1)),gs={class:"flex flex-col gap-1.5"},hs=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500"},"Clavier",-1)),vs={class:"pt-4 border-t border-slate-100"},ws={class:"flex justify-between items-center mb-2"},ys=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500"},"Matériaux Utilisés",-1)),Vs={class:"space-y-1.5 max-h-24 overflow-y-auto custom-scrollbar pr-2"},ks={class:"text-blue-700"},Ss={class:"flex-grow truncate text-slate-600 font-medium"},Cs=["onClick"],Us={class:"p-6 bg-white rounded-3xl border border-slate-200 shadow-sm space-y-4"},Ts=n(()=>e("label",{class:"text-[10px] font-black uppercase text-blue-600 tracking-widest block mb-4 underline decoration-2 underline-offset-8"},"Spécifications",-1)),Ps={class:"grid grid-cols-2 gap-4"},$s={class:"flex flex-col gap-1.5"},As=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Phasage",-1)),Ms={class:"flex flex-col gap-1.5"},Ns=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Voltage",-1)),Ds={class:"grid grid-cols-2 gap-4"},Is={class:"flex flex-col gap-1.5"},Rs=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Ampérage",-1)),zs={class:"flex flex-col gap-1.5"},Fs=n(()=>e("label",{class:"text-[11px] font-bold text-slate-500 uppercase"},"Tarif",-1)),Ls={class:"p-6 bg-slate-900 rounded-3xl text-white space-y-4 shadow-xl relative overflow-hidden"},Os=n(()=>e("label",{class:"text-[10px] font-black uppercase text-blue-400 tracking-widest block mb-4"},"Scellés & Sécurité",-1)),js={class:"flex flex-col gap-1.5"},qs=n(()=>e("label",{class:"text-[11px] text-slate-400 uppercase"},"Scellé Compteur",-1)),Es={class:"flex flex-col gap-1.5"},Hs=n(()=>e("label",{class:"text-[11px] text-slate-400 uppercase"},"Scellé Coffret",-1)),Ws={class:"flex items-center justify-between p-3 bg-white/5 rounded-xl border border-white/10 mt-2"},Bs=n(()=>e("label",{class:"text-[10px] font-bold uppercase"},"Ready Box",-1)),Ks={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 p-6 bg-slate-50 rounded-3xl border border-slate-100 shadow-inner"},Js={class:"space-y-4"},Qs=n(()=>e("h3",{class:"text-[10px] font-black uppercase text-slate-400 tracking-[0.2em] mb-4 flex items-center gap-2"},[e("i",{class:"pi pi-sitemap text-blue-500"}),z(" Réseau & Raccordement ")],-1)),Gs={class:"grid grid-cols-2 gap-4"},Zs={class:"flex flex-col gap-1.5 p-3 bg-white rounded-2xl border border-slate-100 shadow-sm font-bold text-slate-700"},Xs=n(()=>e("label",{class:"text-[10px] text-slate-500 uppercase"},"N° Poteau",-1)),Ys={class:"flex flex-col gap-1.5 p-3 bg-white rounded-2xl border border-slate-100 shadow-sm font-bold text-slate-700"},el=n(()=>e("label",{class:"text-[10px] text-slate-500 uppercase"},"Dist. (m)",-1)),tl={class:"flex flex-col gap-1.5 p-3 bg-white rounded-2xl border border-slate-100 shadow-sm font-bold text-slate-700"},sl=n(()=>e("label",{class:"text-[10px] text-slate-500 uppercase"},"Câble (mm²)",-1)),ll={class:"flex flex-col gap-1.5 p-3 bg-white rounded-2xl border border-slate-100 shadow-sm font-bold text-slate-700"},ol=n(()=>e("label",{class:"text-[10px] text-slate-500 uppercase"},"Long. (m)",-1)),al={class:"space-y-4"},nl=n(()=>e("h3",{class:"text-[10px] font-black uppercase text-slate-400 tracking-[0.2em] mb-4 flex items-center gap-2"},[e("i",{class:"pi pi-compass text-red-500"}),z(" Coordonnées GPS ")],-1)),il={class:"grid grid-cols-1 gap-4"},rl={class:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm"},dl=n(()=>e("div",{class:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center text-red-500"},[e("i",{class:"pi pi-map-marker"})],-1)),cl={class:"flex flex-col flex-grow"},ul=n(()=>e("label",{class:"text-[9px] font-black text-slate-400 uppercase"},"Latitude",-1)),pl={class:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm"},ml=n(()=>e("div",{class:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center text-red-500"},[e("i",{class:"pi pi-map-marker rotate-90"})],-1)),_l={class:"flex flex-col flex-grow"},bl=n(()=>e("label",{class:"text-[9px] font-black text-slate-400 uppercase"},"Longitude",-1)),fl=n(()=>e("div",{class:"flex items-center gap-2 px-2"},[e("i",{class:"pi pi-wallet text-lg"}),e("span",{class:"font-bold"},"Administratif & Paiement")],-1)),xl={class:"p-8 grid grid-cols-1 lg:grid-cols-2 gap-8 animate-fadein"},gl={class:"p-8 bg-gradient-to-br from-blue-700 to-indigo-900 rounded-[2rem] text-white shadow-2xl relative overflow-hidden border border-white/10"},hl=n(()=>e("label",{class:"text-[10px] font-black uppercase text-blue-200 tracking-widest block mb-8 opacity-70"},"Transactions & Ledger",-1)),vl={class:"space-y-8 relative z-10"},wl={class:"flex flex-col gap-2"},yl=n(()=>e("label",{class:"text-xs font-bold text-blue-100 uppercase ml-1"},"Montant Versé (USD)",-1)),Vl={class:"grid grid-cols-2 gap-6 pt-6 border-t border-white/10"},kl={class:"flex flex-col gap-1"},Sl=n(()=>e("label",{class:"text-[10px] text-blue-200"},"N° Transaction",-1)),Cl={class:"flex flex-col gap-1"},Ul=n(()=>e("label",{class:"text-[10px] text-blue-200"},"Date Paiement",-1)),Tl={class:"p-6 bg-slate-50 rounded-3xl border border-slate-100 space-y-5"},Pl=n(()=>e("h3",{class:"text-xs font-black uppercase text-slate-400 tracking-widest mb-4"},"Dossier de Validation",-1)),$l={class:"flex flex-col gap-2"},Al=n(()=>e("label",{class:"text-[11px] font-bold text-slate-600 uppercase"},"RCCM",-1)),Ml={class:"flex items-center justify-between p-4 bg-white rounded-2xl border-2 border-dashed border-slate-200 mt-4"},Nl=n(()=>e("div",{class:"flex flex-col"},[e("span",{class:"text-sm font-black text-slate-700"},"Approbation Dossier"),e("span",{class:"text-[10px] text-slate-400 uppercase"},"Vérifié")],-1)),Dl={class:"flex justify-between items-center w-full px-4 py-2"},Il={class:"flex gap-4"},Rl={class:"p-fluid"},zl=n(()=>e("p",{class:"mb-4"}," Sélectionnez un fichier Excel (.xlsx) ou CSV (.csv) pour importer de nouveaux raccordements. Assurez-vous que le fichier respecte le format attendu. ",-1)),Fl=n(()=>e("p",null,"Glissez et déposez les fichiers ici pour les télécharger.",-1)),Ll={class:"p-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center"},Ol={class:"flex items-center gap-3"},jl=n(()=>e("div",{class:"w-10 h-10 bg-slate-900 rounded-lg flex items-center justify-center"},[e("i",{class:"pi pi-box text-blue-400 text-lg"})],-1)),ql=n(()=>e("h2",{class:"text-sm font-bold text-slate-800"}," Ajouter un matériau ",-1)),El={class:"text-[10px] text-slate-500 font-medium uppercase tracking-wider"},Hl={class:"p-6 space-y-6 bg-white"},Wl={class:"field"},Bl=n(()=>e("label",{class:"text-[10px] font-black uppercase text-slate-400 mb-2 block"},"Références",-1)),Kl={class:"field"},Jl=n(()=>e("label",{class:"text-[10px] font-black uppercase text-slate-400 mb-2 block"},"Quantité",-1)),Ql={class:"p-4 bg-slate-100/60 flex justify-end gap-3 border-t border-slate-200"},Gl={__name:"Connections",props:{connections:Object,regions:Array,zones:Array,connectionStatuses:Array,queryParams:Object,meters:Array,keypads:Array,spareParts:Array},setup(k){var G,Z,X,Y,ee;const g=k,A=Te(),de=Pe(),{t:i}=$e(),M=w(!1),F=w(!1),S=w(!1),o=Ae({id:null,customer_code:"",region_id:null,zone_id:null,status:"pending",first_name:"",last_name:"",phone_number:"",secondary_phone_number:"",gps_latitude:null,gps_longitude:null,customer_type:"individual",customer_type_details:"",commercial_agent_name:"",amount_paid:0,payment_number:"",payment_voucher_number:"",payment_date:null,is_verified:!1,connection_type:"",connection_date:null,meter_id:null,keypad_id:null,cable_section:"",meter_type_connected:"",cable_length:null,box_type:"",meter_seal_number:"",box_seal_number:"",phase_number:1,amperage:"",voltage:220,with_ready_box:!1,tariff:"",tariff_index:null,pole_number:"",distance_to_pole:null,needs_small_pole:!1,bt_poles_installed:0,small_poles_installed:0,additional_meter_1:"",additional_meter_2:"",additional_meter_3:"",rccm_number:"",client_search:null,spare_parts_used:[]}),N=w([]);Me(()=>{N.value=JSON.parse(JSON.stringify(g.spareParts||[]))}),oe(()=>g.spareParts,r=>{N.value=JSON.parse(JSON.stringify(r||[]))},{deep:!0});const{sparePartDialogVisible:T,sparePartData:D,getSparePartReference:ce,openSparePartDialog:ue,saveSparePart:pe,removeSparePart:me}=Ze(o,w(N)),_e=$(()=>{const r=o.region_id;return r?(N.value||[]).map(s=>{var l;const h=((l=s.stocks_by_region)==null?void 0:l[r])||0;return{label:`${s.reference} (${i("sparePartMovements.stockLabel")}: ${h})`,value:s.id}}).filter(s=>s.label.includes("Stock actuel:")&&!s.label.includes("Stock actuel: 0")):[]}),be=$(()=>o.region_id?g.zones.filter(r=>r.region_id===o.region_id):g.zones),K=w(),J=w(),P=w([]),b=w({first:g.connections.from-1,rows:g.connections.per_page||10,sortField:((G=g.queryParams)==null?void 0:G.sortField)||"created_at",sortOrder:((Z=g.queryParams)==null?void 0:Z.sortOrder)==="desc"?-1:1,filters:{global:{value:((ee=(Y=(X=g.queryParams)==null?void 0:X.filters)==null?void 0:Y.global)==null?void 0:ee.value)||null,matchMode:f.CONTAINS},customer_code:{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},full_name:{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},status:{value:null,matchMode:f.EQUALS},"region.designation":{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]}}}),L=()=>{F.value=!0,ne.get(route("connections.index"),{page:b.value.first/b.value.rows+1,per_page:b.value.rows,sortField:b.value.sortField,sortOrder:b.value.sortOrder===1?"asc":"desc",filters:b.value.filters},{preserveState:!0,onFinish:()=>{F.value=!1}})},O=r=>{b.value={...b.value,...r},L()};w({global:{value:null,matchMode:f.CONTAINS},customer_code:{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},full_name:{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},status:{value:null,matchMode:f.EQUALS},"region.designation":{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]}});const fe=()=>{b.value.filters={global:{value:null,matchMode:f.CONTAINS},customer_code:{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},full_name:{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},status:{value:null,matchMode:f.EQUALS},"region.designation":{operator:V.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]}},L()},xe=()=>{o.reset(),S.value=!0},ge=r=>{o.clearErrors(),Object.keys(o.data()).forEach(s=>{["connection_date","payment_date"].includes(s)?o[s]=r[s]?new Date(r[s]):null:o[s]=r[s]}),o.client_search={full_name:`${r.first_name} ${r.last_name}`},S.value=!0},he=()=>{const r={...o.data(),connection_date:o.connection_date?new Date(o.connection_date).toISOString().slice(0,19).replace("T"," "):null,payment_date:o.payment_date?new Date(o.payment_date).toISOString().slice(0,19).replace("T"," "):null};console.log(r);const s=o.id?"put":"post",h=o.id?"connections.update":"connections.store",l=o.id,d=o.id?i("connections.toast.updateSuccess"):i("connections.toast.saveSuccess"),u={onSuccess:()=>{S.value=!1,A.add({severity:"success",summary:i("common.success"),detail:d,life:3e3})},onError:y=>{console.error(y),A.add({severity:"error",summary:i("common.error"),detail:i("connections.toast.saveError"),life:3e3})}};s==="post"?o.transform(()=>r).post(route(h),u):o.transform(()=>r).put(route(h,l),u)},Q=$(()=>[{field:"customer_code",header:i("connections.table.customerCode"),sortable:!0},{field:"full_name",header:i("connections.table.fullName"),sortable:!0},{field:"status",header:i("connections.table.status"),sortable:!0},{field:"region.designation",header:i("connections.table.region"),sortable:!0},{field:"zone.title",header:i("connections.table.zone"),sortable:!1},{field:"connection_date",header:i("connections.table.connectionDate"),sortable:!0},{field:"amount_paid",header:i("connections.table.amountPaid"),sortable:!0},{field:"phone_number",header:i("connections.table.phone")},{field:"meter.serial_number",header:i("connections.table.meterNumber")},{field:"keypad.serial_number",header:i("connections.table.keypadNumber")}]),j=w(["customer_code","full_name","status","region.designation","connection_date","amount_paid"]),ve=$(()=>Q.value.filter(r=>j.value.includes(r.field))),we=$(()=>{const r=g.connections.data||[];return{total:g.connections.total||0,active:r.filter(s=>s.status==="active").length,verified:r.filter(s=>s.is_verified).length,pending:r.filter(s=>s.status==="pending").length}}),ye=r=>({active:"success",pending:"warning",suspended:"danger",fraud:"danger",inactive:"info"})[r]||"secondary",Ve=()=>K.value.exportCSV(),ke=()=>{de.require({message:i("connections.confirm.bulkDeleteMessage",{count:P.value.length}),header:i("connections.confirm.deleteHeader"),icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{}})},Se=r=>{const s=r.files[0];ne.post(route("connections.import"),{file:s},{onSuccess:()=>{M.value=!1,A.add({severity:"success",summary:"Succès",detail:"Importation démarrée avec succès."})},onError:h=>{const l=h.file||Object.values(h)[0]||"Une erreur est survenue.";A.add({severity:"error",summary:"Erreur d'importation",detail:l,life:5e3})}})},Ce=()=>{const r=Date.now().toString().slice(-6),s=Math.floor(Math.random()*90);return`VE-CLI-${`15${r}${s}`}`};return oe(()=>S.value,r=>{r&&!o.id&&!o.customer_code&&(o.customer_code=Ce())}),(r,s)=>{const h=Ue;return _(),I(Oe,null,{default:c(()=>[a(t(Ne),{title:t(i)("connections.title")},null,8,["title"]),a(t(qe)),a(t(Qe)),e("div",Ye,[e("div",et,[e("div",tt,[st,e("div",null,[e("h1",{class:"text-2xl font-black tracking-tighter text-slate-900 uppercase",innerHTML:t(i)("connections.titleHtml")},null,8,lt),e("p",ot,p(t(i)("connections.subtitle")),1)])]),e("div",at,[a(t(x),{label:"Importer",icon:"pi pi-upload",severity:"secondary",outlined:"",onClick:s[0]||(s[0]=l=>M.value=!0)}),a(t(x),{label:t(i)("connections.addNew"),icon:"pi pi-plus",class:"shadow-lg shadow-primary-200",onClick:xe},null,8,["label"])])]),e("div",nt,[(_(),v(E,null,q(["total","active","verified","pending"],l=>e("div",{key:l,class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},[e("div",it,[e("i",{class:De(`pi ${{total:"pi-box",active:"pi-check-circle",verified:"pi-shield",pending:"pi-clock"}[l]} text-2xl text-slate-500`)},null,2)]),e("div",null,[e("div",rt,p(we.value[l]),1),e("div",dt,p(t(i)(`connections.stats.${l}`)),1)])])),64))]),e("div",ct,[a(t(je),{ref_key:"dt",ref:K,value:k.connections.data,paginator:"",rows:k.connections.per_page,class:"p-datatable-sm quantum-table",dataKey:"id",filterDisplay:"menu",lazy:!0,onPage:O,onSort:O,onFilter:O,totalRecords:k.connections.total,loading:F.value,first:b.value.first,"onUpdate:first":s[3]||(s[3]=l=>b.value.first=l),filters:b.value.filters,"onUpdate:filters":s[4]||(s[4]=l=>b.value.filters=l),globalFilterFields:["customer_code","full_name","status","region.designation"],selection:P.value,"onUpdate:selection":s[5]||(s[5]=l=>P.value=l),rowsPerPageOptions:[10,25,50,100],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:t(i)("common.paginationReport",{item:"raccordements"})},{header:c(()=>[e("div",ut,[a(t(Be),{iconPosition:"left"},{default:c(()=>[a(t(Ke),{class:"pi pi-search text-slate-400"}),a(t(m),{modelValue:b.value.filters.global.value,"onUpdate:modelValue":s[1]||(s[1]=l=>b.value.filters.global.value=l),placeholder:t(i)("connections.searchPlaceholder"),onKeydown:ae(L,["enter"]),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),e("div",pt,[P.value.length?(_(),I(t(x),{key:0,icon:"pi pi-trash",label:t(i)("common.deleteSelected",{count:P.value.length}),severity:"danger",text:"",onClick:ke},null,8,["label"])):Ie("",!0),R(a(t(x),{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:fe,class:"rounded-xl"},null,512),[[h,t(i)("common.resetFilters"),void 0,{bottom:!0}]]),R(a(t(x),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:Ve},null,512),[[h,t(i)("common.exportCSV"),void 0,{bottom:!0}]]),R(a(t(x),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:s[2]||(s[2]=l=>J.value.toggle(l))},null,512),[[h,t(i)("common.selectColumns"),void 0,{bottom:!0}]])])])]),default:c(()=>[a(t(W),{selectionMode:"multiple",headerStyle:"width: 3rem"}),(_(!0),v(E,null,q(ve.value,l=>(_(),I(t(W),{key:l.field,field:l.field,header:l.header,sortable:l.sortable,filterField:l.field},Re({body:c(({data:d,field:u})=>{var y,te,se,le;return[u==="full_name"?(_(),v("span",mt,p(d.first_name)+" "+p(d.last_name),1)):u==="status"?(_(),I(t(Je),{key:1,value:t(i)(`connections.status.${d.status}`,d.status),severity:ye(d.status),class:"uppercase text-[9px] px-2"},null,8,["value","severity"])):u==="amount_paid"?(_(),v("span",_t,p(new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(d.amount_paid)),1)):u.includes("date")?(_(),v("span",bt,p(d[u]?new Date(d[u]).toLocaleDateString():"-"),1)):u==="region.designation"?(_(),v("span",ft,p((y=d.region)==null?void 0:y.designation),1)):u==="zone.title"?(_(),v("span",xt,p((te=d.zone)==null?void 0:te.title),1)):u==="meter.serial_number"?(_(),v("span",gt,p((se=d.meter)==null?void 0:se.serial_number),1)):u==="keypad.serial_number"?(_(),v("span",ht,p((le=d.keypad)==null?void 0:le.serial_number),1)):(_(),v("span",{key:8,class:"text-slate-600 text-sm truncate",title:d[u]},p(d[u]),9,vt))]}),_:2},[["customer_code","full_name","region.designation"].includes(l.field)?{name:"filter",fn:c(({filterModel:d,filterCallback:u})=>[a(t(m),{modelValue:d.constraints[0].value,"onUpdate:modelValue":y=>d.constraints[0].value=y,type:"text",onKeydown:ae(y=>u(),["enter"]),class:"p-column-filter",placeholder:`Filtrer par ${l.header}`},null,8,["modelValue","onUpdate:modelValue","onKeydown","placeholder"])]),key:"0"}:void 0,l.field==="status"?{name:"filter",fn:c(({filterModel:d,filterCallback:u})=>[a(t(C),{modelValue:d.value,"onUpdate:modelValue":y=>d.value=y,onChange:y=>u(),options:g.connectionStatuses,placeholder:"Statut",class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","onChange","options"])]),key:"1"}:void 0]),1032,["field","header","sortable","filterField"]))),128)),a(t(W),{header:"Actions",alignFrozen:"right",frozen:""},{body:c(({data:l})=>[R(a(t(x),{icon:"pi pi-pencil",text:"",rounded:"",onClick:d=>ge(l)},null,8,["onClick"]),[[h,"Modifier",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","rows","totalRecords","loading","first","filters","selection","currentPageReportTemplate"])])]),a(t(He),{ref_key:"op",ref:J},{default:c(()=>[e("div",wt,p(t(i)("common.columnSelector.title")),1),a(t(ie),{modelValue:j.value,"onUpdate:modelValue":s[6]||(s[6]=l=>j.value=l),options:Q.value,optionLabel:"header",optionValue:"field",display:"chip",class:"w-full max-w-xs"},null,8,["modelValue","options"])]),_:1},512),a(t(H),{visible:S.value,"onUpdate:visible":s[39]||(s[39]=l=>S.value=l),modal:"",header:!1,closable:!1,class:"w-full max-w-7xl border-none shadow-2xl",pt:{root:{class:"rounded-2xl overflow-hidden"},mask:{style:"backdrop-filter: blur(8px); background: rgba(15, 23, 42, 0.6)"}}},{footer:c(()=>[e("div",Dl,[a(t(x),{label:t(i)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:s[38]||(s[38]=l=>S.value=!1),class:"!rounded-xl px-6 h-11"},null,8,["label"]),e("div",Il,[a(t(x),{label:t(o).id?t(i)("common.update"):t(i)("common.create"),icon:"pi pi-save",class:"!rounded-xl px-10 h-11 shadow-lg shadow-blue-500/30 font-black transition-all hover:scale-105 active:scale-95",onClick:he,loading:t(o).processing},null,8,["label","loading"])])])]),default:c(()=>[e("div",yt,[e("div",Vt,[kt,e("div",St,[e("h2",Ct,p(t(o).id?"Modifier la Connexion":"Nouvelle Connexion"),1),e("div",Ut,[e("span",Tt,p(t(o).customer_code),1)])])]),a(t(x),{icon:"pi pi-times",severity:"secondary",rounded:"",onClick:s[7]||(s[7]=l=>S.value=!1),class:"!text-white !bg-white/10 hover:!bg-white/20 !border-none transition-all"})]),e("div",Pt,[a(t(Ge),{class:"custom-tabs"},{default:c(()=>[a(t(B),null,{header:c(()=>[$t]),default:c(()=>[e("div",At,[e("div",Mt,[e("div",Nt,[Dt,e("div",It,[Rt,a(t(m),{modelValue:t(o).customer_code,"onUpdate:modelValue":s[8]||(s[8]=l=>t(o).customer_code=l),readonly:"",class:"w-full h-11 !pl-12 !bg-blue-50/50 !border-blue-200 !text-blue-700 font-mono font-bold rounded-2xl cursor-not-allowed shadow-inner"},null,8,["modelValue"])])]),zt]),e("div",Ft,[e("div",Lt,[Ot,jt,e("div",qt,[e("div",Et,[Ht,a(t(m),{modelValue:t(o).first_name,"onUpdate:modelValue":s[9]||(s[9]=l=>t(o).first_name=l),class:"h-11 rounded-2xl border-slate-200"},null,8,["modelValue"])]),e("div",Wt,[Bt,a(t(m),{modelValue:t(o).last_name,"onUpdate:modelValue":s[10]||(s[10]=l=>t(o).last_name=l),class:"h-11 rounded-2xl border-slate-200"},null,8,["modelValue"])])]),e("div",Kt,[e("div",Jt,[Qt,a(t(m),{modelValue:t(o).phone_number,"onUpdate:modelValue":s[11]||(s[11]=l=>t(o).phone_number=l),class:"h-11 rounded-2xl border-slate-200"},null,8,["modelValue"])]),e("div",Gt,[Zt,a(t(m),{modelValue:t(o).secondary_phone_number,"onUpdate:modelValue":s[12]||(s[12]=l=>t(o).secondary_phone_number=l),class:"h-11 rounded-2xl border-slate-200"},null,8,["modelValue"])])])]),e("div",Xt,[Yt,es,e("div",ts,[e("div",ss,[ls,a(t(C),{modelValue:t(o).customer_type,"onUpdate:modelValue":s[13]||(s[13]=l=>t(o).customer_type=l),options:["individual","business","government"],class:"h-11 !rounded-2xl"},null,8,["modelValue"])]),e("div",os,[as,a(t(m),{modelValue:t(o).commercial_agent_name,"onUpdate:modelValue":s[14]||(s[14]=l=>t(o).commercial_agent_name=l),class:"h-11 rounded-2xl"},null,8,["modelValue"])])]),e("div",ns,[e("div",is,[rs,a(t(C),{modelValue:t(o).region_id,"onUpdate:modelValue":s[15]||(s[15]=l=>t(o).region_id=l),options:g.regions,optionLabel:"name",optionValue:"id",class:"h-11 !rounded-2xl"},null,8,["modelValue","options"])]),e("div",ds,[cs,a(t(C),{modelValue:t(o).zone_id,"onUpdate:modelValue":s[16]||(s[16]=l=>t(o).zone_id=l),options:be.value,optionLabel:"name",optionValue:"id",disabled:!t(o).region_id,class:"h-11 !rounded-2xl"},null,8,["modelValue","options","disabled"])])])])])])]),_:1}),a(t(B),null,{header:c(()=>[us]),default:c(()=>[e("div",ps,[e("div",ms,[e("div",_s,[bs,e("div",fs,[xs,a(t(C),{modelValue:t(o).meter_id,"onUpdate:modelValue":s[17]||(s[17]=l=>t(o).meter_id=l),filter:"",class:"h-11 !rounded-xl"},null,8,["modelValue"])]),e("div",gs,[hs,a(t(C),{modelValue:t(o).keypad_id,"onUpdate:modelValue":s[18]||(s[18]=l=>t(o).keypad_id=l),filter:"",class:"h-11 !rounded-xl"},null,8,["modelValue"])]),e("div",vs,[e("div",ws,[ys,a(t(x),{icon:"pi pi-plus",rounded:"",text:"",severity:"secondary",size:"small",onClick:s[19]||(s[19]=l=>t(ue)("used"))})]),e("div",Vs,[(_(!0),v(E,null,q(t(o).spare_parts_used,(l,d)=>(_(),v("div",{key:d,class:"flex items-center gap-2 p-2 bg-blue-50/50 rounded-lg text-[10px] border border-blue-100 group"},[e("b",ks,"x"+p(l.quantity),1),e("span",Ss,p(t(ce)(l.id)),1),e("i",{class:"pi pi-trash text-red-400 cursor-pointer opacity-0 group-hover:opacity-100",onClick:u=>t(me)("used",d)},null,8,Cs)]))),128))])])]),e("div",Us,[Ts,e("div",Ps,[e("div",$s,[As,a(t(U),{modelValue:t(o).phase_number,"onUpdate:modelValue":s[20]||(s[20]=l=>t(o).phase_number=l),inputClass:"h-11 rounded-xl w-full"},null,8,["modelValue"])]),e("div",Ms,[Ns,a(t(U),{modelValue:t(o).voltage,"onUpdate:modelValue":s[21]||(s[21]=l=>t(o).voltage=l),class:"h-11 rounded-xl w-full"},null,8,["modelValue"])])]),e("div",Ds,[e("div",Is,[Rs,a(t(m),{modelValue:t(o).amperage,"onUpdate:modelValue":s[22]||(s[22]=l=>t(o).amperage=l),class:"h-11 rounded-xl"},null,8,["modelValue"])]),e("div",zs,[Fs,a(t(m),{modelValue:t(o).tariff,"onUpdate:modelValue":s[23]||(s[23]=l=>t(o).tariff=l),class:"h-11 rounded-xl"},null,8,["modelValue"])])])]),e("div",Ls,[Os,e("div",js,[qs,a(t(m),{modelValue:t(o).meter_seal_number,"onUpdate:modelValue":s[24]||(s[24]=l=>t(o).meter_seal_number=l),class:"h-10 !bg-white/10 !border-none !text-white !rounded-lg"},null,8,["modelValue"])]),e("div",Es,[Hs,a(t(m),{modelValue:t(o).box_seal_number,"onUpdate:modelValue":s[25]||(s[25]=l=>t(o).box_seal_number=l),class:"h-10 !bg-white/10 !border-none !text-white !rounded-lg"},null,8,["modelValue"])]),e("div",Ws,[Bs,a(t(re),{modelValue:t(o).with_ready_box,"onUpdate:modelValue":s[26]||(s[26]=l=>t(o).with_ready_box=l),onIcon:"pi pi-check",offIcon:"pi pi-times",class:"h-8 w-14 !rounded-lg"},null,8,["modelValue"])])])]),e("div",Ks,[e("div",Js,[Qs,e("div",Gs,[e("div",Zs,[Xs,a(t(m),{modelValue:t(o).pole_number,"onUpdate:modelValue":s[27]||(s[27]=l=>t(o).pole_number=l),class:"w-full !border-none !p-0 focus:!ring-0 text-sm bg-transparent"},null,8,["modelValue"])]),e("div",Ys,[el,a(t(U),{modelValue:t(o).distance_to_pole,"onUpdate:modelValue":s[28]||(s[28]=l=>t(o).distance_to_pole=l),class:"w-full",inputClass:"!border-none !p-0 focus:!ring-0 text-sm bg-transparent"},null,8,["modelValue"])]),e("div",tl,[sl,a(t(m),{modelValue:t(o).cable_section,"onUpdate:modelValue":s[29]||(s[29]=l=>t(o).cable_section=l),class:"w-full !border-none !p-0 focus:!ring-0 text-sm bg-transparent"},null,8,["modelValue"])]),e("div",ll,[ol,a(t(U),{modelValue:t(o).cable_length,"onUpdate:modelValue":s[30]||(s[30]=l=>t(o).cable_length=l),class:"w-full",inputClass:"!border-none !p-0 focus:!ring-0 text-sm bg-transparent"},null,8,["modelValue"])])])]),e("div",al,[nl,e("div",il,[e("div",rl,[dl,e("div",cl,[ul,a(t(m),{modelValue:t(o).gps_latitude,"onUpdate:modelValue":s[31]||(s[31]=l=>t(o).gps_latitude=l),class:"w-full !border-none !p-0 focus:!ring-0 text-base font-mono font-bold text-slate-800 bg-transparent",placeholder:"0.000000"},null,8,["modelValue"])])]),e("div",pl,[ml,e("div",_l,[bl,a(t(m),{modelValue:t(o).gps_longitude,"onUpdate:modelValue":s[32]||(s[32]=l=>t(o).gps_longitude=l),class:"w-full !border-none !p-0 focus:!ring-0 text-base font-mono font-bold text-slate-800 bg-transparent",placeholder:"0.000000"},null,8,["modelValue"])])])])])])])]),_:1}),a(t(B),null,{header:c(()=>[fl]),default:c(()=>[e("div",xl,[e("div",gl,[hl,e("div",vl,[e("div",wl,[yl,a(t(U),{modelValue:t(o).amount_paid,"onUpdate:modelValue":s[33]||(s[33]=l=>t(o).amount_paid=l),mode:"currency",currency:"USD",inputClass:"!bg-white/10 !border-none !text-4xl !font-black !text-white w-full !p-3 !rounded-2xl"},null,8,["modelValue"])]),e("div",Vl,[e("div",kl,[Sl,a(t(m),{modelValue:t(o).payment_number,"onUpdate:modelValue":s[34]||(s[34]=l=>t(o).payment_number=l),class:"!bg-white/5 !border-none !rounded-xl !p-3 !text-white"},null,8,["modelValue"])]),e("div",Cl,[Ul,a(t(We),{modelValue:t(o).payment_date,"onUpdate:modelValue":s[35]||(s[35]=l=>t(o).payment_date=l),class:"!bg-white/5 w-full",inputClass:"!bg-transparent !border-none !p-3 !text-white"},null,8,["modelValue"])])])])]),e("div",Tl,[Pl,e("div",$l,[Al,a(t(m),{modelValue:t(o).rccm_number,"onUpdate:modelValue":s[36]||(s[36]=l=>t(o).rccm_number=l),class:"h-11 rounded-xl shadow-sm border-slate-200"},null,8,["modelValue"])]),e("div",Ml,[Nl,a(t(re),{modelValue:t(o).is_verified,"onUpdate:modelValue":s[37]||(s[37]=l=>t(o).is_verified=l),onIcon:"pi pi-verified",offIcon:"pi pi-times",class:"h-10 px-6 !rounded-xl"},null,8,["modelValue"])])])])]),_:1})]),_:1})])]),_:1},8,["visible"]),a(t(H),{visible:M.value,"onUpdate:visible":s[40]||(s[40]=l=>M.value=l),modal:"",header:"Importer des Raccordements",class:"w-full max-w-lg"},{default:c(()=>[e("div",Rl,[zl,a(t(Ee),{name:"connections_import",onUploader:Se,multiple:!1,accept:".xlsx,.csv",maxFileSize:1e7,customUpload:""},{empty:c(()=>[Fl]),_:1})])]),_:1},8,["visible"]),a(t(H),{visible:t(T),"onUpdate:visible":s[45]||(s[45]=l=>ze(T)?T.value=l:null),modal:"",closable:!1,class:"quantum-dialog w-full max-w-lg shadow-2xl",pt:{mask:{style:"backdrop-filter: blur(8px)"},content:{class:"p-0 rounded-2xl overflow-hidden"}}},{default:c(()=>[e("div",Ll,[e("div",Ol,[jl,e("div",null,[ql,e("p",El,p(t(o).customer_code),1)])]),a(t(x),{icon:"pi pi-times",text:"",rounded:"",severity:"secondary",onClick:s[41]||(s[41]=l=>T.value=!1)})]),e("div",Hl,[e("div",Wl,[Bl,a(t(ie),{modelValue:t(D).ids,"onUpdate:modelValue":s[42]||(s[42]=l=>t(D).ids=l),options:_e.value,optionLabel:"label",optionValue:"value",filter:"",display:"chip",placeholder:"Rechercher une pièce...",class:"w-full !rounded-xl"},null,8,["modelValue","options"])]),e("div",Kl,[Jl,a(t(U),{modelValue:t(D).quantity,"onUpdate:modelValue":s[43]||(s[43]=l=>t(D).quantity=l),showButtons:"",min:1,buttonLayout:"horizontal",class:"w-full"},null,8,["modelValue"])])]),e("div",Ql,[a(t(x),{label:"Fermer",severity:"secondary",onClick:s[44]||(s[44]=l=>T.value=!1),class:"font-bold text-xs"}),a(t(x),{label:"Valider",severity:"info",onClick:t(pe),class:"font-bold text-xs rounded-lg shadow-lg shadow-blue-100"},null,8,["onClick"])])]),_:1},8,["visible"])]),_:1})}}},Uo=Xe(Gl,[["__scopeId","data-v-1ecde1b7"]]);export{Uo as default};
