import{T as fe}from"./index-CIbd6ueC.js";import{u as be,a as ye,b as he,r as m,d as V,F,T as G,w as X,e as C,f as x,o as v,i as r,g as e,Z as we,j as t,t as d,k as ke,ae as Ve,p as Z,q as D,l as S,n as Ce,X as Se,U as Pe,m as Re,s as J,h as W,x as qe,y as $e}from"./app-DlduAWKf.js";import{_ as Ue}from"./AppLayout-D_JPO1-D.js";import{s as Y}from"./index-B-_-q9gt.js";import{s as f}from"./index-CNkdB_e-.js";import{s as j,a as Me}from"./index-D91TOBxc.js";import{s as Te}from"./index-8z2yMFcP.js";import{s as Ae}from"./index-C6x4EAcl.js";import{a as Ie,s as Le}from"./index-BLVnNnMn.js";import{s as _}from"./index-CnzqN9d3.js";import{s as O}from"./index-a9PRqMaA.js";import{s as Fe}from"./index-C9R50wYM.js";import{s as De}from"./index-D4BnT4fz.js";import{s as je}from"./index-q2zg7rKM.js";import{s as Oe}from"./index-C_kRDVS3.js";import{s as ee}from"./index-DbTmqpmk.js";import{s as te}from"./index-Ch-n-CSZ.js";import{s as ze}from"./index-C4OTDIwl.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DF0J99-Y.js";import"./index-BQ2NgWYf.js";import"./index-DEclfOQi.js";import"./index-BZHgS7zr.js";import"./index-B298Qu7_.js";const u=h=>(qe("data-v-6114ceae"),h=h(),$e(),h),Ne={class:"quantum-v11-container p-4 lg:p-8 bg-[#f8fafc] min-h-screen"},Ee={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},He={class:"flex items-center gap-4"},Ke=u(()=>t("div",{class:"flex h-16 w-16 items-center justify-center rounded-[1rem] bg-primary-600 shadow-xl shadow-primary-200"},[t("i",{class:"pi pi-map-marker text-2xl text-white"})],-1)),Qe=["innerHTML"],Ge={class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},Xe={class:"flex items-center gap-3 bg-white p-2 rounded-2xl shadow-sm border border-slate-100"},Ze={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Je={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},We=u(()=>t("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[t("i",{class:"pi pi-box text-2xl text-slate-500"})],-1)),Ye={class:"text-2xl font-black text-slate-800"},et={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},tt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},st=u(()=>t("div",{class:"w-14 h-14 rounded-xl bg-amber-50 flex items-center justify-center"},[t("i",{class:"pi pi-clock text-2xl text-amber-500"})],-1)),lt={class:"text-2xl font-black text-slate-800"},ot={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},it={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},nt=u(()=>t("div",{class:"w-14 h-14 rounded-xl bg-sky-50 flex items-center justify-center"},[t("i",{class:"pi pi-spin pi-spinner text-2xl text-sky-500"})],-1)),at={class:"text-2xl font-black text-slate-800"},rt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},dt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},ct=u(()=>t("div",{class:"w-14 h-14 rounded-xl bg-green-50 flex items-center justify-center"},[t("i",{class:"pi pi-check-circle text-2xl text-green-500"})],-1)),pt={class:"text-2xl font-black text-slate-800"},ut={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},mt={class:"card-v11 overflow-hidden border border-slate-200 rounded-2xl bg-white shadow-sm"},xt={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},vt={class:"flex items-center gap-2"},_t={class:"p-8 text-center text-slate-500"},gt={key:0,class:"font-bold text-slate-800 tracking-tight"},ft={key:2,class:"flex items-center gap-2"},bt={class:"text-xs font-medium"},yt={key:4,class:"text-slate-600 text-sm font-mono"},ht={key:5,class:"flex items-center gap-2"},wt={class:"w-6 h-6 rounded-full bg-primary-100 flex items-center justify-center text-[10px] font-bold text-primary-600"},kt={class:"text-xs"},Vt=["title"],Ct={class:"font-semibold mb-3"},St={class:"px-8 py-4 bg-slate-900 rounded-xl text-white flex justify-between items-center shadow-lg relative z-50"},Pt={class:"flex items-center gap-4"},Rt=u(()=>t("div",{class:"p-2 bg-blue-500/20 rounded-lg border border-blue-500/30"},[t("i",{class:"pi pi-shield text-blue-400 text-xl"})],-1)),qt={class:"flex flex-col"},$t={class:"text-sm font-black uppercase tracking-widest text-white leading-none"},Ut={class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1 italic"},Mt={class:"flex items-center gap-6"},Tt={class:"flex flex-col items-end mr-4"},At=u(()=>t("span",{class:"text-[9px] font-bold text-slate-400 uppercase mb-1"},"Status de l'intervention",-1)),It={class:"p-2"},Lt={class:"grid grid-cols-1 md:grid-cols-12 gap-4 p-4"},Ft={class:"md:col-span-4 space-y-4"},Dt={class:"p-4 bg-slate-50 rounded-xl border border-slate-100 h-full"},jt={class:"text-[10px] font-black uppercase text-slate-400 tracking-widest block mb-3"},Ot={class:"flex gap-4"},zt=u(()=>t("i",{class:"pi pi-users"},null,-1)),Bt={class:"text-xs font-bold"},Nt=u(()=>t("i",{class:"pi pi-user"},null,-1)),Et={class:"text-xs font-bold"},Ht={class:"mt-4"},Kt={class:"md:col-span-4 space-y-4"},Qt={class:"p-4 bg-slate-50 rounded-xl border border-slate-100"},Gt={class:"text-[10px] font-black uppercase text-slate-400 tracking-widest block mb-3"},Xt={class:"p-4 bg-slate-50 rounded-xl border border-slate-100"},Zt={class:"text-[10px] font-black uppercase text-slate-400 tracking-widest block mb-3"},Jt={class:"space-y-4"},Wt={class:"flex flex-col gap-1"},Yt={class:"text-[9px] font-bold uppercase text-slate-500"},es={class:"grid grid-cols-2 gap-2"},ts={class:"flex flex-col gap-1"},ss={class:"text-[9px] font-bold uppercase text-slate-500"},ls={class:"flex flex-col gap-1"},os={class:"text-[9px] font-bold uppercase text-slate-500"},is={class:"flex flex-col gap-1"},ns=u(()=>t("label",{class:"text-[9px] font-bold uppercase text-slate-500"},"Complexité Technique",-1)),as={class:"md:col-span-4 space-y-4"},rs={class:"p-4 bg-slate-900 rounded-xl text-white shadow-xl"},ds={class:"text-xs font-black uppercase tracking-widest mb-4 opacity-70"},cs={class:"space-y-3"},ps={class:"flex flex-col gap-1"},us=u(()=>t("label",{class:"text-[9px] font-bold uppercase"},"Type d'entité",-1)),ms={class:"flex flex-col gap-1"},xs=u(()=>t("label",{class:"text-[9px] font-bold uppercase"},"Assigné à",-1)),vs={class:"p-4 bg-slate-50 rounded-xl border border-slate-100"},_s=u(()=>t("label",{class:"text-[10px] font-black uppercase text-slate-400 tracking-widest block mb-3"},"Planification & Suivi",-1)),gs={class:"space-y-4"},fs={class:"grid grid-cols-2 gap-x-4 mb-4 w-full"},bs={class:"flex flex-col gap-1.5 min-w-0"},ys=u(()=>t("label",{class:"text-[9px] font-bold uppercase text-slate-500 tracking-wider truncate"}," Temps Min (h) ",-1)),hs={class:"flex flex-col gap-1.5 min-w-0"},ws=u(()=>t("label",{class:"text-[9px] font-bold uppercase text-slate-500 tracking-wider truncate"}," Temps Max (h) ",-1)),ks={class:"flex flex-col gap-1"},Vs={class:"text-[9px] font-bold uppercase"},Cs={class:"grid grid-cols-2 gap-2"},Ss={class:"p-3 bg-slate-100 rounded-xl text-center"},Ps={class:"block text-[8px] font-black uppercase text-slate-400"},Rs={class:"text-[10px] font-bold"},qs={class:"p-3 bg-slate-100 rounded-xl text-center"},$s={class:"block text-[8px] font-black uppercase text-slate-400"},Us={class:"text-[10px] font-bold"},Ms={class:"md:col-span-12 flex items-center gap-2 mt-4"},Ts={for:"is_validated",class:"text-sm font-medium text-slate-700"},As={class:"flex justify-between items-center w-full px-2"},Is={class:"flex flex-col gap-6 p-4"},Ls={class:"flex items-center justify-center border-2 border-dashed border-slate-300 rounded-lg p-8"},Fs={class:"text-center"},Ds=u(()=>t("i",{class:"pi pi-upload text-4xl text-slate-400 mb-3"},null,-1)),js={class:"font-semibold text-slate-700"},Os={key:0,class:"p-error"},zs={__name:"Interventions",props:{interventionRequests:Object,filters:Object,users:Array,teams:Array,connections:Array,regions:Array,zones:Array,statuses:Array,priorities:Array,interventionReasons:Array,categories:Array,technicalComplexities:Array},setup(h){var H,K,Q;const p=h,T={"Dépannage Réseau Urgent":{category:"Réseau",complexity:"Moyennement complexe",priority:"Haute",min:72,max:72},"Réparation Éclairage Public":{category:"Réseau",complexity:"Moyennement complexe",priority:"Moyenne",min:4,max:24},"Entretien Réseau Planifié":{category:"Réseau",complexity:"Très complexe",priority:"Moyenne",min:24,max:72},"Incident Majeur Réseau":{category:"Réseau",complexity:"Moyennement complexe",priority:"Haute",min:4,max:48},"Support Achat MobileMoney":{category:"Support Technique",complexity:"Peu complexe",priority:"Basse",min:1,max:1},"Support Achat Token Impossible":{category:"Support Technique",complexity:"Pas complexe",priority:"Basse",min:.5,max:1},"Aide Recharge (Sans clavier)":{category:"Support Technique / Client",complexity:"Pas complexe",priority:"Basse",min:.25,max:1},"Élagage Réseau":{category:"Réseau",complexity:"Peu complexe",priority:"Moyenne",min:72,max:72},"Réparation Chute de Tension":{category:"Réseau",complexity:"Moyennement complexe",priority:"Moyenne",min:4,max:24},"Coupure Individuelle (CI)":{category:"Réseau",complexity:"Peu complexe",priority:"Moyenne",min:2,max:4},"CI Équipement Client":{category:"Réseau",complexity:"Peu complexe",priority:"Moyenne",min:2,max:4},"CI Équipement Virunga":{category:"Réseau",complexity:"Peu complexe",priority:"Moyenne",min:2,max:4},"CI Vol de Câble":{category:"Réseau",complexity:"Moyennement complexe",priority:"Moyenne",min:4,max:72},"Dépannage Clavier Client":{category:"Client",complexity:"Pas complexe",priority:"Basse",min:.5,max:1},"Réparation Compteur Limité":{category:"Client",complexity:"Pas complexe",priority:"Basse",min:.5,max:1},"Rétablissement Déconnexion":{category:"Client",complexity:"Pas complexe",priority:"Basse",min:.5,max:1},"Déplacement Câble (Planifié)":{category:"Réseau",complexity:"Peu complexe",priority:"Moyenne",min:8,max:72},"Déplacement Poteau (Planifié)":{category:"Réseau",complexity:"Peu complexe",priority:"Moyenne",min:24,max:72},"Reconnexion Client":{category:"Client",complexity:"Pas complexe",priority:"Basse",min:.5,max:1},"Support Envoi Formulaire":{category:"Support Technique",complexity:"Pas complexe",priority:"Basse",min:.1,max:.5},"Intervention Non-Classifiée":{category:"Support / Autres",complexity:"Pas complexe",priority:"Basse",min:.5,max:24}},{t:l}=be(),$=ye();he(),m();const w=m(!1),se=m(!1),z=m(),B=m(),A=m([]);m({type:null,id:null});const P=m(!1),R=m("client"),U=V(()=>{const n=p.interventionRequests.data||[];return{total:p.interventionRequests.total,pending:n.filter(s=>s.status==="pending").length,in_progress:n.filter(s=>s.status==="in_progress").length,completed:n.filter(s=>s.status==="completed").length}}),N=V(()=>[{field:"title",header:l("interventions.table.reference"),sortable:!0},{field:"intervention_reason",header:l("interventions.table.reason"),sortable:!0},{field:"status",header:l("interventions.table.status"),sortable:!0},{field:"customer_code",header:l("interventions.table.customerCode"),sortable:!1},{field:"client_name",header:l("interventions.table.clientName"),sortable:!1},{field:"region_name",header:l("interventions.table.region"),sortable:!1},{field:"priority",header:l("interventions.table.priority"),sortable:!0},{field:"technical_complexity",header:l("interventions.table.complexity"),sortable:!1},{field:"scheduled_date",header:l("interventions.table.deadline"),sortable:!0},{field:"completed_date",header:l("interventions.table.completedAt"),sortable:!1},{field:"assigned_to_name",header:l("interventions.table.assignedTo"),sortable:!1},{field:"category",header:l("interventions.table.category"),sortable:!1},{field:"description",header:l("interventions.table.description"),sortable:!1}]),I=m(["title","status","client_name","priority","scheduled_date","assigned_to_name","intervention_reason"]),le=V(()=>N.value.filter(n=>I.value.includes(n.field))),b=m({first:p.interventionRequests.from-1,rows:p.interventionRequests.per_page,sortField:"created_at",sortOrder:-1,filters:{global:{value:((H=p.filters)==null?void 0:H.search)||null,matchMode:F.CONTAINS},status:{value:((K=p.filters)==null?void 0:K.status)||null,matchMode:F.EQUALS},priority:{value:((Q=p.filters)==null?void 0:Q.priority)||null,matchMode:F.EQUALS}}}),E=n=>{q.value=!0;const{first:s,rows:g,sortField:a,sortOrder:c,filters:o}={...b.value,...n};W.get(route("interventions.index"),{per_page:g,page:s/g+1,sortField:a,sortOrder:c===1?"asc":"desc",filters:{global:{value:o.global.value},status:{value:o.status.value},priority:{value:o.priority.value}}},{preserveState:!0,onFinish:()=>{q.value=!1}})};V(()=>Object.values(filters.value).filter(n=>n.value!==null&&n.value!=="").length-1);const oe=n=>{switch(n==null?void 0:n.toLowerCase()){case"completed":return"success";case"pending":return"warning";case"cancelled":return"danger";case"in_progress":return"info";default:return"secondary"}},ie=n=>{switch(n==null?void 0:n.toLowerCase()){case"haute":return"#ef4444";case"moyenne":return"#f59e0b";case"basse":return"#10b981";default:return"#64748b"}},ne=n=>{switch(n){case"Pas complexe":return"success";case"Peu complexe":return"info";case"Moyennement complexe":return"warning";case"Très complexe":return"danger";default:return"secondary"}},i=G({id:null,title:"",description:"",status:"pending",requested_by_user_id:null,requested_by_connection_id:null,assignable_type:null,assignable_id:null,region_id:null,zone_id:null,intervention_reason:null,category:null,technical_complexity:null,priority:null,min_time_hours:null,max_time_hours:null,scheduled_date:null,completed_date:null,comments:null,resolution_notes:null,gps_latitude:null,gps_longitude:null,is_validated:!1}),L=m(!1),k=G({file:null}),ae=()=>{i.reset(),i.title=`PLT-${Math.floor(Date.now()/1e3)}`,i.scheduled_date=new Date().toISOString().slice(0,10),i.is_validated=!0,L.value=!1,w.value=!0},re=()=>{k.reset(),P.value=!0},de=n=>{i.clearErrors(),i.defaults({...n,scheduled_date:n.scheduled_date?new Date(n.scheduled_date).toISOString().slice(0,10):null,completed_date:n.completed_date?new Date(n.completed_date).toISOString().slice(0,10):null}).reset(),L.value=!0,i.is_validated=!!i.is_validated,w.value=!0},ce=V(()=>p.connections.map(n=>({...n,search_label:`${n.first_name} ${n.last_name} (${n.customer_code})`}))),pe=V(()=>{var n;return(((n=p.interventionRequests)==null?void 0:n.data)||[]).map(s=>{var g;return{...s,client_name:s.requested_by_connection?`${s.requested_by_connection.first_name} ${s.requested_by_connection.last_name}`:l("interventions.notApplicable"),customer_code:s.requested_by_connection?s.requested_by_connection.customer_code:"-",assigned_to_name:s.assignable?s.assignable.name:l("interventions.notAssigned"),region_name:((g=s.region)==null?void 0:g.designation)||"-"}})}),ue=V(()=>[{label:l("interventions.assignableTypes.technician"),value:"App\\Models\\User"},{label:l("interventions.assignableTypes.team"),value:"App\\Models\\Team"}]),me=n=>n==="App\\Models\\User"?p.users:n==="App\\Models\\Team"?p.teams:[],q=m(!1);m(!1);const xe=()=>{console.log("form.id"),console.log(i.id);const n=i.id?route("interventions.update",i.id):route("interventions.store");q.value=!0;const s=L.value?"put":"post";i.submit(s,n,{onSuccess:()=>{$.add({severity:"success",summary:"Succès",detail:"Région enregistrée",life:3e3}),w.value=!1},onFinish:()=>{q.value=!1}})},ve=()=>{k.post(route("interventions.import"),{onSuccess:()=>{P.value=!1,$.add({severity:"success",summary:"Succès",detail:"Importation démarrée avec succès.",life:3e3}),W.reload({only:["interventionRequests"]})},onError:n=>{const s=n.file||"Une erreur est survenue lors de l'importation.";$.add({severity:"error",summary:"Erreur d'importation",detail:s,life:5e3})}})};X(()=>i.requested_by_connection_id,n=>{if(n){const s=p.connections.find(g=>g.id===n);s&&(i.region_id=s.region_id,i.zone_id=s.zone_id)}}),X(()=>i.intervention_reason,n=>{if(n&&T[n]){const s=T[n];i.category=s.category,i.technical_complexity=s.complexity,i.priority=s.priority,i.min_time_hours=s.min,i.max_time_hours=s.max,$.add({severity:"info",summary:"Auto-configuration",detail:`Paramètres appliqués pour : ${n}`,life:2e3})}});const _e=m(["pending","assigned","in_progress","completed","cancelled","Non validé"]),ge=()=>{z.value.exportCSV()},M=n=>{E(n)};return(n,s)=>{const g=fe;return v(),C(Ue,null,{default:x(()=>[r(e(we),{title:e(l)("interventions.title")},null,8,["title"]),r(e(Te)),t("div",Ne,[t("div",Ee,[t("div",He,[Ke,t("div",null,[t("h1",{class:"text-2xl font-black tracking-tighter text-slate-900 uppercase",innerHTML:e(l)("interventions.headTitle")},null,8,Qe),t("p",Ge,d(e(l)("interventions.subtitle")),1)])]),t("div",Xe,[r(e(_),{label:e(l)("common.import"),icon:"pi pi-upload",severity:"secondary",onClick:re,class:"rounded-lg"},null,8,["label"]),ke(),r(e(_),{label:e(l)("interventions.addNew"),icon:"pi pi-plus",class:"shadow-lg shadow-primary-200",onClick:ae},null,8,["label"])])]),t("div",Ze,[t("div",Je,[We,t("div",null,[t("div",Ye,d(U.value.total),1),t("div",et,d(e(l)("interventions.stats.total")),1)])]),t("div",tt,[st,t("div",null,[t("div",lt,d(U.value.pending),1),t("div",ot,d(e(l)("interventions.stats.pending")),1)])]),t("div",it,[nt,t("div",null,[t("div",at,d(U.value.in_progress),1),t("div",rt,d(e(l)("interventions.stats.in_progress")),1)])]),t("div",dt,[ct,t("div",null,[t("div",pt,d(U.value.completed),1),t("div",ut,d(e(l)("interventions.stats.completed")),1)])])]),t("div",mt,[r(e(Me),{value:pe.value,selection:A.value,"onUpdate:selection":s[6]||(s[6]=a=>A.value=a),dataKey:"id",ref_key:"dt",ref:z,totalRecords:h.interventionRequests.total,loading:q.value,lazy:"",filters:b.value.filters,"onUpdate:filters":s[7]||(s[7]=a=>b.value.filters=a),filterDisplay:"menu",globalFilterFields:["title","client_name","status","priority","region_name"],rows:h.interventionRequests.per_page,paginator:"",class:"p-datatable-sm quantum-table",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",onPage:s[8]||(s[8]=a=>M(a)),onSort:s[9]||(s[9]=a=>M(a)),onFilter:s[10]||(s[10]=a=>M(a)),currentPageReportTemplate:e(l)("interventions.table.report")},{header:x(()=>[t("div",xt,[r(e(Ie),{iconPosition:"left"},{default:x(()=>[r(e(Le),{class:"pi pi-search text-slate-400"}),r(e(O),{modelValue:b.value.filters.global.value,"onUpdate:modelValue":s[0]||(s[0]=a=>b.value.filters.global.value=a),onKeydown:s[1]||(s[1]=Ve(a=>M(a),["enter"])),placeholder:e(l)("interventions.searchPlaceholder"),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),t("div",vt,[r(e(f),{modelValue:b.value.rows,"onUpdate:modelValue":s[2]||(s[2]=a=>b.value.rows=a),options:[10,20,50,100],onChange:E,class:"p-inputtext-sm"},null,8,["modelValue"]),A.value.length?(v(),C(e(_),{key:0,icon:"pi pi-trash",label:e(l)("interventions.deleteSelected"),class:"p-button-danger p-button-text p-button-sm animate-fadein",onClick:s[3]||(s[3]=a=>se.value=!0)},null,8,["label"])):Z("",!0),D(r(e(_),{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:s[4]||(s[4]=a=>b.value.filters.global.value=""),class:"rounded-xl"},null,512),[[g,e(l)("common.resetFilters"),void 0,{bottom:!0}]]),r(e(_),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:ge}),D(r(e(_),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:s[5]||(s[5]=a=>B.value.toggle(a))},null,512),[[g,"Colonnes",void 0,{bottom:!0}]])])])]),empty:x(()=>[t("div",_t,d(e(l)("interventions.table.noRecords")),1)]),default:x(()=>[r(e(j),{selectionMode:"multiple",headerStyle:"width: 3rem"}),(v(!0),S(Re,null,Ce(le.value,a=>(v(),C(e(j),{key:a.field,field:a.field,header:a.header,sortable:a.sortable,pt:{header:{class:"whitespace-nowrap"}},filterField:a.field},Se({body:x(({data:c,field:o})=>[o==="title"?(v(),S("span",gt,d(c.title),1)):o==="status"?(v(),C(e(ee),{key:1,value:c.status,severity:oe(c.status),class:"uppercase text-[9px] px-2"},null,8,["value","severity"])):o==="priority"?(v(),S("div",ft,[t("div",{class:"w-2 h-2 rounded-full",style:Pe({backgroundColor:ie(c.priority)})},null,4),t("span",bt,d(c.priority),1)])):o==="technical_complexity"?(v(),C(e(ee),{key:3,value:c.technical_complexity,severity:ne(c.technical_complexity),class:"text-[9px] px-2"},null,8,["value","severity"])):o==="scheduled_date"||o==="completed_date"?(v(),S("span",yt,d(c[o]?new Date(c[o]).toLocaleDateString():"-"),1)):o==="assigned_to_name"?(v(),S("div",ht,[t("div",wt,d(c.assigned_to_name.charAt(0)),1),t("span",kt,d(c.assigned_to_name),1)])):(v(),S("span",{key:6,class:"text-slate-600 text-sm truncate",title:c[o]},d(c[o]),9,Vt))]),_:2},[["title","client_name","region_name"].includes(a.field)?{name:"filter",fn:x(({filterModel:c,filterCallback:o})=>[r(e(O),{modelValue:c.constraints[0].value,"onUpdate:modelValue":y=>c.constraints[0].value=y,type:"text",onInput:y=>o(),class:"p-column-filter",placeholder:`Filtrer par ${a.header}`},null,8,["modelValue","onUpdate:modelValue","onInput","placeholder"])]),key:"0"}:void 0,a.field==="status"?{name:"filter",fn:x(({filterModel:c,filterCallback:o})=>[r(e(f),{modelValue:c.value,"onUpdate:modelValue":y=>c.value=y,onChange:y=>o(),options:p.statuses,placeholder:"Statut",class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","onChange","options"])]),key:"1"}:void 0,a.field==="priority"?{name:"filter",fn:x(({filterModel:c,filterCallback:o})=>[r(e(f),{modelValue:c.value,"onUpdate:modelValue":y=>c.value=y,onChange:y=>o(),options:p.priorities,placeholder:"Priorité",class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","onChange","options"])]),key:"2"}:void 0]),1032,["field","header","sortable","filterField"]))),128)),r(e(j),{header:e(l)("interventions.table.actions"),headerStyle:"width: 5rem"},{body:x(({data:a})=>[D(r(e(_),{icon:"pi pi-arrow-right",class:"p-button-rounded p-button-text p-button-secondary",onClick:c=>de(a)},null,8,["onClick"]),[[g,e(l)("interventions.tooltips.manage"),void 0,{left:!0}]])]),_:1},8,["header"])]),_:1},8,["value","selection","totalRecords","loading","filters","rows","currentPageReportTemplate"])])]),r(e(je),{ref_key:"op",ref:B,class:"p-4"},{default:x(()=>[t("div",Ct,d(e(l)("common.columnSelector.title")),1),r(e(De),{modelValue:I.value,"onUpdate:modelValue":s[11]||(s[11]=a=>I.value=a),options:N.value,optionLabel:"header",optionValue:"field",display:"chip",placeholder:e(l)("common.columnSelector.placeholder"),class:"w-full max-w-xs"},null,8,["modelValue","options","placeholder"])]),_:1},512),r(e(Y),{visible:w.value,"onUpdate:visible":s[31]||(s[31]=a=>w.value=a),modal:"",header:!1,closable:!1,class:"quantum-dialog w-full max-w-6xl",pt:{mask:{style:"backdrop-filter: blur(4px)"}}},{footer:x(()=>[t("div",As,[r(e(_),{label:e(l)("interventions.dialog.cancel"),icon:"pi pi-times",class:"p-button-text p-button-secondary",onClick:s[30]||(s[30]=a=>w.value=!1)},null,8,["label"]),r(e(_),{label:e(l)("interventions.dialog.save"),icon:"pi pi-save",class:"px-6 shadow-lg shadow-primary-100",onClick:xe,loading:e(i).processing},null,8,["label","loading"])])]),default:x(()=>{var a,c;return[t("div",St,[t("div",Pt,[Rt,t("div",qt,[t("h2",$t,d(e(i).id?e(l)("interventions.dialog.editTitle"):e(l)("interventions.dialog.createTitle")),1),t("span",Ut,d(e(l)("interventions.dialog.gmaoConsole")),1)])]),t("div",Mt,[t("div",Tt,[At,r(e(Fe),{modelValue:e(i).status,"onUpdate:modelValue":s[12]||(s[12]=o=>e(i).status=o),options:_e.value,class:"p-selectbutton-sm custom-dark-priority"},null,8,["modelValue","options"])]),r(e(_),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:s[13]||(s[13]=o=>w.value=!1),class:"text-white hover:bg-white/10"})])]),t("div",It,[t("div",Lt,[t("div",Ft,[t("div",Dt,[t("label",jt,d(e(l)("interventions.dialog.origin")),1),t("div",Ot,[t("div",{class:J(["flex-1 p-3 rounded-xl border-2 transition-all cursor-pointer flex items-center gap-3",R.value==="client"?"border-primary-500 bg-primary-50 text-primary-700":"border-slate-200 bg-white"]),onClick:s[14]||(s[14]=o=>R.value="client")},[zt,t("span",Bt,d(e(l)("interventions.dialog.externalClient")),1)],2),t("div",{class:J(["flex-1 p-3 rounded-xl border-2 transition-all cursor-pointer flex items-center gap-3",R.value==="agent"?"border-primary-500 bg-primary-50 text-primary-700":"border-slate-200 bg-white"]),onClick:s[15]||(s[15]=o=>R.value="agent")},[Nt,t("span",Et,d(e(l)("interventions.dialog.internalAgent")),1)],2)]),t("div",Ht,[R.value==="client"?(v(),C(e(f),{key:0,modelValue:e(i).requested_by_connection_id,"onUpdate:modelValue":s[16]||(s[16]=o=>e(i).requested_by_connection_id=o),options:ce.value,optionLabel:"search_label",optionValue:"id",filter:"",placeholder:e(l)("interventions.dialog.searchPlaceholder"),class:"w-full quantum-input"},null,8,["modelValue","options","placeholder"])):(v(),C(e(f),{key:1,modelValue:e(i).requested_by_user_id,"onUpdate:modelValue":s[17]||(s[17]=o=>e(i).requested_by_user_id=o),options:p.users,optionLabel:"name",optionValue:"id",filter:"",class:"w-full quantum-input"},null,8,["modelValue","options"]))])])]),t("div",Kt,[t("div",Qt,[t("label",Gt,d(e(l)("interventions.dialog.subjectDescription")),1),r(e(O),{modelValue:e(i).title,"onUpdate:modelValue":s[18]||(s[18]=o=>e(i).title=o),class:"w-full font-bold mb-2",readonly:"",placeholder:e(l)("interventions.dialog.autoReference")},null,8,["modelValue","placeholder"]),r(e(Ae),{modelValue:e(i).description,"onUpdate:modelValue":s[19]||(s[19]=o=>e(i).description=o),rows:"4",class:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-primary-500 text-sm",placeholder:e(l)("interventions.dialog.problemPlaceholder")},null,8,["modelValue","placeholder"])]),t("div",Xt,[t("label",Zt,d(e(l)("interventions.dialog.classification")),1),t("div",Jt,[t("div",Wt,[t("label",Yt,d(e(l)("interventions.dialog.interventionReason")),1),r(e(f),{modelValue:e(i).intervention_reason,"onUpdate:modelValue":s[20]||(s[20]=o=>e(i).intervention_reason=o),options:Object.keys(T),placeholder:"Sélectionner une raison",class:"w-full",filter:""},null,8,["modelValue","options"])]),t("div",es,[t("div",ts,[t("label",ss,d(e(l)("interventions.dialog.category")),1),r(e(f),{modelValue:e(i).category,"onUpdate:modelValue":s[21]||(s[21]=o=>e(i).category=o),options:p.categories,class:"w-full"},null,8,["modelValue","options"])]),t("div",ls,[t("label",os,d(e(l)("interventions.dialog.priority")),1),r(e(f),{modelValue:e(i).priority,"onUpdate:modelValue":s[22]||(s[22]=o=>e(i).priority=o),options:p.priorities,class:"w-full"},null,8,["modelValue","options"])])]),t("div",is,[ns,r(e(f),{modelValue:e(i).technical_complexity,"onUpdate:modelValue":s[23]||(s[23]=o=>e(i).technical_complexity=o),options:p.technicalComplexities,class:"w-full"},null,8,["modelValue","options"])])])])]),t("div",as,[t("div",rs,[t("h4",ds,d(e(l)("interventions.dialog.assignmentDeadline")),1),t("div",cs,[t("div",ps,[us,r(e(f),{modelValue:e(i).assignable_type,"onUpdate:modelValue":s[24]||(s[24]=o=>e(i).assignable_type=o),options:ue.value,optionLabel:"label",optionValue:"value",class:"w-full bg-white/10 border-none text-white rounded-lg"},null,8,["modelValue","options"])]),t("div",ms,[xs,r(e(f),{modelValue:e(i).assignable_id,"onUpdate:modelValue":s[25]||(s[25]=o=>e(i).assignable_id=o),options:me(e(i).assignable_type),disabled:!e(i).assignable_type,optionLabel:"name",optionValue:"id",filter:"",class:"w-full bg-white/10 border-none text-white rounded-lg"},null,8,["modelValue","options","disabled"])])])]),t("div",vs,[_s,t("div",gs,[t("div",fs,[t("div",bs,[ys,r(e(te),{modelValue:e(i).min_time_hours,"onUpdate:modelValue":s[26]||(s[26]=o=>e(i).min_time_hours=o),class:"w-full",inputClass:"w-full"},null,8,["modelValue"])]),t("div",hs,[ws,r(e(te),{modelValue:e(i).max_time_hours,"onUpdate:modelValue":s[27]||(s[27]=o=>e(i).max_time_hours=o),class:"w-full",inputClass:"w-full"},null,8,["modelValue"])])]),t("div",ks,[t("label",Vs,d(e(l)("interventions.dialog.deadline")),1),r(e(Oe),{modelValue:e(i).scheduled_date,"onUpdate:modelValue":s[28]||(s[28]=o=>e(i).scheduled_date=o),class:"w-full",dateFormat:"yy-mm-dd"},null,8,["modelValue"])])])]),t("div",Cs,[t("div",Ss,[t("span",Ps,d(e(l)("interventions.dialog.region")),1),t("span",Rs,d(((a=p.regions.find(o=>o.id===e(i).region_id))==null?void 0:a.designation)||e(l)("interventions.notApplicable")),1)]),t("div",qs,[t("span",$s,d(e(l)("interventions.dialog.zone")),1),t("span",Us,d(((c=p.zones.find(o=>o.id===e(i).zone_id))==null?void 0:c.title)||e(l)("interventions.notApplicable")),1)])])]),t("div",Ms,[r(e(ze),{modelValue:e(i).is_validated,"onUpdate:modelValue":s[29]||(s[29]=o=>e(i).is_validated=o),binary:!0,inputId:"is_validated"},null,8,["modelValue"]),t("label",Ts,d(e(l)("interventions.dialog.validateIntervention")),1)])])])]}),_:1},8,["visible"]),r(e(Y),{visible:P.value,"onUpdate:visible":s[34]||(s[34]=a=>P.value=a),modal:"",header:e(l)("connections.importDialog.title"),style:{width:"450px"}},{footer:x(()=>[r(e(_),{label:e(l)("common.cancel"),icon:"pi pi-times",text:"",onClick:s[33]||(s[33]=a=>P.value=!1)},null,8,["label"]),r(e(_),{label:e(l)("connections.importDialog.startImport"),icon:"pi pi-check",onClick:ve,loading:e(k).processing,disabled:!e(k).file},null,8,["label","loading","disabled"])]),default:x(()=>[t("div",Is,[t("div",Ls,[t("div",Fs,[Ds,t("p",js,d(e(l)("connections.importDialog.chooseFile")),1),t("input",{type:"file",onInput:s[32]||(s[32]=a=>e(k).file=a.target.files[0]),class:"mt-4",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},null,32),e(k).errors.file?(v(),S("small",Os,d(e(k).errors.file),1)):Z("",!0)])])])]),_:1},8,["visible","header"])]),_:1})}}},ul=Be(zs,[["__scopeId","data-v-6114ceae"]]);export{ul as default};
