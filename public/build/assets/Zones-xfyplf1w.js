import{u as Y,a as ee,b as te,r as u,T as le,F as h,c as _,w as I,e as k,f as n,o as c,i as s,g as e,Z as oe,j as o,p,X as se,t as v,l as T,q as ae,v as re,k as ie,h as U}from"./app-tNqL7mf1.js";import{_ as ne}from"./AppLayout-C6jF_llb.js";import{s as m}from"./index-CASASU4u.js";import{s as z}from"./index-CiHAvnIS.js";import{s as V,a as de}from"./index-BPmrBSV6.js";import{s as ue}from"./index-_H4U2U1q.js";import{s as P}from"./index-CAeMJtKO.js";import{s as ce}from"./index-CbSmUBB4.js";import{s as pe}from"./index-XYa5dVaH.js";import{s as me}from"./index-5ThWo-k1.js";import{s as fe}from"./index-gMGiGxzt.js";import{a as j,s as E}from"./index-CPJnGVc0.js";import{s as ve}from"./index-CypAs1y2.js";import{s as ge}from"./index-CWrx6gPK.js";import{s as xe}from"./index-Cwc5oASI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CSp7bdD_.js";import"./index-cPRk1myS.js";import"./index-BVT6l1o2.js";import"./index-BbQv9taT.js";import"./index-BgQpF4oC.js";import"./index-CZa1m6mU.js";import"./index-DYwZWGlh.js";import"./index-DMRwBNCK.js";const he={class:"min-h-screen bg-slate-50/50 p-4 lg:p-8"},be={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8"},ye=o("div",{class:"flex items-center gap-4"},[o("div",{class:"flex h-16 w-16 items-center justify-center rounded-[2rem] bg-primary-600 shadow-xl shadow-primary-200"},[o("i",{class:"pi pi-map-marker text-2xl text-white"})]),o("div",null,[o("h1",{class:"text-3xl font-black text-slate-900 tracking-tight"},[ie("Gestion des "),o("span",{class:"text-primary-600"},"Zones")]),o("p",{class:"text-slate-500 font-medium"},"Organisation des localisations géographiques")])],-1),we={class:"flex gap-3"},_e={class:"bg-white rounded-[2rem] shadow-xl border border-slate-200 overflow-hidden"},ke={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},Ve={class:"flex items-center gap-2"},Se=o("label",{for:"rowsPerPage",class:"text-sm font-medium text-slate-600"},"Lignes par page:",-1),Ce={class:"flex items-center gap-2"},Te={class:"flex items-center gap-3"},ze={class:"font-bold text-slate-700"},Fe={class:"font-medium text-slate-600"},$e={class:"text-sm text-slate-600"},Ne={class:"flex justify-end gap-1"},Ae={class:"font-semibold mb-3"},Ue={class:"px-8 py-5 bg-slate-900 text-white rounded-xl flex justify-between items-center relative z-50"},Pe=o("div",{class:"flex items-center gap-4"},[o("div",{class:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary-200"},[o("i",{class:"pi pi-box text-xl"})]),o("div",null,[o("h4",{class:"font-black text-slate-100 m-0"},"Configuration de la Zone"),o("p",{class:"text-xs text-slate-500 m-0"},"Renseignez les informations de la zone")])],-1),Ze={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth"},De={class:"space-y-6 p-2"},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Oe={class:"flex flex-col gap-2"},Re=o("label",{class:"text-xs font-black text-slate-500 uppercase tracking-wider"},"Région Parente",-1),Ie={key:0,class:"text-red-500 font-medium italic"},je={class:"flex flex-col gap-2"},Ee=o("label",{class:"text-xs font-black text-slate-500 uppercase tracking-wider"},"Numéro de la zone",-1),He={key:0,class:"text-red-500 font-medium italic"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},qe={class:"flex flex-col gap-2"},Le=o("label",{class:"text-xs font-black text-slate-500 uppercase tracking-wider"},"Titre de la zone",-1),Be={key:0,class:"text-red-500 font-medium italic"},Ge={class:"flex flex-col gap-2"},Ke=o("label",{class:"text-xs font-black text-slate-500 uppercase tracking-wider"},"Nomenclature",-1),Xe={key:0,class:"text-red-500 font-medium italic"},Je={class:"flex flex-col gap-2"},Qe=o("label",{class:"text-xs font-black text-slate-500 uppercase tracking-wider"},"Description",-1),Ye={key:0,class:"text-red-500 font-medium italic"},et={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},St={__name:"Zones",props:{zones:Object,regions:Array},setup(N){const{t:f}=Y(),S=N,F=ee(),Z=te(),D=u(),b=u(!1);u(!1);const C=u(!1),y=u(!1),g=u(null),M=u(),a=le({id:null,title:"",description:"",region_id:null,nomenclature:"",number:null}),x=u({global:{value:null,matchMode:h.CONTAINS},nomenclature:{operator:_.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]},title:{operator:_.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]},"region.designation":{operator:_.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]}}),i=u({first:S.zones.from-1,rows:S.zones.per_page||10,sortField:"created_at",sortOrder:-1,filters:x.value}),$=()=>{y.value=!0;const r={page:i.value.first/i.value.rows+1,rows:i.value.rows,sortField:i.value.sortField,sortOrder:i.value.sortOrder===1?"asc":"desc",filters:i.value.filters};U.get(route("zones.index"),r,{preserveState:!0,preserveScroll:!0,onFinish:()=>{y.value=!1}})},H=()=>{x.value={global:{value:null,matchMode:h.CONTAINS},nomenclature:{operator:_.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]},title:{operator:_.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]},"region.designation":{operator:_.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]}},i.value.filters=x.value,$()},O=r=>{i.value=r,$()},W=r=>{i.value.filters=x.value,$()},R=u([{field:"nomenclature",header:"Nomenclature",default:!0},{field:"region.designation",header:"Région Parente",default:!0},{field:"title",header:"Titre",default:!0},{field:"description",header:"Description",default:!1}]),w=u(R.value.filter(r=>r.default).map(r=>r.field)),q=r=>{M.value.toggle(r)},L=u([10,25,50,100]);I(()=>i.value.rows,r=>{$()}),I([()=>a.region_id,()=>a.number,()=>a.title],([r,l,t])=>{let d=[];const A=S.regions.find(Q=>Q.id===r);A&&A.code&&d.push(A.code),l!==null&&l!==""&&d.push(`Zone ${l}`),t&&d.push(`/ ${t}`),a.nomenclature=d.join(" - ").replace(" - /"," /")});const B=()=>{a.reset(),C.value=!1,b.value=!0},G=r=>{a.clearErrors(),Object.assign(a,r),C.value=!0,b.value=!0},K=()=>{y.value=!0;const r=C.value?route("zones.update",a.id):route("zones.store"),l=C.value?"put":"post";a.submit(l,r,{onSuccess:()=>{b.value=!1,F.add({severity:"success",summary:"Succès",detail:"Zone enregistrée",life:3e3}),y.value=!1},onError:()=>{y.value=!1}})},X=r=>{Z.require({message:`Voulez-vous vraiment supprimer la zone "${r.title}" ?`,header:"Attention",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{U.delete(route("zones.destroy",r.id),{onSuccess:()=>F.add({severity:"info",summary:"Info",detail:"Supprimé"})})}})},J=()=>{Z.require({message:`Voulez-vous vraiment supprimer les ${g.value.length} zones sélectionnées ?`,header:"Confirmation de suppression multiple",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{const r=g.value.map(l=>l.id);U.post(route("zones.bulkDestroy"),{ids:r},{onSuccess:()=>{F.add({severity:"info",summary:"Info",detail:"Zones supprimées",life:3e3}),g.value=null},onError:l=>F.add({severity:"error",summary:"Erreur",detail:l.error||"Échec de la suppression",life:3e3})})}})};return(r,l)=>(c(),k(ne,null,{default:n(()=>[s(e(oe),{title:"Gestion des Zones"}),o("div",he,[o("div",be,[ye,o("div",we,[s(e(m),{label:e(f)("regions.actions.resetFilters"),icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:H,class:"rounded-xl"},null,8,["label"]),s(e(m),{label:e(f)("regions.actions.add"),icon:"pi pi-plus",raised:"",onClick:B,class:"rounded-xl px-6"},null,8,["label"])])]),o("div",_e,[s(e(de),{ref_key:"dt",ref:D,value:N.zones.data,selection:g.value,"onUpdate:selection":l[3]||(l[3]=t=>g.value=t),filters:x.value,"onUpdate:filters":l[4]||(l[4]=t=>x.value=t),dataKey:"id",loading:y.value,paginator:!0,rows:i.value.rows,totalRecords:N.zones.total,lazy:!0,onPage:l[5]||(l[5]=t=>O(t)),onSort:l[6]||(l[6]=t=>O(t)),onFilter:l[7]||(l[7]=t=>W(t)),first:i.value.first,"onUpdate:first":l[8]||(l[8]=t=>i.value.first=t),sortField:i.value.sortField,sortOrder:i.value.sortOrder,filterDisplay:"menu",globalFilterFields:["nomenclature","title","region.designation"],class:"p-datatable-custom",removableSort:""},{header:n(()=>[o("div",ke,[s(e(j),{iconPosition:"left"},{default:n(()=>[s(e(E),{class:"pi pi-search text-slate-400"}),s(e(z),{modelValue:x.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>x.value.global.value=t),placeholder:"Rechercher une zone...",class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue"])]),_:1}),o("div",Ve,[Se,s(e(P),{modelValue:i.value.rows,"onUpdate:modelValue":l[1]||(l[1]=t=>i.value.rows=t),options:L.value,class:"p-dropdown-sm rounded-xl border-slate-200",id:"rowsPerPage"},null,8,["modelValue","options"])]),o("div",Ce,[s(e(m),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:l[2]||(l[2]=t=>D.value.exportCSV())}),s(e(m),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:q}),g.value&&g.value.length>0?(c(),k(e(m),{key:0,label:e(f)("common.deleteSelection",{count:g.value.length}),icon:"pi pi-trash",severity:"danger",raised:"",onClick:J},null,8,["label"])):p("",!0)])])]),default:n(()=>[s(e(V),{selectionMode:"multiple",headerStyle:"width: 3rem"}),w.value.includes("nomenclature")?(c(),k(e(V),{key:0,field:"nomenclature",header:"Nomenclature",sortable:"",filterField:"nomenclature",showFilterMatchModes:!1},se({filter:n(({filterModel:t})=>[s(e(z),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,type:"text",class:"p-column-filter",placeholder:"Chercher par nomenclature"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},[w.value.includes("nomenclature")?{name:"body",fn:n(({data:t})=>[o("div",Te,[s(e(ve),{label:t.nomenclature?t.nomenclature[0]:"Z",shape:"circle",class:"bg-primary-50 text-primary-600 font-bold"},null,8,["label"]),o("span",ze,v(t.nomenclature),1)])]),key:"0"}:void 0]),1024)):p("",!0),w.value.includes("title")?(c(),k(e(V),{key:1,field:"title",header:"Titre",sortable:"",filterField:"title",showFilterMatchModes:!1},{body:n(({data:t})=>[o("span",Fe,v(t.title),1)]),filter:n(({filterModel:t})=>[s(e(z),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,type:"text",class:"p-column-filter",placeholder:"Chercher par titre"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})):p("",!0),w.value.includes("region.designation")?(c(),k(e(V),{key:2,field:"region.designation",header:"Région Parente",sortable:"",filterField:"region.designation",showFilterMatchModes:!1},{body:n(({data:t})=>{var d;return[s(e(fe),{value:((d=t.region)==null?void 0:d.designation)||"N/A",severity:"info",class:"rounded-lg px-3 uppercase text-[10px]"},null,8,["value"])]}),filter:n(({filterModel:t})=>[s(e(P),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,options:S.regions,optionLabel:"designation",optionValue:"designation",placeholder:"Toutes les régions",class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1})):p("",!0),w.value.includes("description")?(c(),k(e(V),{key:3,field:"description",header:"Description"},{body:n(({data:t})=>[o("span",$e,v(t.description||"N/A"),1)]),_:1})):p("",!0),s(e(V),{header:e(f)("common.actions"),alignFrozen:"right",frozen:"",class:"min-w-[120px]"},{body:n(({data:t})=>[o("div",Ne,[s(e(m),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:d=>G(t)},null,8,["onClick"]),s(e(m),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:d=>X(t)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","selection","filters","loading","rows","totalRecords","first","sortField","sortOrder"])]),s(e(xe),{ref_key:"op",ref:M,appendTo:"body",id:"column_op",class:"p-4"},{default:n(()=>[o("div",Ae,v(e(f)("common.columnSelector.title")),1),s(e(ge),{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=t=>w.value=t),options:R.value,optionLabel:"header",optionValue:"field",display:"chip",placeholder:e(f)("common.columnSelector.placeholder"),class:"w-full max-w-xs"},null,8,["modelValue","options","placeholder"])]),_:1},512)]),s(e(ue),{visible:b.value,"onUpdate:visible":l[17]||(l[17]=t=>b.value=t),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"600px"},contentStyle:{maxHeight:"80vh",overflow:"auto"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:n(()=>[o("div",et,[s(e(m),{label:e(f)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:l[16]||(l[16]=t=>b.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),s(e(m),{label:C.value?e(f)("common.update"):e(f)("common.save"),icon:"pi pi-check-circle",severity:"indigo",class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",onClick:K,loading:y.value},null,8,["label","loading"])])]),default:n(()=>[o("div",Ue,[Pe,s(e(m),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:l[10]||(l[10]=t=>b.value=!1),class:"text-white hover:bg-white/10"})]),o("div",Ze,[o("div",De,[o("div",Me,[o("div",Oe,[Re,s(e(P),{modelValue:e(a).region_id,"onUpdate:modelValue":l[11]||(l[11]=t=>e(a).region_id=t),options:S.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full rounded-xl border-slate-200 shadow-sm",placeholder:"Sélectionner une région"},null,8,["modelValue","options"]),e(a).errors.region_id?(c(),T("small",Ie,v(e(a).errors.region_id),1)):p("",!0)]),o("div",je,[Ee,s(e(ce),{modelValue:e(a).number,"onUpdate:modelValue":l[12]||(l[12]=t=>e(a).number=t),inputId:"zoneNumber",useGrouping:!1,class:"w-full rounded-xl border-slate-200",inputClass:"py-3 rounded-xl border-none w-full",placeholder:"Ex: 1"},null,8,["modelValue"]),e(a).errors.number?(c(),T("small",He,v(e(a).errors.number),1)):p("",!0)])]),o("div",We,[o("div",qe,[Le,s(e(j),{iconPosition:"left"},{default:n(()=>[s(e(E),{class:"pi pi-tag"}),s(e(z),{modelValue:e(a).title,"onUpdate:modelValue":l[13]||(l[13]=t=>e(a).title=t),class:"w-full py-3 rounded-xl border-slate-200 focus:ring-4 focus:ring-primary-50",placeholder:"Ex: Zone d'activité économique"},null,8,["modelValue"])]),_:1}),e(a).errors.title?(c(),T("small",Be,v(e(a).errors.title),1)):p("",!0)]),o("div",Ge,[Ke,s(e(z),{modelValue:e(a).nomenclature,"onUpdate:modelValue":l[14]||(l[14]=t=>e(a).nomenclature=t),class:"w-full py-3 rounded-xl border-slate-200 focus:ring-4 focus:ring-primary-50",placeholder:"Ex: ZAE-001"},null,8,["modelValue"]),e(a).errors.nomenclature?(c(),T("small",Xe,v(e(a).errors.nomenclature),1)):p("",!0)])]),o("div",Je,[Qe,ae(o("textarea",{"onUpdate:modelValue":l[15]||(l[15]=t=>e(a).description=t),rows:"4",class:"w-full p-4 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-primary-50 transition-all text-sm outline-none shadow-sm",placeholder:"Notes additionnelles sur cette zone..."},null,512),[[re,e(a).description]]),e(a).errors.description?(c(),T("small",Ye,v(e(a).errors.description),1)):p("",!0)])])])]),_:1},8,["visible"]),s(e(pe),{position:"bottom-right"}),s(e(me))]),_:1}))}};export{St as default};
