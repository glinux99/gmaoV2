import{T as Wt}from"./index-CIbd6ueC.js";import{a as qt,b as Xt,u as Gt,r as T,Y as Yt,d as J,w as Kt,_ as Zt,e as Jt,f as xt,o as x,i as R,g as b,Z as Nt,j as d,t as v,q as X,h as N,s as G,l as y,p as E,A as Y,U as K,m as V,n as j,x as Qt,y as te}from"./app-DlduAWKf.js";import{_ as ee}from"./AppLayout-D_JPO1-D.js";import{s as se}from"./index-8z2yMFcP.js";import{s as re}from"./index-wymrxioL.js";import{s as ne}from"./index-D3Ycc_U5.js";import{s as D}from"./index-CnzqN9d3.js";import{s as oe}from"./index-DlkczJx3.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-a9PRqMaA.js";import"./DropdownLink-DF0J99-Y.js";import"./index-C9R50wYM.js";import"./index-C_kRDVS3.js";import"./index-BLVnNnMn.js";import"./index-BQ2NgWYf.js";import"./index-DEclfOQi.js";import"./index-B298Qu7_.js";import"./index-CNkdB_e-.js";import"./index-BZHgS7zr.js";import"./index-B-_-q9gt.js";function ae(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const s=document.implementation.createHTMLDocument(),r=s.createElement("base"),i=s.createElement("a");return s.head.appendChild(r),s.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}const ce=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function F(t){const e=[];for(let s=0,r=t.length;s<r;s++)e.push(t[s]);return e}let H=null;function Ct(t={}){return H||(t.includeStyleProperties?(H=t.includeStyleProperties,H):(H=F(window.getComputedStyle(document.documentElement)),H))}function et(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function le(t){const e=et(t,"border-left-width"),s=et(t,"border-right-width");return t.clientWidth+e+s}function ue(t){const e=et(t,"border-top-width"),s=et(t,"border-bottom-width");return t.clientHeight+e+s}function $t(t,e={}){const s=e.width||le(t),r=e.height||ue(t);return{width:s,height:r}}function de(){let t,e;try{e=process}catch{}const s=e&&e.env?e.env.devicePixelRatio:null;return s&&(t=parseInt(s,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const C=16384;function fe(t){(t.width>C||t.height>C)&&(t.width>C&&t.height>C?t.width>t.height?(t.height*=C/t.width,t.width=C):(t.width*=C/t.height,t.height=C):t.width>C?(t.height*=C/t.width,t.width=C):(t.width*=C/t.height,t.height=C))}function st(t){return new Promise((e,s)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=s,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function he(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function me(t,e,s){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),a=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${s}`),i.setAttribute("viewBox",`0 0 ${e} ${s}`),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("externalResourcesRequired","true"),i.appendChild(a),a.appendChild(t),he(i)}const k=(t,e)=>{if(t instanceof e)return!0;const s=Object.getPrototypeOf(t);return s===null?!1:s.constructor.name===e.name||k(s,e)};function pe(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function ge(t,e){return Ct(e).map(s=>{const r=t.getPropertyValue(s),i=t.getPropertyPriority(s);return`${s}: ${r}${i?" !important":""};`}).join(" ")}function xe(t,e,s,r){const i=`.${t}:${e}`,a=s.cssText?pe(s):ge(s,r);return document.createTextNode(`${i}{${a}}`)}function yt(t,e,s,r){const i=window.getComputedStyle(t,s),a=i.getPropertyValue("content");if(a===""||a==="none")return;const l=ce();try{e.className=`${e.className} ${l}`}catch{return}const u=document.createElement("style");u.appendChild(xe(l,s,i,r)),e.appendChild(u)}function ye(t,e,s){yt(t,e,":before",s),yt(t,e,":after",s)}const wt="application/font-woff",bt="image/jpeg",we={woff:wt,woff2:wt,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:bt,jpeg:bt,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function be(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function ut(t){const e=be(t).toLowerCase();return we[e]||""}function ve(t){return t.split(/,/)[1]}function lt(t){return t.search(/^(data:)/)!==-1}function _e(t,e){return`data:${e};base64,${t}`}async function It(t,e,s){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const i=await r.blob();return new Promise((a,l)=>{const u=new FileReader;u.onerror=l,u.onloadend=()=>{try{a(s({res:r,result:u.result}))}catch(m){l(m)}},u.readAsDataURL(i)})}const ct={};function Se(t,e,s){let r=t.replace(/\?.*/,"");return s&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function dt(t,e,s){const r=Se(t,e,s.includeQueryParams);if(ct[r]!=null)return ct[r];s.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let i;try{const a=await It(t,s.fetchRequestInit,({res:l,result:u})=>(e||(e=l.headers.get("Content-Type")||""),ve(u)));i=_e(a,e)}catch(a){i=s.imagePlaceholder||"";let l=`Failed to fetch resource: ${t}`;a&&(l=typeof a=="string"?a:a.message),l&&console.warn(l)}return ct[r]=i,i}async function ke(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):st(e)}async function Ee(t,e){if(t.currentSrc){const a=document.createElement("canvas"),l=a.getContext("2d");a.width=t.clientWidth,a.height=t.clientHeight,l==null||l.drawImage(t,0,0,a.width,a.height);const u=a.toDataURL();return st(u)}const s=t.poster,r=ut(s),i=await dt(s,r,e);return st(i)}async function Ce(t,e){var s;try{if(!((s=t==null?void 0:t.contentDocument)===null||s===void 0)&&s.body)return await rt(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function $e(t,e){return k(t,HTMLCanvasElement)?ke(t):k(t,HTMLVideoElement)?Ee(t,e):k(t,HTMLIFrameElement)?Ce(t,e):t.cloneNode(Rt(t))}const Ie=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",Rt=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function Re(t,e,s){var r,i;if(Rt(e))return e;let a=[];return Ie(t)&&t.assignedNodes?a=F(t.assignedNodes()):k(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?a=F(t.contentDocument.body.childNodes):a=F(((i=t.shadowRoot)!==null&&i!==void 0?i:t).childNodes),a.length===0||k(t,HTMLVideoElement)||await a.reduce((l,u)=>l.then(()=>rt(u,s)).then(m=>{m&&e.appendChild(m)}),Promise.resolve()),e}function Le(t,e,s){const r=e.style;if(!r)return;const i=window.getComputedStyle(t);i.cssText?(r.cssText=i.cssText,r.transformOrigin=i.transformOrigin):Ct(s).forEach(a=>{let l=i.getPropertyValue(a);a==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),k(t,HTMLIFrameElement)&&a==="display"&&l==="inline"&&(l="block"),a==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),r.setProperty(a,l,i.getPropertyPriority(a))})}function Me(t,e){k(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),k(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function Pe(t,e){if(k(t,HTMLSelectElement)){const s=e,r=Array.from(s.children).find(i=>t.value===i.getAttribute("value"));r&&r.setAttribute("selected","")}}function Te(t,e,s){return k(e,Element)&&(Le(t,e,s),ye(t,e,s),Me(t,e),Pe(t,e)),e}async function Fe(t,e){const s=t.querySelectorAll?t.querySelectorAll("use"):[];if(s.length===0)return t;const r={};for(let a=0;a<s.length;a++){const u=s[a].getAttribute("xlink:href");if(u){const m=t.querySelector(u),$=document.querySelector(u);!m&&$&&!r[u]&&(r[u]=await rt($,e,!0))}}const i=Object.values(r);if(i.length){const a="http://www.w3.org/1999/xhtml",l=document.createElementNS(a,"svg");l.setAttribute("xmlns",a),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const u=document.createElementNS(a,"defs");l.appendChild(u);for(let m=0;m<i.length;m++)u.appendChild(i[m]);t.appendChild(l)}return t}async function rt(t,e,s){return!s&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>$e(r,e)).then(r=>Re(t,r,e)).then(r=>Te(t,r,e)).then(r=>Fe(r,e))}const Lt=/url\((['"]?)([^'"]+?)\1\)/g,Be=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,De=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ze(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function Ae(t){const e=[];return t.replace(Lt,(s,r,i)=>(e.push(i),s)),e.filter(s=>!lt(s))}async function Ve(t,e,s,r,i){try{const a=s?ae(e,s):e,l=ut(e);let u;return i||(u=await dt(a,l,r)),t.replace(ze(e),`$1${u}$3`)}catch{}return t}function je(t,{preferredFontFormat:e}){return e?t.replace(De,s=>{for(;;){const[r,,i]=Be.exec(s)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):t}function Mt(t){return t.search(Lt)!==-1}async function Pt(t,e,s){if(!Mt(t))return t;const r=je(t,s);return Ae(r).reduce((a,l)=>a.then(u=>Ve(u,l,e,s)),Promise.resolve(r))}async function O(t,e,s){var r;const i=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(i){const a=await Pt(i,null,s);return e.style.setProperty(t,a,e.style.getPropertyPriority(t)),!0}return!1}async function He(t,e){await O("background",t,e)||await O("background-image",t,e),await O("mask",t,e)||await O("-webkit-mask",t,e)||await O("mask-image",t,e)||await O("-webkit-mask-image",t,e)}async function Oe(t,e){const s=k(t,HTMLImageElement);if(!(s&&!lt(t.src))&&!(k(t,SVGImageElement)&&!lt(t.href.baseVal)))return;const r=s?t.src:t.href.baseVal,i=await dt(r,ut(r),e);await new Promise((a,l)=>{t.onload=a,t.onerror=e.onImageErrorHandler?(...m)=>{try{a(e.onImageErrorHandler(...m))}catch($){l($)}}:l;const u=t;u.decode&&(u.decode=a),u.loading==="lazy"&&(u.loading="eager"),s?(t.srcset="",t.src=i):t.href.baseVal=i})}async function Ue(t,e){const r=F(t.childNodes).map(i=>Tt(i,e));await Promise.all(r).then(()=>t)}async function Tt(t,e){k(t,Element)&&(await He(t,e),await Oe(t,e),await Ue(t,e))}function We(t,e){const{style:s}=t;e.backgroundColor&&(s.backgroundColor=e.backgroundColor),e.width&&(s.width=`${e.width}px`),e.height&&(s.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(i=>{s[i]=r[i]}),t}const vt={};async function _t(t){let e=vt[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},vt[t]=e,e}async function St(t,e){let s=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,a=(s.match(/url\([^)]+\)/g)||[]).map(async l=>{let u=l.replace(r,"$1");return u.startsWith("https://")||(u=new URL(u,t.url).href),It(u,e.fetchRequestInit,({result:m})=>(s=s.replace(l,`url(${m})`),[l,m]))});return Promise.all(a).then(()=>s)}function kt(t){if(t==null)return[];const e=[],s=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(s,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const m=i.exec(r);if(m===null)break;e.push(m[0])}r=r.replace(i,"");const a=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(l,"gi");for(;;){let m=a.exec(r);if(m===null){if(m=u.exec(r),m===null)break;a.lastIndex=u.lastIndex}else u.lastIndex=a.lastIndex;e.push(m[0])}return e}async function qe(t,e){const s=[],r=[];return t.forEach(i=>{if("cssRules"in i)try{F(i.cssRules||[]).forEach((a,l)=>{if(a.type===CSSRule.IMPORT_RULE){let u=l+1;const m=a.href,$=_t(m).then(w=>St(w,e)).then(w=>kt(w).forEach(U=>{try{i.insertRule(U,U.startsWith("@import")?u+=1:i.cssRules.length)}catch(P){console.error("Error inserting rule from remote css",{rule:U,error:P})}})).catch(w=>{console.error("Error loading remote css",w.toString())});r.push($)}})}catch(a){const l=t.find(u=>u.href==null)||document.styleSheets[0];i.href!=null&&r.push(_t(i.href).then(u=>St(u,e)).then(u=>kt(u).forEach(m=>{l.insertRule(m,l.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",a)}}),Promise.all(r).then(()=>(t.forEach(i=>{if("cssRules"in i)try{F(i.cssRules||[]).forEach(a=>{s.push(a)})}catch(a){console.error(`Error while reading CSS rules from ${i.href}`,a)}}),s))}function Xe(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>Mt(e.style.getPropertyValue("src")))}async function Ge(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const s=F(t.ownerDocument.styleSheets),r=await qe(s,e);return Xe(r)}function Ft(t){return t.trim().replace(/["']/g,"")}function Ye(t){const e=new Set;function s(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(a=>{e.add(Ft(a))}),Array.from(r.children).forEach(a=>{a instanceof HTMLElement&&s(a)})}return s(t),e}async function Ke(t,e){const s=await Ge(t,e),r=Ye(t);return(await Promise.all(s.filter(a=>r.has(Ft(a.style.fontFamily))).map(a=>{const l=a.parentStyleSheet?a.parentStyleSheet.href:null;return Pt(a.cssText,l,e)}))).join(`
`)}async function Ze(t,e){const s=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await Ke(t,e);if(s){const r=document.createElement("style"),i=document.createTextNode(s);r.appendChild(i),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function Bt(t,e={}){const{width:s,height:r}=$t(t,e),i=await rt(t,e,!0);return await Ze(i,e),await Tt(i,e),We(i,e),await me(i,s,r)}async function Je(t,e={}){const{width:s,height:r}=$t(t,e),i=await Bt(t,e),a=await st(i),l=document.createElement("canvas"),u=l.getContext("2d"),m=e.pixelRatio||de(),$=e.canvasWidth||s,w=e.canvasHeight||r;return l.width=$*m,l.height=w*m,e.skipAutoScale||fe(l),l.style.width=`${$}`,l.style.height=`${w}`,e.backgroundColor&&(u.fillStyle=e.backgroundColor,u.fillRect(0,0,l.width,l.height)),u.drawImage(a,0,0,l.width,l.height),l}async function Ne(t,e={}){return(await Je(t,e)).toDataURL()}const M=t=>(Qt("data-v-4fe8045d"),t=t(),te(),t),Qe={class:"h-screen flex flex-col bg-surface-ground overflow-hidden select-none font-sans"},ts={class:"h-16 bg-surface-overlay/80 backdrop-blur-md border-b border-surface-border flex items-center justify-between px-8 z-[100] shadow-sm"},es={class:"flex items-center gap-4"},ss=M(()=>d("div",{class:"p-2.5 bg-surface-900 rounded-xl shadow-lg shadow-surface-200 dark:shadow-surface-800"},[d("i",{class:"pi pi-share-alt text-primary-contrast text-lg"})],-1)),rs={class:"text-sm font-black text-color leading-none uppercase tracking-tighter"},ns={class:"text-[9px] font-bold text-primary-color uppercase tracking-widest animate-pulse"},os={class:"flex items-center gap-6"},is={class:"flex items-center gap-4 bg-surface-100/50 px-4 py-2 rounded-full border border-surface-200 shadow-inner"},as=M(()=>d("i",{class:"pi pi-search text-color-secondary text-xs"},null,-1)),cs={class:"text-[10px] font-mono font-black text-color"},ls=M(()=>d("div",{class:"h-5 w-px bg-surface-200 dark:bg-surface-700 mx-2"},null,-1)),us={class:"bg-surface-card border-b border-surface-border px-8 py-4"},ds={class:"flex items-center justify-between mb-3 -mt-2"},fs={class:"text-[10px] font-black text-color-secondary uppercase tracking-[0.2em]"},hs={class:"p-1.5 relative group"},ms=["onClick"],ps={class:"z-10 flex justify-between items-start"},gs={class:"text-[10px] font-black text-color truncate w-3/4"},xs={key:0,class:"w-2 h-2 bg-primary-color rounded-full animate-ping"},ys={class:"z-10 flex items-center justify-between"},ws={class:"text-[8px] font-black text-color-secondary uppercase tracking-widest"},bs={class:"absolute inset-0 bg-surface-card/90 backdrop-blur-[2px] opacity-0 group-hover:opacity-100 transition-all duration-200 flex items-center justify-center gap-2 z-20"},vs={class:"flex-grow flex relative overflow-hidden"},_s={id:"canvas-svg",width:"5000",height:"5000",class:"absolute inset-0 pointer-events-none"},Ss=M(()=>d("defs",null,[d("filter",{id:"red-glow",x:"-50%",y:"-50%",width:"200%",height:"200%"},[d("feGaussianBlur",{stdDeviation:"4",result:"blur"}),d("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]),d("filter",{id:"neon-glow",x:"-20%",y:"-20%",width:"140%",height:"140%"},[d("feGaussianBlur",{stdDeviation:"3",result:"blur"}),d("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})])],-1)),ks=["d","stroke","filter"],Es={key:0},Cs=["path","dur","begin"],$s=["onMousedown"],Is={key:0,class:"h-8 px-3 flex items-center justify-between border-b border-white/5 bg-white/[0.03]"},Rs={class:"flex items-center gap-2"},Ls={class:"text-[9px] font-black text-primary-400 bg-primary-500/10 px-1.5 py-0.5 rounded tracking-tighter"},Ms={key:0,class:"pi pi-bolt text-amber-500 text-[10px] animate-pulse"},Ps={class:"flex items-center gap-2"},Ts=["onClick"],Fs={key:1,class:"absolute -top-2 -right-2 w-6 h-6 bg-amber-500 rounded-full flex items-center justify-center shadow-lg border-2 border-[#0f172a] animate-bounce z-30 cursor-help"},Bs=M(()=>d("i",{class:"pi pi-calendar-clock text-white text-[10px]"},null,-1)),Ds=[Bs],zs={key:2,class:"p-3 flex flex-col items-center justify-center text-center h-[calc(100%-32px)]"},As={class:"text-[10px] font-bold text-slate-200 leading-tight uppercase tracking-tight"},Vs={key:0,class:"mt-2 flex items-center gap-1.5"},js=M(()=>d("span",{class:"w-1.5 h-1.5 bg-amber-500 rounded-full animate-ping"},null,-1)),Hs=M(()=>d("span",{class:"text-[8px] font-mono text-green-400 font-bold"},"SOUS TENSION",-1)),Os=[js,Hs],Us={key:1,class:"absolute bottom-2 left-2 flex items-center gap-1 bg-black/30 backdrop-blur-sm border border-white/5 rounded-full px-2 py-0.5"},Ws=M(()=>d("i",{class:"pi pi-map-marker text-[7px] text-amber-400"},null,-1)),qs={class:"text-[7px] font-bold text-slate-400 uppercase"},Xs={key:3,class:"w-full h-full relative z-20"},Gs={key:0,class:"absolute inset-0 flex items-center justify-center z-10"},Ys={class:"pi pi-bolt text-amber-400 text-xl animate-pulse"},Ks={key:1,class:"absolute inset-0 pointer-events-none overflow-hidden flex items-center"},Zs={width:"100%",height:"100%",class:"overflow-visible"},Js=["path","dur","begin"],Ns={key:0,class:"absolute top-4 right-4 z-50 bg-surface-900/90 backdrop-blur text-surface-0 p-4 rounded-2xl shadow-2xl border border-surface-0/10 w-56"},Qs={class:"flex justify-between items-center mb-4"},tr={class:"text-[10px] font-bold text-primary-400 uppercase"},er=M(()=>d("i",{class:"pi pi-chart-bar text-primary-400"},null,-1)),sr={class:"space-y-3"},rr={class:"flex justify-between"},nr={class:"text-xs text-surface-400"},or={class:"text-xs font-bold"},ir={class:"h-1 w-full bg-slate-700 rounded-full overflow-hidden"},ar={class:"flex justify-between pt-2 border-t border-surface-0/5"},cr={class:"text-[10px] text-surface-400 uppercase"},lr={class:"text-xs font-bold text-green-400"},ur={class:"flex justify-between"},dr={class:"text-[10px] text-surface-400 uppercase"},fr={class:"text-xs font-bold text-amber-400"},hr=220,mr=130,Q=4,Et=4,tt=200,pr={__name:"Networks",props:{networks:{type:Array,default:()=>[]},initialNetwork:Object,library:{type:Object,default:()=>({})},regions:Array,zones:Array},setup(t){const e=t,s=qt(),r=Xt(),{t:i}=Gt(),a=T(null),l=T(i("networks.newProject")),u=T([]),m=T([]),$=T([]),w=T(.85),U=T(!0),P=T(null),L=Yt({x:0,y:0,width:0,height:0}),nt=o=>{if(console.log(o),!o){a.value=null,l.value=i("networks.newEmptyProject"),u.value=[],m.value=[];return}a.value=o.id,l.value=o.name,w.value=parseFloat(o.zoom_level)||.85,u.value=(o.nodes||[]).map(c=>{const h=c.equipment||{},n=h.equipment_type||{};return{id:c.id,tag:h.tag||c.tag||`ID-${c.id}`,designation:h.designation||c.designation||i("networks.defaultEquipment"),icon:n.icon||c.icon||"pi-box",type:n.name||i("networks.defaultComponent"),x:parseFloat(c.x),y:parseFloat(c.y),w:parseFloat(c.w)||hr,h:parseFloat(c.h)||mr,active:c.is_active!==void 0?!!c.is_active:!0,isRoot:!!c.is_root,region_id:c.region_id,isBusbar:!!c.is_busbar,color:c.color||"#334155",zone_id:c.zone_id,next_maintenance_date:c.next_maintenance_date}}),m.value=(o.connections||[]).map(c=>({id:c.id||`conn-${Math.random()}`,fromId:c.from_node_id,fromSide:c.from_side,toId:c.to_node_id,toSide:c.to_side,color:c.color||"#3b82f6"})),$.value=o.labels||[],requestAnimationFrame(pt),s.add({severity:"info",summary:i("networks.systemUpdated"),detail:i("networks.networkLoaded",{name:o.name}),life:2e3})},z=J(()=>{const o=new Set,c=n=>{if(o.has(n))return;const f=u.value.find(g=>g.id===n);!f||!f.active||(o.add(n),m.value.filter(g=>g.fromId===n).forEach(g=>c(g.toId)))};u.value.filter(n=>n.isRoot&&n.active).forEach(n=>c(n.id));const h=new Set(m.value.filter(n=>{const f=u.value.find(p=>p.id===n.fromId),g=u.value.find(p=>p.id===n.toId);return!f||!g?!1:o.has(n.fromId)&&g.isBusbar&&f.active||o.has(n.toId)&&f.isBusbar&&g.active}).flatMap(n=>[n.fromId,n.toId]).filter(n=>{var f;return(f=u.value.find(g=>g.id===n))==null?void 0:f.isBusbar}));return{liveNodes:o,liveBusbars:h}}),ft=J(()=>u.value.filter(o=>{const c=o.x+o.w,h=o.y+o.h,n=L.x+L.width,f=L.y+L.height;return o.x<n&&c>L.x&&o.y<f&&h>L.y})),Dt=J(()=>{const o=new Set(ft.value.map(c=>c.id));return m.value.filter(c=>o.has(c.fromId)||o.has(c.toId))}),ht=o=>{var c;if(o.zone_id){const h=e.zones.find(n=>n.id===o.zone_id);if(h)return h.nomenclature||h.name}return o.region_id?(c=e.regions.find(h=>h.id===o.region_id))==null?void 0:c.designation:i("networks.defaultRegion")},Z=o=>z.value.liveNodes.has(o.fromId),W=J(()=>{const o=u.value.length,c=u.value.filter(n=>n.active).length,h=o>0?Math.round(c/o*100):0;return{efficiency:h,active:c,total:o,liveConnections:m.value.filter(n=>Z(n)).length,sources:u.value.filter(n=>n.isRoot).length,status:h>80?i("networks.status.optimal"):h>40?i("networks.status.unstable"):i("networks.status.critical")}}),zt=o=>N.get(route("networks.edit",o)),At=o=>N.get(route("networks.edit",o),{data:{action:"duplicate"}}),Vt=o=>{r.require({message:i("networks.deleteConfirmMessage"),header:i("networks.deleteConfirmHeader"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger p-button-sm",accept:()=>{N.delete(route("networks.destroy",o),{onSuccess:()=>s.add({severity:"success",summary:i("networks.deletedSummary"),detail:i("networks.deletedSuccess"),life:3e3})})}})},q=(o,c)=>{if(!o)return{x:0,y:0};if(o.isBusbar){if(c==="N")return{x:o.x,y:o.y,w:o.w};if(c==="S")return{x:o.x,y:o.y+o.h,w:o.w}}switch(c){case"N":return{x:o.x+o.w/2,y:o.y};case"S":return{x:o.x+o.w/2,y:o.y+o.h};case"E":return{x:o.x+o.w,y:o.y+o.h/2};case"W":return{x:o.x,y:o.y+o.h/2}}return{x:o.x,y:o.y}},mt=o=>{const c=u.value.find(I=>I.id===o.fromId),h=u.value.find(I=>I.id===o.toId);if(!c||!h)return"";let n=q(c,o.fromSide),f=q(h,o.toSide);if(c.isBusbar&&!h.isBusbar){const I=q(h,o.toSide),B=Math.max(0,Math.min(I.x-c.x,c.w));n={x:c.x+B,y:o.fromSide==="N"?c.y:c.y+c.h}}else if(h.isBusbar&&!c.isBusbar){const I=q(c,o.fromSide),B=Math.max(0,Math.min(I.x-h.x,h.w));f={x:h.x+B,y:o.toSide==="N"?h.y:h.y+h.h}}else c.isBusbar&&h.isBusbar&&(n={x:c.x+c.w/2,y:o.fromSide==="N"?c.y:c.y+c.h},f={x:h.x+h.w/2,y:o.toSide==="N"?h.y:h.y+h.h});const g=Math.abs(f.x-n.x),p=Math.abs(f.y-n.y),_=n.x+(f.x-n.x)/2,S=n.y+(f.y-n.y)/2;return g>p?`M ${n.x} ${n.y} L ${_} ${n.y} L ${_} ${f.y} L ${f.x} ${f.y}`:`M ${n.x} ${n.y} L ${n.x} ${S} L ${f.x} ${S} L ${f.x} ${f.y}`},jt=o=>{if(!o||!o.isBusbar)return"";const c=m.value.find(p=>{var _;return p.toId===o.id&&z.value.liveNodes.has(p.fromId)||p.fromId===o.id&&z.value.liveNodes.has(p.toId)&&!((_=u.value.find(S=>S.id===p.toId))!=null&&_.isBusbar)});if(!c)return`M 0 ${o.h/2} L ${o.w} ${o.h/2}`;const h=m.value.filter(p=>p.fromId===o.id&&p.id!==c.id),n=p=>{const _=p.fromId===o.id?p.toId:p.fromId,S=u.value.find(it=>it.id===_);if(!S)return o.w/2;const I=p.fromId===o.id?p.toSide:p.fromSide,B=q(S,I);return Math.max(0,Math.min(B.x-o.x,o.w))},f=n(c);return h.map(n).map(p=>`M ${f} ${o.h/2} L ${p} ${o.h/2}`).join(" ")},Ht=(o,c)=>{const h=o.clientX,n=o.clientY,f=c.x,g=c.y,p=S=>{c.x=Math.round((f+(S.clientX-h)/w.value)/10)*10,c.y=Math.round((g+(S.clientY-n)/w.value)/10)*10},_=()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",_)};window.addEventListener("mousemove",p),window.addEventListener("mouseup",_)},ot=()=>{if(!P.value)return;const o=P.value;L.x=o.scrollLeft/w.value-tt,L.y=o.scrollTop/w.value-tt,L.width=o.clientWidth/w.value+tt*2,L.height=o.clientHeight/w.value+tt*2};Kt([w],()=>{requestAnimationFrame(ot)});const pt=()=>{if(u.value.length===0)return;const o=P.value;if(!o)return;const c=o.clientWidth,h=o.clientHeight;let n=1/0,f=1/0,g=-1/0,p=-1/0;u.value.forEach(A=>{n=Math.min(n,A.x),f=Math.min(f,A.y),g=Math.max(g,A.x+A.w),p=Math.max(p,A.y+A.h)});const _=g-n,S=p-f;if(_===0||S===0)return;const I=.1,B=c/(_*(1+I)),it=h/(S*(1+I)),at=Math.min(B,it,1.5);w.value=at;const Ot=n+_/2,Ut=f+S/2;o.scrollLeft=Ot*at-c/2,o.scrollTop=Ut*at-h/2},gt=o=>{if(!P.value)return;const h={quality:.98,pixelRatio:2,backgroundColor:"var(--surface-ground)",fetchRequestInit:{headers:new Headers,mode:"cors",cache:"no-cache"}};(o==="png"?Ne:Bt)(P.value,h).then(function(f){const g=document.createElement("a");g.download=`${l.value}_${new Date().toISOString().slice(0,10)}.${o}`,g.href=f,g.click(),s.add({severity:"success",summary:"Exportation réussie",detail:`Le schéma a été téléchargé en ${o.toUpperCase()}.`,life:3e3})}).catch(function(f){console.error("Erreur lors de l'exportation:",f),s.add({severity:"error",summary:"Erreur d'exportation",detail:"Impossible de générer l'image.",life:3e3})})};return Zt(()=>{e.initialNetwork?nt(e.initialNetwork):e.networks.length>0&&nt(e.networks[0]),ot()}),(o,c)=>{const h=Wt;return x(),Jt(ee,null,{default:xt(()=>[R(b(Nt),{title:`${b(i)("networks.title")} - ${l.value}`},null,8,["title"]),d("div",Qe,[R(b(se)),R(b(re)),d("header",ts,[d("div",es,[ss,d("div",null,[d("h1",rs,v(l.value),1),d("span",ns,v(b(i)("networks.monitoringLive")),1)])]),d("div",os,[d("div",is,[as,R(b(ne),{modelValue:w.value,"onUpdate:modelValue":c[0]||(c[0]=n=>w.value=n),min:.2,max:2,step:.01,class:"w-32"},null,8,["modelValue"]),d("span",cs,v(Math.round(w.value*100))+"%",1),X(R(b(D),{icon:"pi pi-arrows-alt",onClick:pt,class:"p-button-text p-button-sm !text-color-secondary"},null,512),[[h,"Centrer la vue",void 0,{bottom:!0}]]),ls,X(R(b(D),{icon:"pi pi-image",onClick:c[1]||(c[1]=n=>gt("png")),class:"p-button-text p-button-sm !text-color-secondary"},null,512),[[h,"Exporter en PNG",void 0,{bottom:!0}]]),X(R(b(D),{icon:"pi pi-file",onClick:c[2]||(c[2]=n=>gt("svg")),class:"p-button-text p-button-sm !text-color-secondary"},null,512),[[h,"Exporter en SVG",void 0,{bottom:!0}]])])])]),d("div",us,[d("div",ds,[d("span",fs,v(b(i)("networks.infrastructureDirectory")),1),R(b(D),{icon:"pi pi-plus-circle",label:b(i)("networks.newNetwork"),onClick:c[3]||(c[3]=n=>b(N).get(o.route("networks.create"))),class:"p-button-text p-button-sm font-bold"},null,8,["label"])]),R(b(oe),{value:e.networks,numVisible:7,numScroll:1,class:"custom-carousel"},{item:xt(n=>{var f;return[d("div",hs,[d("div",{onClick:g=>nt(n.data),class:G(["h-20 p-3 rounded-2xl border-2 transition-all duration-300 cursor-pointer flex flex-col justify-between relative overflow-hidden shadow-sm",a.value===n.data.id?"border-primary-color bg-primary-50 dark:bg-primary-900/20":"border-surface-50 bg-surface-50/50 hover:bg-surface-0 hover:border-surface-200"])},[d("div",ps,[d("span",gs,v(n.data.name),1),a.value===n.data.id?(x(),y("div",xs)):E("",!0)]),d("div",ys,[d("span",ws,v(((f=n.data.region)==null?void 0:f.designation)||b(i)("networks.defaultRegion")),1)]),d("div",bs,[R(b(D),{icon:"pi pi-copy",onClick:Y(g=>At(n.data.id),["stop"]),class:"p-button-rounded p-button-text p-button-secondary bg-surface-0 shadow-md !p-2"},null,8,["onClick"]),R(b(D),{icon:"pi pi-pencil",onClick:Y(g=>zt(n.data.id),["stop"]),class:"p-button-rounded p-button-text p-button-primary bg-surface-0 shadow-md !p-2"},null,8,["onClick"]),R(b(D),{icon:"pi pi-trash",onClick:Y(g=>Vt(n.data.id),["stop"]),class:"p-button-rounded p-button-text p-button-danger bg-surface-0 shadow-md !p-2"},null,8,["onClick"])])],10,ms)])]}),_:1},8,["value"])]),d("div",vs,[d("main",{ref_key:"exportContainer",ref:P,class:"flex-grow relative bg-surface-ground overflow-auto shadow-inner scroll-smooth select-none",onScroll:ot,onMousedown:c[4]||(c[4]=n=>o.selectedIds=[])},[d("div",{style:K({transform:`scale(${w.value})`,transformOrigin:"0 0"}),class:"absolute inset-0 transition-transform duration-75"},[(x(),y("svg",_s,[Ss,(x(!0),y(V,null,j(Dt.value,n=>(x(),y("g",{key:n.id},[d("path",{d:mt(n),stroke:Z(n)?n.color:"#1e293b","stroke-width":"3",fill:"none",class:"transition-colors duration-700",filter:Z(n)?"url(#neon-glow)":""},null,8,ks),Z(n)?(x(),y("g",Es,[(x(),y(V,null,j(Et,f=>d("circle",{key:f,r:"3",fill:"#81f50c",class:"electron-pulse"},[d("animateMotion",{path:mt(n),dur:Q+"s",begin:(f-1)*(Q/Et)+"s",repeatCount:"indefinite"},null,8,Cs)])),64))])):E("",!0)]))),128))])),(x(!0),y(V,null,j($.value,n=>(x(),y("div",{key:n.id,style:K({left:n.x+"px",top:n.y+"px",color:n.color,fontSize:n.font_size+"px",fontWeight:n.is_bold?"bold":"normal",transform:`rotate(${n.rotation||0}deg)`}),class:"absolute z-10 px-2 py-1 whitespace-nowrap pointer-events-none drop-shadow-sm"},v(n.text),5))),128)),(x(!0),y(V,null,j(ft.value,n=>(x(),y("div",{key:n.id,style:K({left:n.x+"px",top:n.y+"px",width:n.w+"px",height:n.h+"px"}),onMousedown:Y(f=>Ht(f,n),["stop"]),class:"absolute z-20 node-card group"},[d("div",{class:G(["relative w-full h-full border-2 rounded-xl transition-all shadow-xl",n.active?"":"opacity-60 grayscale-[0.5]",n.isBusbar?"bg-slate-900 overflow-hidden":"bg-[#0f172a]"]),style:K(n.isBusbar?{"background-image":`linear-gradient(to right, ${n.color}33, #1e293b)`,"border-color":n.color}:{"border-color":"rgba(255,255,255,0.05)"})},[n.isBusbar?E("",!0):(x(),y("div",Is,[d("div",Rs,[d("span",Ls,v(n.tag),1),z.value.liveNodes.has(n.id)?(x(),y("i",Ms)):E("",!0)]),d("div",Ps,[d("i",{onClick:Y(f=>n.active=!n.active,["stop"]),class:G(["pi pi-power-off text-[10px] cursor-pointer transition-transform hover:scale-125",n.active?"text-green-500":"text-red-500"])},null,10,Ts),d("i",{class:G(["pi text-[10px] text-slate-400",n.icon])},null,2)])])),n.next_maintenance_date?X((x(),y("div",Fs,Ds)),[[h,`Maintenance : ${new Date(n.next_maintenance_date).toLocaleDateString()}`,void 0,{top:!0}]]):E("",!0),n.isBusbar?E("",!0):(x(),y("div",zs,[d("span",As,v(n.designation),1),z.value.liveNodes.has(n.id)?(x(),y("div",Vs,Os)):E("",!0),ht(n)&&!n.isBusbar?(x(),y("div",Us,[Ws,d("span",qs,v(ht(n)),1)])):E("",!0)])),n.isBusbar?(x(),y("div",Xs,[n.isRoot?(x(),y("div",Gs,[X(d("i",Ys,null,512),[[h,"Source d'énergie",void 0,{top:!0}]])])):E("",!0),z.value.liveBusbars.has(n.id)?(x(),y("div",Ks,[(x(),y("svg",Zs,[(x(),y(V,null,j(25,f=>d("circle",{key:f,r:"1.5",fill:"#f59e0b",class:"electron-glow"},[d("animateMotion",{path:jt(n),dur:`${Q}s`,begin:`${f/25*Q}s`,repeatCount:"indefinite"},null,8,Js)])),64))]))])):E("",!0)])):E("",!0),n.isBusbar?E("",!0):(x(),y(V,{key:4},j(["N","S","E","W"],f=>d("div",{key:f,class:G(["port",f])},null,2)),64))],6)],44,$s))),128))],4)],544),U.value?(x(),y("div",Ns,[d("div",Qs,[d("span",tr,v(b(i)("networks.stats.title")),1),er]),d("div",sr,[d("div",rr,[d("span",nr,v(b(i)("networks.stats.equipments")),1),d("span",or,v(W.value.active)+"/"+v(W.value.total),1)]),d("div",ir,[d("div",{class:"h-full bg-primary-color",style:K({width:W.value.efficiency+"%"})},null,4)]),d("div",ar,[d("span",cr,v(b(i)("networks.stats.activeFlux")),1),d("span",lr,v(W.value.liveConnections),1)]),d("div",ur,[d("span",dr,v(b(i)("networks.stats.sources")),1),d("span",fr,v(W.value.sources),1)])])])):E("",!0)])])]),_:1})}}},Dr=ie(pr,[["__scopeId","data-v-4fe8045d"]]);export{Dr as default};
