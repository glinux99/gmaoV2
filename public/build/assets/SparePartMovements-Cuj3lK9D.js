import{T as Z}from"./index-BeMiMaX7.js";import{s as J}from"./index-DdT1qFJk.js";import{s as X}from"./index-JNFFLNI-.js";import{u as Y,a as ee,b as te,r as v,F as U,c as se,T as ae,d as C,e as M,f as d,g as e,o as y,i as o,Z as oe,j as t,k as L,t as i,q as V,p as q,l as le,h as re,x as ie,y as ne}from"./app-B4oSAkVP.js";import{_ as de}from"./AppLayout-CEyAmMP5.js";import{s as pe}from"./index-CRfXkZE2.js";import{s as ce}from"./index-WjAcbiK8.js";import{s as _,a as ue}from"./index-YrJ63t72.js";import{s as u}from"./index-DVIMWJjq.js";import{s as me}from"./index-DzuzenO3.js";import{s as O}from"./index-DzCpZxvp.js";import{s as T}from"./index-C20p2cSe.js";import{s as ve}from"./index-LzhPMz77.js";import{a as fe,s as xe}from"./index-Dhf6pfmr.js";import{s as _e}from"./index-DTLAliIa.js";import{s as be}from"./index-CZOaMDIN.js";import{s as he}from"./index-D82-jNZI.js";import{s as ge}from"./index-BOVQwgbQ.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BM7dsjYe.js";import"./index-DZohkDvD.js";import"./DropdownLink-B59JWmkM.js";import"./index-DjU5rnlX.js";import"./index-W2upbyuC.js";import"./index-gwiffqIQ.js";import"./index-DecA6guR.js";const c=m=>(ie("data-v-41f129a9"),m=m(),ne(),m),we={class:"quantum-v11-container p-4 lg:p-8 bg-[#f8fafc] min-h-screen"},Pe={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},ke={class:"flex items-center gap-4"},Me=c(()=>t("div",{class:"flex h-16 w-16 items-center justify-center rounded-[1rem] bg-primary-600 shadow-xl shadow-primary-200 text-white text-2xl"},[t("i",{class:"pi pi-arrows-h"})],-1)),Ve={class:"text-2xl font-black tracking-tighter text-slate-900 uppercase"},qe=c(()=>t("span",{class:"text-primary-600"},"GMAO",-1)),Se={class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},Ce={class:"flex gap-2"},Te={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},$e={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Ue=c(()=>t("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[t("i",{class:"pi pi-sync text-2xl text-slate-500"})],-1)),Le={class:"text-2xl font-black text-slate-800"},je={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Fe={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Ae=c(()=>t("div",{class:"w-14 h-14 rounded-xl bg-green-50 flex items-center justify-center"},[t("i",{class:"pi pi-arrow-down text-2xl text-green-500"})],-1)),Ne={class:"text-2xl font-black text-slate-800"},De={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Ie={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Oe=c(()=>t("div",{class:"w-14 h-14 rounded-xl bg-red-50 flex items-center justify-center"},[t("i",{class:"pi pi-arrow-up text-2xl text-red-500"})],-1)),Be={class:"text-2xl font-black text-slate-800"},Ee={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Re={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},ze=c(()=>t("div",{class:"w-14 h-14 rounded-xl bg-sky-50 flex items-center justify-center"},[t("i",{class:"pi pi-box text-2xl text-sky-500"})],-1)),Ge={class:"text-2xl font-black text-slate-800"},He={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Qe={class:"card-v11 overflow-hidden border border-slate-200 rounded-2xl bg-white shadow-sm"},Ke={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},We={class:"flex items-center gap-2"},Ze={class:"flex items-center gap-3 px-4 py-3 bg-slate-50"},Je=c(()=>t("i",{class:"pi pi-box text-primary-500"},null,-1)),Xe={class:"font-bold text-primary-700"},Ye={class:"text-xs text-slate-500"},et={class:"font-mono text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded-md"},tt={class:"font-mono font-black text-lg"},st={key:0,class:"flex w-fit items-center gap-3 rounded-full bg-slate-50 p-1 pr-4 border border-slate-100"},at={class:"text-sm font-bold text-slate-700"},ot={class:"text-xs font-medium text-slate-500"},lt={class:"flex justify-end gap-2"},rt={class:"p-2 space-y-3"},it=c(()=>t("span",{class:"text-[10px] font-black uppercase text-slate-400 block border-b pb-2"},"Colonnes actives",-1)),nt={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center rounded-xl"},dt={class:"flex items-center gap-4"},pt=c(()=>t("div",{class:"p-2.5 bg-primary-500/20 rounded-xl border border-primary-500/30"},[t("i",{class:"pi pi-sync text-blue-400 text-xl"})],-1)),ct={class:"flex flex-col"},ut={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},mt={class:"text-[9px] text-primary-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"},vt={class:"p-8 bg-white max-h-[70vh] overflow-y-auto scroll-smooth grid grid-cols-1 md:grid-cols-2 gap-8"},ft={class:"space-y-6"},xt={class:"text-xs font-black uppercase text-primary-600 tracking-widest flex items-center gap-2"},_t=c(()=>t("i",{class:"pi pi-sitemap"},null,-1)),bt={class:"field"},ht={class:"text-[10px] font-extrabold text-slate-400 uppercase ml-2 mb-1 block"},gt={class:"field"},yt={class:"text-[10px] font-extrabold text-slate-400 uppercase ml-2 mb-1 block"},wt={class:"field"},Pt={class:"text-[10px] font-extrabold text-slate-400 uppercase ml-2 mb-1 block"},kt={class:"space-y-6 p-6 bg-slate-50 rounded-3xl border border-slate-100"},Mt={class:"text-xs font-black uppercase text-primary-600 tracking-widest flex items-center gap-2"},Vt=c(()=>t("i",{class:"pi pi-list-check"},null,-1)),qt={class:"field"},St={class:"text-[10px] font-extrabold text-slate-400 uppercase ml-2 mb-1 block"},Ct={class:"field"},Tt={class:"text-[10px] font-extrabold text-slate-400 uppercase ml-2 mb-1 block"},$t={class:"field"},Ut={class:"text-[10px] font-extrabold text-slate-400 uppercase ml-2 mb-1 block"},Lt={class:"flex justify-between items-center w-full px-8 py-4 bg-slate-50 border-t border-slate-100"},jt={__name:"SparePartMovements",props:{sparePartMovements:Object,filters:Object,regions:Array,unities:Array,spareParts:Array,users:Array},setup(m){const w=m,{t:s}=Y(),$=ee(),B=te(),b=v(!1),j=v(!1),f=v(!1),F=v(),x=v({global:{value:null,matchMode:U.CONTAINS},type:{value:null,matchMode:U.EQUALS},"user.name":{operator:se.AND,constraints:[{value:null,matchMode:U.STARTS_WITH}]}}),E=()=>{x.value.global.value=null,x.value.type.value=null,x.value["user.name"].constraints[0].value=null},l=ae({id:null,spare_part_id:null,user_id:null,type:null,quantity:0,location:null,region_id:null,unity_id:null,notes:null}),A=v(),N=v([{field:"type",header:"Type"},{field:"quantity",header:"QuantitÃ©"},{field:"user.name",header:"Utilisateur"},{field:"location",header:"Emplacement"}]),h=v(N.value.map(n=>n.field)),R=()=>{l.reset(),f.value=!1,j.value=!1,b.value=!0},D=()=>{b.value=!1},z=n=>{var r;l.id=n.id,l.spare_part_id=n.spare_part_id,l.user_id=n.user_id,l.type=n.type,l.quantity=n.quantity,l.location=n.location,l.region_id=((r=n.spare_part)==null?void 0:r.region_id)||null,l.unity_id=n.unity_id,l.notes=n.notes,f.value=!0,b.value=!0},G=()=>{j.value=!0;const n=f.value?route("spare-part-movements.update",l.id):route("spare-part-movements.store"),r=f.value?"put":"post";l.submit(r,n,{onSuccess:()=>{b.value=!1,$.add({severity:"success",summary:s("common.success"),detail:f.value?s("sparePartMovements.toast.updateSuccess"):s("sparePartMovements.toast.createSuccess"),life:4e3}),l.reset()},onError:g=>{console.error("Erreur lors de la sauvegarde du mouvement",g);const P=Object.values(g).flat().join(" ; ");$.add({severity:"error",summary:s("common.error"),detail:P||s("sparePartMovements.toast.saveError"),life:5e3})}})},H=n=>{B.require({message:s("sparePartMovements.confirm.deleteMessage",{reference:n.spare_part.reference}),header:s("confirm.deleteHeader"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{re.delete(route("spare-part-movements.destroy",n.id),{onSuccess:()=>$.add({severity:"success",summary:s("common.success"),detail:s("sparePartMovements.toast.deleteSuccess"),life:3e3})})}})},I=C(()=>[{label:s("sparePartMovements.movementTypes.entry"),value:"entree"},{label:s("sparePartMovements.movementTypes.exit"),value:"sortie"}]),Q=C(()=>l.region_id?w.spareParts.filter(n=>n.region_id===l.region_id).map(n=>({...n,label:`${n.reference} | ${s("sparePartMovements.stockLabel")}: ${n.quantity}`})):[]),S=C(()=>{const n=w.sparePartMovements.data.length,r=w.sparePartMovements.data.filter(p=>p.type==="entree").length,g=w.sparePartMovements.data.filter(p=>p.type==="sortie").length,P=new Set(w.sparePartMovements.data.map(p=>p.spare_part_id)).size;return{total:n,entries:r,exits:g,uniqueParts:P}}),K=C(()=>f.value?s("sparePartMovements.dialog.editTitle"):s("sparePartMovements.dialog.createTitle")),W=()=>{F.value.exportCSV()};return(n,r)=>{const g=X,P=J,p=Z;return y(),M(de,{title:e(s)("sparePartMovements.title")},{default:d(()=>[o(e(oe),{title:e(s)("sparePartMovements.headTitle")},null,8,["title"]),t("div",we,[o(g),o(P),t("div",Pe,[t("div",ke,[Me,t("div",null,[t("h1",Ve,[L(i(e(s)("sparePartMovements.title"))+" ",1),qe]),t("p",Se,i(e(s)("sparePartMovements.subtitle")),1)])]),t("div",Ce,[o(e(u),{label:e(s)("sparePartMovements.toolbar.addMovement"),icon:"pi pi-plus",class:"shadow-lg shadow-primary-200",onClick:R},null,8,["label"])])]),t("div",Te,[t("div",$e,[Ue,t("div",null,[t("div",Le,i(S.value.total),1),t("div",je,i(e(s)("sparePartMovements.stats.total")),1)])]),t("div",Fe,[Ae,t("div",null,[t("div",Ne,i(S.value.entries),1),t("div",De,i(e(s)("sparePartMovements.stats.entries")),1)])]),t("div",Ie,[Oe,t("div",null,[t("div",Be,i(S.value.exits),1),t("div",Ee,i(e(s)("sparePartMovements.stats.exits")),1)])]),t("div",Re,[ze,t("div",null,[t("div",Ge,i(S.value.uniqueParts),1),t("div",He,i(e(s)("sparePartMovements.stats.uniqueParts")),1)])])]),t("div",Qe,[o(e(ue),{value:m.sparePartMovements.data,ref_key:"dt",ref:F,dataKey:"id",rows:10,paginator:"",responsiveLayout:"scroll",class:"p-datatable-sm quantum-table",filters:x.value,"onUpdate:filters":r[2]||(r[2]=a=>x.value=a),filterDisplay:"menu",globalFilterFields:["spare_part.reference","spare_part.name","user.name","location"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:e(s)("common.paginationReport"),rowGroupMode:"subheader",groupRowsBy:"spare_part.reference",sortMode:"single",sortField:"spare_part.reference",sortOrder:1},{header:d(()=>[t("div",Ke,[o(e(fe),{iconPosition:"left"},{default:d(()=>[o(e(xe),{class:"pi pi-search text-slate-400"}),o(e(O),{modelValue:x.value.global.value,"onUpdate:modelValue":r[0]||(r[0]=a=>x.value.global.value=a),placeholder:e(s)("sparePartMovements.toolbar.searchPlaceholder"),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),t("div",We,[V(o(e(u),{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:E,class:"rounded-xl"},null,512),[[p,e(s)("common.resetFilters"),void 0,{bottom:!0}]]),V(o(e(u),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:W},null,512),[[p,e(s)("common.export"),void 0,{bottom:!0}]]),V(o(e(u),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:r[1]||(r[1]=a=>A.value.toggle(a))},null,512),[[p,e(s)("common.columns"),void 0,{bottom:!0}]])])])]),groupheader:d(a=>[t("div",Ze,[Je,t("span",Xe,i(a.data.spare_part.reference),1),t("span",Ye,"("+i(a.data.spare_part.name)+")",1)])]),default:d(()=>[o(e(_),{selectionMode:"multiple",headerStyle:"width: 3rem"}),o(e(_),{field:"spare_part.reference",header:e(s)("spareParts.table.reference"),sortable:""},{body:d(({data:a})=>[t("span",et,i(a.spare_part.reference),1)]),_:1},8,["header"]),h.value.includes("type")?(y(),M(e(_),{key:0,field:"type",header:e(s)("sparePartMovements.table.type"),style:{"min-width":"10rem"}},{body:d(({data:a})=>[o(e(he),{value:a.type==="entree"?e(s)("sparePartMovements.movementTypes.entry"):e(s)("sparePartMovements.movementTypes.exit"),severity:a.type==="entree"?"success":"danger",icon:a.type==="entree"?"pi pi-arrow-down":"pi pi-arrow-up",class:"uppercase text-[9px] px-2"},null,8,["value","severity","icon"])]),filter:d(({filterModel:a})=>[o(e(T),{modelValue:a.value,"onUpdate:modelValue":k=>a.value=k,options:I.value,optionLabel:"label",optionValue:"value",placeholder:e(s)("sparePartMovements.filter.byType"),class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"])):q("",!0),h.value.includes("quantity")?(y(),M(e(_),{key:1,field:"quantity",header:e(s)("sparePartMovements.table.quantity"),sortable:"",style:{"min-width":"8rem"}},{body:d(({data:a})=>[t("span",tt,i(a.quantity),1)]),_:1},8,["header"])):q("",!0),h.value.includes("user.name")?(y(),M(e(_),{key:2,field:"user.name",header:e(s)("sparePartMovements.table.user"),style:{"min-width":"12rem"}},{body:d(({data:a})=>[a.user?(y(),le("div",st,[o(e(ge),{label:a.user.name[0],shape:"circle",class:"!bg-slate-900 !text-white !font-black"},null,8,["label"]),t("span",at,i(a.user.name),1)])):q("",!0)]),filter:d(({filterModel:a})=>[o(e(O),{modelValue:a.constraints[0].value,"onUpdate:modelValue":k=>a.constraints[0].value=k,type:"text",class:"p-column-filter",placeholder:e(s)("sparePartMovements.filter.byUser")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):q("",!0),h.value.includes("location")?(y(),M(e(_),{key:3,field:"location",header:e(s)("sparePartMovements.table.location"),style:{"min-width":"10rem"}},{body:d(({data:a})=>[t("span",ot,i(a.location),1)]),_:1},8,["header"])):q("",!0),o(e(_),{header:"Actions",alignFrozen:"right",frozen:"",class:"pr-8"},{body:d(({data:a})=>[t("div",lt,[V(o(e(u),{icon:"pi pi-pencil",text:"",rounded:"",onClick:k=>z(a),class:"!text-slate-400 hover:!bg-primary-50 hover:!text-primary-600 transition-all"},null,8,["onClick"]),[[p,"Modifier",void 0,{top:!0}]]),V(o(e(u),{icon:"pi pi-trash",text:"",rounded:"",onClick:k=>H(a),class:"!text-slate-400 hover:!bg-red-50 hover:!text-red-500 transition-all"},null,8,["onClick"]),[[p,"Supprimer",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","filters","currentPageReportTemplate"])]),o(e(pe),{ref_key:"op",ref:A,class:"quantum-overlay"},{default:d(()=>[t("div",rt,[it,o(e(ce),{modelValue:h.value,"onUpdate:modelValue":r[3]||(r[3]=a=>h.value=a),options:N.value,optionLabel:"header",display:"chip",class:"w-64 quantum-multiselect"},null,8,["modelValue","options"])])]),_:1},512),o(e(me),{visible:b.value,"onUpdate:visible":r[10]||(r[10]=a=>b.value=a),modal:"",header:!1,closable:!1,style:{width:"55rem"},class:"quantum-dialog",pt:{mask:{style:"backdrop-filter: blur(6px)"},content:{class:"p-0 rounded-3xl border-none shadow-2xl"}}},{footer:d(()=>[t("div",Lt,[o(e(u),{label:e(s)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:D,class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),o(e(u),{label:e(s)("common.save"),icon:"pi pi-check-circle",severity:"primary",class:"px-10 h-14 rounded-2xl shadow-xl shadow-primary-100 font-black uppercase tracking-widest text-xs",onClick:G,loading:e(l).processing},null,8,["label","loading"])])]),default:d(()=>[t("div",nt,[t("div",dt,[pt,t("div",ct,[t("h2",ut,i(K.value),1),t("span",mt,i(f.value?e(s)("sparePartMovements.dialog.editSubtitle"):e(s)("sparePartMovements.dialog.createSubtitle")),1)])]),o(e(u),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:D,class:"text-white hover:bg-white/10"})]),t("div",vt,[t("div",ft,[t("h4",xt,[_t,L(" "+i(e(s)("sparePartMovements.dialog.fluxIdentification")),1)]),t("div",bt,[t("label",ht,i(e(s)("sparePartMovements.form.region")),1),o(e(T),{modelValue:e(l).region_id,"onUpdate:modelValue":r[4]||(r[4]=a=>e(l).region_id=a),options:m.regions,optionLabel:"designation",optionValue:"id",placeholder:e(s)("sparePartMovements.form.regionPlaceholder"),class:"w-full quantum-input-v16"},null,8,["modelValue","options","placeholder"])]),t("div",gt,[t("label",yt,i(e(s)("sparePartMovements.form.sparePart")),1),o(e(T),{modelValue:e(l).spare_part_id,"onUpdate:modelValue":r[5]||(r[5]=a=>e(l).spare_part_id=a),options:Q.value,optionLabel:"label",optionValue:"id",placeholder:e(s)("sparePartMovements.form.sparePartPlaceholder"),disabled:!e(l).region_id,filter:"",class:"w-full quantum-input-v16"},null,8,["modelValue","options","placeholder","disabled"])]),t("div",wt,[t("label",Pt,i(e(s)("sparePartMovements.form.movementType")),1),o(e(ve),{modelValue:e(l).type,"onUpdate:modelValue":r[6]||(r[6]=a=>e(l).type=a),options:I.value,optionLabel:"label",optionValue:"value",class:"v16-select-button"},null,8,["modelValue","options"])])]),t("div",kt,[t("h4",Mt,[Vt,L(" "+i(e(s)("sparePartMovements.dialog.detailsValidation")),1)]),t("div",qt,[t("label",St,i(e(s)("sparePartMovements.form.quantity")),1),o(e(be),{modelValue:e(l).quantity,"onUpdate:modelValue":r[7]||(r[7]=a=>e(l).quantity=a),showButtons:"",buttonLayout:"horizontal",min:1,inputClass:"text-2xl font-black text-center",class:"w-full"},null,8,["modelValue"])]),t("div",Ct,[t("label",Tt,i(e(s)("sparePartMovements.form.user")),1),o(e(T),{modelValue:e(l).user_id,"onUpdate:modelValue":r[8]||(r[8]=a=>e(l).user_id=a),options:m.users,optionLabel:"name",optionValue:"id",placeholder:e(s)("sparePartMovements.form.userPlaceholder"),class:"w-full quantum-input-v16"},null,8,["modelValue","options","placeholder"])]),t("div",$t,[t("label",Ut,i(e(s)("sparePartMovements.form.notes")),1),o(e(_e),{modelValue:e(l).notes,"onUpdate:modelValue":r[9]||(r[9]=a=>e(l).notes=a),rows:"2",class:"w-full text-sm quantum-input-v16"},null,8,["modelValue"])])])])]),_:1},8,["visible"])])]),_:1},8,["title"])}}},is=ye(jt,[["__scopeId","data-v-41f129a9"]]);export{is as default};
