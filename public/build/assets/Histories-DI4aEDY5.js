import{T as $}from"./index-CrFEKHH1.js";import{b as A,a as C,r as D,F,l as p,i as r,g as o,j as s,f as i,m as N,o as u,t as l,e as x,s as V,k as f,q as T,p as j,x as L,y as q,h as M}from"./app-gDNqx2_D.js";import{s as n,a as B}from"./index-C2t85Ev4.js";import{s as v}from"./index-BHExvObj.js";import{s as E}from"./index-DnMOyY1I.js";import{a as z,s as H}from"./index-3Y3FmX7C.js";import{s as O}from"./index-BFXGy4uN.js";import{s as P}from"./index-psDJnd0s.js";import{s as R}from"./index-D4DTux10.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DWMCXZ5G.js";import"./index-Sf75UUsw.js";import"./index-qcYzN5_Q.js";import"./index-Dqyvdu4C.js";import"./index-bSGFH6Vt.js";import"./index-CaNPRaEQ.js";const _=c=>(L("data-v-069a6814"),c=c(),q(),c),K={class:"space-y-6"},G=_(()=>s("div",{class:"flex flex-col md:flex-row justify-between items-end gap-4"},[s("div",{class:"text-center md:text-left"},[s("h3",{class:"text-2xl font-black text-slate-800"},"Historique des connexions"),s("p",{class:"text-slate-500"},"Voici la liste des 10 dernières connexions à votre compte.")])],-1)),J={class:"flex justify-end p-2"},Q=_(()=>s("div",{class:"p-8 text-center text-slate-500"},"Aucune connexion trouvée.",-1)),W={class:"font-medium text-slate-700"},X={key:0,class:"text-slate-600 font-semibold"},Y={key:2,class:"text-slate-400"},Z={class:"bg-slate-100 text-slate-700 px-2 py-1 rounded text-xs border border-slate-200"},ee={class:"flex items-center gap-3"},se={class:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500"},te={class:"flex flex-col"},oe={class:"text-sm font-bold text-slate-700"},re={class:"text-xs text-slate-500"},ie={class:"text-sm text-slate-600"},ae={class:"text-slate-400"},le=_(()=>s("div",{class:"p-4 bg-amber-50 text-amber-800 rounded-2xl text-sm border border-amber-200 flex gap-3 items-start"},[s("i",{class:"pi pi-exclamation-triangle mt-0.5"}),s("p",null,[s("strong",null,"Information :"),f(" Si vous remarquez une activité suspecte ou une connexion que vous ne reconnaissez pas, nous vous recommandons de changer immédiatement votre mot de passe dans l'onglet "),s("strong",null,'"Sécurité"'),f(".")])],-1)),ne={__name:"Histories",props:{logins:Object},setup(c){const b=A(),g=C(),m=D({global:{value:null,matchMode:F.CONTAINS}}),h=(t,a,d)=>t?"pi pi-mobile":a?"pi pi-tablet":d?"pi pi-desktop":"pi pi-globe",y=(t,a,d)=>t?"Mobile":a?"Tablette":d?"Ordinateur":"Inconnu",w=t=>new Date(t).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),k=t=>t==null?"N/A":t<60?`${t} sec`:`${Math.floor(t/60)} min`,S=t=>{b.require({message:"Êtes-vous sûr de vouloir fermer cette session ? L'utilisateur sera déconnecté.",header:"Confirmer la déconnexion",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",acceptLabel:"Fermer la session",rejectLabel:"Annuler",accept:()=>{M.post(route("sessions.logout",t.id),{},{preserveScroll:!0,onSuccess:()=>{g.add({severity:"success",summary:"Succès",detail:"La session a été fermée.",life:3e3})},onError:()=>{g.add({severity:"error",summary:"Erreur",detail:"Impossible de fermer la session.",life:3e3})}})}})},I=t=>t.login_successful&&!t.session_duration;return(t,a)=>{const d=$;return u(),p(N,null,[r(o(P)),r(o(R)),s("div",K,[G,r(o(B),{value:c.logins.data,filters:m.value,"onUpdate:filters":a[1]||(a[1]=e=>m.value=e),dataKey:"id",responsiveLayout:"scroll",paginator:"",rows:10,globalFilterFields:["ip_address","agent.browser","agent.platform"],class:"p-datatable-sm border border-slate-200 rounded-2xl overflow-hidden shadow-sm"},{header:i(()=>[s("div",J,[r(o(z),{iconPosition:"left",class:"w-full md:w-80"},{default:i(()=>[r(o(H),{class:"pi pi-search text-slate-400"}),r(o(E),{modelValue:m.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value.global.value=e),placeholder:"Rechercher une IP, un navigateur...",class:"w-full h-11 rounded-2xl border-slate-200 bg-slate-50/50 focus:ring-2 focus:ring-primary-500/20 focus:bg-white transition-all duration-200"},null,8,["modelValue"])]),_:1})])]),empty:i(()=>[Q]),default:i(()=>[r(o(n),{field:"login_at",header:"Date",sortable:!0,style:{"min-width":"12rem"}},{body:i(({data:e})=>[s("span",W,l(w(e.login_at)),1)]),_:1}),r(o(n),{field:"session_duration",header:"Durée",style:{"min-width":"10rem"}},{body:i(({data:e})=>[e.session_duration?(u(),p("span",X,l(k(e.session_duration)),1)):e.login_successful?(u(),x(o(v),{key:1,severity:"success",value:"En cours",class:"rounded-lg px-3"})):(u(),p("span",Y,"N/A"))]),_:1}),r(o(n),{field:"ip_address",header:"Adresse IP",style:{"min-width":"10rem"}},{body:i(({data:e})=>[s("code",Z,l(e.ip_address),1)]),_:1}),r(o(n),{header:"Appareil",style:{"min-width":"12rem"}},{body:i(({data:e})=>[s("div",ee,[s("div",se,[s("i",{class:V(h(e.agent.is_mobile,e.agent.is_tablet,e.agent.is_desktop))},null,2)]),s("div",te,[s("span",oe,l(y(e.agent.is_mobile,e.agent.is_tablet,e.agent.is_desktop)),1),s("span",re,l(e.agent.platform),1)])])]),_:1}),r(o(n),{header:"Navigateur",style:{"min-width":"12rem"}},{body:i(({data:e})=>[s("span",ie,[f(l(e.agent.browser)+" ",1),s("small",ae,"v"+l(e.agent.browser_version),1)])]),_:1}),r(o(n),{field:"login_successful",header:"Statut",sortable:!0,style:{"min-width":"8rem"}},{body:i(({data:e})=>[r(o(v),{severity:e.login_successful?"success":"danger",value:e.login_successful?"Réussie":"Échouée",class:"rounded-full px-3"},null,8,["severity","value"])]),_:1}),r(o(n),{header:"Actions",style:{"min-width":"8rem","text-align":"center"}},{body:i(({data:e})=>[I(e)?T((u(),x(o(O),{key:0,icon:"pi pi-power-off",severity:"danger",text:"",rounded:"",onClick:ce=>S(e)},null,8,["onClick"])),[[d,"Fermer la session",void 0,{top:!0}]]):j("",!0)]),_:1})]),_:1},8,["value","filters"]),le])],64)}}},$e=U(ne,[["__scopeId","data-v-069a6814"]]);export{$e as default};
