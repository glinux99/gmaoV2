import{u as l,r as o,d}from"./app-B4oSAkVP.js";function P(s,n){const{t:c}=l(),i=o(!1),a=o({ids:[],quantity:1,index:-1,type:"used"}),p=d(()=>!s.spare_parts_used||!Array.isArray(n.value)?0:s.spare_parts_used.reduce((e,t)=>{const r=n.value.find(y=>y.id===t.id),u=(r==null?void 0:r.price)||0;return e+u*t.quantity},0)),v=d(()=>Array.isArray(n.value)?n.value.map(e=>({label:`${e.reference} (${e.name}) - Stock: ${e.stock}`,value:e.id})):[]);return{sparePartDialogVisible:i,sparePartData:a,serviceOrderCost:p,sparePartOptions:v,openSparePartDialog:(e,t=null,r=-1)=>{const u=r>-1&&t;a.value={ids:u?[t.id]:[],quantity:t?t.quantity:1,index:r,type:e},i.value=!0},saveSparePart:()=>{if(a.value.ids.length===0)return;const e=a.value.type==="used"?s.spare_parts_used:s.spare_parts_returned;a.value.ids.forEach(t=>{const r=e.find(u=>u.id===t);r?r.quantity+=a.value.quantity:e.push({id:t,quantity:a.value.quantity})}),i.value=!1},removeSparePart:(e,t)=>{(e==="used"?s.spare_parts_used:s.spare_parts_returned).splice(t,1)},getSparePartReference:e=>{if(!Array.isArray(n.value))return c("myActivities.unknownReference");const t=n.value.find(r=>r.id===e);return t?t.reference:c("myActivities.unknownReference")}}}export{P as u};
