import{T as Y}from"./index-CrFEKHH1.js";import{s as J}from"./index-LIEjb82k.js";import{s as X,a as Z}from"./index-3Y3FmX7C.js";import{u as ee,a as te,b as se,r as g,F as y,c as le,T as ae,e as h,f as d,o as c,i,g as t,j as e,t as n,q as oe,l as k,k as ie,p as x,n as ne,m as re,h as de}from"./app-gDNqx2_D.js";import{d as ce}from"./debounce-CURsxuVQ.js";import{_ as me}from"./AppLayout-SGD7JHFV.js";import{s as f}from"./index-BFXGy4uN.js";import{s as j}from"./index-DnMOyY1I.js";import{s as v,a as pe}from"./index-C2t85Ev4.js";import{s as ue}from"./index-bSGFH6Vt.js";import{s as U}from"./index-qtJx-Jx6.js";import{s as q}from"./index-5fxx7ZJm.js";import{s as he}from"./index-psDJnd0s.js";import{s as xe}from"./index-DWMCXZ5G.js";import{s as fe}from"./index-D4DTux10.js";import{s as N}from"./index-DNoI7EM0.js";import{s as be}from"./index-Cj0Nnmmf.js";import"./index-qcYzN5_Q.js";import"./index-Sf75UUsw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DIW2SyDI.js";import"./index-E0OnojZQ.js";import"./index-CadKbAM9.js";import"./index-C57fO0mp.js";import"./index-Dqyvdu4C.js";import"./index-CaNPRaEQ.js";const _e={class:"min-h-screen bg-slate-50 p-4 md:p-8 font-sans"},ge={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-8"},ve={class:"flex items-center gap-4"},ye=e("div",{class:"flex h-16 w-16 items-center justify-center rounded-[2rem] bg-primary-600 shadow-xl shadow-primary-200"},[e("i",{class:"pi pi-users text-3xl text-white"})],-1),we={class:"text-3xl font-black tracking-tighter text-slate-900 md:text-4xl"},ke={class:"text-[10px] font-bold uppercase tracking-[0.3em] text-slate-400"},Ve={class:"flex w-full items-center gap-3 lg:w-auto"},Ce=e("i",{class:"pi pi-file-excel"},null,-1),Se=[Ce],$e=e("i",{class:"pi pi-plus-circle"},null,-1),Te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},je={class:"p-6 bg-white rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5"},Ue=e("div",{class:"h-12 w-12 rounded-2xl bg-primary-100 text-primary-600 flex items-center justify-center"},[e("i",{class:"pi pi-shield text-xl"})],-1),Ne={class:"text-2xl font-black text-slate-800"},Fe={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Ie={class:"p-6 bg-white rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5"},Ae=e("div",{class:"h-12 w-12 rounded-2xl bg-emerald-100 text-emerald-600 flex items-center justify-center"},[e("i",{class:"pi pi-users text-xl"})],-1),Le={class:"text-2xl font-black text-slate-800"},De={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Me={class:"p-6 bg-white rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5"},Be=e("div",{class:"h-12 w-12 rounded-2xl bg-amber-100 text-amber-600 flex items-center justify-center"},[e("i",{class:"pi pi-user-plus text-xl"})],-1),Oe={class:"text-2xl font-black text-slate-800"},qe={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},ze={class:"p-6 bg-white rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5"},Ee=e("div",{class:"h-12 w-12 rounded-2xl bg-sky-100 text-sky-600 flex items-center justify-center"},[e("i",{class:"pi pi-crown text-xl"})],-1),Pe={class:"text-2xl font-black text-slate-800"},He={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Qe={class:"bg-white rounded-[2rem] shadow-xl border border-slate-200 overflow-hidden"},Re={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},We={class:"flex items-center gap-2"},Ge=["onClick"],Ke=e("div",{class:"flex h-12 w-12 items-center justify-center rounded-2xl bg-slate-100 transition-all group-hover:bg-primary-600 group-hover:text-white text-slate-500"},[e("i",{class:"pi pi-shield text-xl"})],-1),Ye={class:"flex flex-col"},Je={class:"text-lg font-black tracking-tight text-slate-800"},Xe={class:"text-[10px] font-bold uppercase tracking-widest text-primary-500"},Ze={key:0,class:"flex w-fit items-center gap-3 rounded-full bg-slate-50 p-1 pr-4 border border-slate-100 shadow-sm"},et={class:"text-sm font-bold text-slate-700"},tt={key:1,class:"text-slate-400 text-xs italic"},st={key:0,class:"flex items-center gap-2"},lt=e("i",{class:"pi pi-map-marker text-slate-400"},null,-1),at={class:"text-sm font-medium text-slate-600"},ot={class:"flex items-center gap-2"},it=e("i",{class:"pi pi-user-minus text-slate-400"},null,-1),nt={class:"text-sm font-medium text-slate-600"},rt={class:"flex items-center gap-3"},dt={class:"text-[10px] font-black uppercase text-slate-400"},ct={class:"flex justify-end gap-2"},mt={class:"font-semibold mb-3"},pt={class:"px-8 py-5 bg-slate-900 text-white rounded-xl flex justify-between items-center relative z-50"},ut={class:"flex items-center gap-4"},ht=e("div",{class:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary-200"},[e("i",{class:"pi pi-box text-xl"})],-1),xt={class:"font-black text-slate-100 m-0"},ft=e("p",{class:"text-xs text-slate-500 m-0"},"Configuration des unités de terrain",-1),bt={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth"},_t={class:"grid grid-cols-1 md:grid-cols-12 gap-8"},gt={class:"md:col-span-12 space-y-8"},vt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},yt={class:"flex flex-col gap-2"},wt={class:"text-xs font-black text-slate-500 uppercase"},kt={class:"flex flex-col gap-2"},Vt={class:"text-xs font-black text-slate-500 uppercase"},Ct={class:"flex flex-col gap-2"},St=e("label",{class:"text-xs font-black text-slate-500 uppercase"},"Nombre de Tâcherons",-1),$t={class:"md:col-span-2 flex flex-col gap-2 mt-4"},Tt={class:"text-xs font-black text-slate-500 uppercase"},jt={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},ss={__name:"Teams",props:{regions:Array,filters:Object,technicians:Array,teams:Array,stats:Object},setup(u){const{t:l}=ee(),z=u,F=te(),E=se(),C=g(),I=g(),V=g({global:{value:null,matchMode:y.CONTAINS},name:{operator:le.AND,constraints:[{value:null,matchMode:y.STARTS_WITH}]},"team_leader.name":{value:null,matchMode:y.IN},"region.designation":{value:null,matchMode:y.EQUALS},"team_leader.name":{value:null,matchMode:y.CONTAINS},"region.designation":{value:null,matchMode:y.EQUALS}}),A=g([{field:"name",header:l("teams.fields.name")},{field:"team_leader",header:l("teams.fields.leader")},{field:"region.designation",header:l("equipments.table.region")},{field:"members",header:l("teams.fields.members")},{field:"nombre_tacherons",header:"Tâcherons"}]),b=g(A.value.map(r=>r.field)),P=r=>{I.value.toggle(r)},w=g([]),_=g(!1),o=ae({id:null,name:"",team_leader_id:null,nombre_tacherons:0,members:[]});ce(()=>{},0);const H=()=>C.value.exportCSV(),Q=()=>{o.reset(),o.id=null,o.name="",o.team_leader_id=null,o.nombre_tacherons=0,o.members=[],_.value=!0},L=r=>{o.id=r.id,o.name=r.name,o.team_leader_id=r.team_leader_id,o.nombre_tacherons=r.nombre_tacherons||0,o.members=r.members?r.members.map(a=>a.id):[],_.value=!0},R=()=>{if(o.team_leader_id&&!o.id){const r=z.technicians.find(a=>a.id===o.team_leader_id);if(r){const a=new Date,S=a.getFullYear(),$=(a.getMonth()+1).toString().padStart(2,"0"),T=a.getDate().toString().padStart(2,"0");o.name=`${r.name.split(" ")[0]}-${S}${$}${T}`}}},W=()=>{const r=o.id?route("teams.update",o.id):route("teams.store");o.submit(o.id?"put":"post",r,{onSuccess:()=>{_.value=!1,F.add({severity:"success",summary:"Succès",detail:"Équipe mise à jour",life:3e3})}})},G=r=>{E.require({message:l("teams.messages.confirmDelete",{name:r.name}),header:l("common.deleteConfirmation"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{de.delete(route("teams.destroy",r.id),{onSuccess:()=>F.add({severity:"info",summary:"Supprimé",detail:l("teams.messages.deleteSuccess"),life:3e3})})}})};return(r,a)=>{const S=X,$=Z,T=J,K=Y;return c(),h(me,{title:"Gestion des Équipes"},{default:d(()=>{var D,M,B,O;return[i(t(he)),i(t(fe)),e("div",_e,[e("div",ge,[e("div",ve,[ye,e("div",null,[e("h1",we,n(t(l)("teams.title")),1),e("p",ke,n(t(l)("teams.subtitle")),1)])]),e("div",Ve,[oe((c(),k("button",{onClick:H,class:"flex flex-1 items-center justify-center gap-2 rounded-2xl border border-slate-200 bg-white px-5 py-3 text-sm font-bold text-emerald-600 shadow-sm transition-all hover:bg-emerald-50 active:scale-95 lg:flex-none"},Se)),[[K,t(l)("common.export"),void 0,{bottom:!0}]]),e("button",{onClick:Q,class:"flex flex-[2] items-center justify-center gap-2 rounded-2xl bg-primary-600 px-6 py-4 text-sm font-black text-white shadow-lg shadow-primary-100 transition-all hover:bg-primary-700 active:scale-95 lg:flex-none"},[$e,ie(" "+n(t(l)("teams.actions.add")),1)])])]),e("div",Te,[e("div",je,[Ue,e("div",null,[e("span",Ne,n((D=u.stats)==null?void 0:D.total_teams),1),e("p",Fe,n(t(l)("teams.stats.total_teams")),1)])]),e("div",Ie,[Ae,e("div",null,[e("span",Le,n((M=u.stats)==null?void 0:M.total_members),1),e("p",De,n(t(l)("teams.stats.total_members")),1)])]),e("div",Me,[Be,e("div",null,[e("span",Oe,n((B=u.stats)==null?void 0:B.avg_members_per_team),1),e("p",qe,n(t(l)("teams.stats.avg_members")),1)])]),e("div",ze,[Ee,e("div",null,[e("span",Pe,n((O=u.stats)==null?void 0:O.teams_with_leader),1),e("p",He,n(t(l)("teams.stats.with_leader")),1)])])]),e("div",Qe,[i(t(pe),{ref_key:"dt",ref:C,value:u.teams,selection:w.value,"onUpdate:selection":a[2]||(a[2]=s=>w.value=s),filters:V.value,"onUpdate:filters":a[3]||(a[3]=s=>V.value=s),dataKey:"id",paginator:!0,rows:10,filterDisplay:"menu",globalFilterFields:["name","team_leader.name","region.designation"],class:"p-datatable-custom",removableSort:""},{header:d(()=>[e("div",Re,[i($,{iconPosition:"left"},{default:d(()=>[i(S,{class:"pi pi-search text-slate-400"}),i(t(j),{modelValue:V.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=s=>V.value.global.value=s),placeholder:t(l)("teams.toolbar.searchPlaceholder"),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),e("div",We,[i(t(f),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:a[1]||(a[1]=s=>C.value.exportCSV())}),i(t(f),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:P}),w.value&&w.value.length>0?(c(),h(t(f),{key:0,label:t(l)("common.deleteSelected",{count:w.value.length}),icon:"pi pi-trash",severity:"danger",raised:"",onClick:r.deleteSelectedTeams},null,8,["label","onClick"])):x("",!0)])])]),default:d(()=>[i(t(v),{selectionMode:"multiple",headerStyle:"width: 4rem",class:"pl-8",frozen:""}),b.value.includes("name")?(c(),h(t(v),{key:0,field:"name",header:t(l)("teams.fields.name"),sortable:"",filterField:"name"},{filter:d(({filterModel:s,filterCallback:m})=>[i(t(j),{modelValue:s.value,"onUpdate:modelValue":p=>s.value=p,type:"text",onInput:p=>m(),placeholder:t(l)("common.searchByName"),class:"p-column-filter !min-w-44"},null,8,["modelValue","onUpdate:modelValue","onInput","placeholder"])]),body:d(({data:s})=>[e("div",{class:"group flex cursor-pointer items-center gap-4 py-2",onClick:m=>L(s)},[Ke,e("div",Ye,[e("span",Je,n(s.name),1),e("span",Xe,"ID: #"+n(s.id.toString().padStart(4,"0")),1)])],8,Ge)]),_:1},8,["header"])):x("",!0),b.value.includes("team_leader")?(c(),h(t(v),{key:1,field:"team_leader.name",header:t(l)("teams.fields.leader"),sortable:"",filterField:"team_leader.name"},{filter:d(({filterModel:s,filterCallback:m})=>[i(t(U),{modelValue:s.value,"onUpdate:modelValue":p=>s.value=p,options:u.technicians,optionLabel:"name",optionValue:"name",placeholder:t(l)("teams.toolbar.filterByLeader"),onChange:p=>m(),showClear:"",filter:"",class:"p-column-filter !min-w-44"},null,8,["modelValue","onUpdate:modelValue","options","placeholder","onChange"])]),body:d(({data:s})=>[s.team_leader?(c(),k("div",Ze,[i(t(N),{label:s.team_leader.name[0],shape:"circle",class:"!bg-slate-900 !text-white !font-black"},null,8,["label"]),e("span",et,n(s.team_leader.name),1)])):(c(),k("span",tt,"Non défini"))]),_:1},8,["header"])):x("",!0),b.value.includes("region.designation")?(c(),h(t(v),{key:2,field:"region.designation",header:t(l)("equipments.table.region"),sortable:"",filterField:"region.designation"},{filter:d(({filterModel:s,filterCallback:m})=>[i(t(U),{modelValue:s.value,"onUpdate:modelValue":p=>s.value=p,options:u.regions,optionLabel:"designation",optionValue:"designation",placeholder:t(l)("teams.toolbar.filterByRegion"),onChange:p=>m(),showClear:"",filter:"",class:"p-column-filter !min-w-44"},null,8,["modelValue","onUpdate:modelValue","options","placeholder","onChange"])]),body:d(({data:s})=>[s.region?(c(),k("div",st,[lt,e("span",at,n(s.region.designation),1)])):x("",!0)]),_:1},8,["header"])):x("",!0),b.value.includes("nombre_tacherons")?(c(),h(t(v),{key:3,field:"nombre_tacherons",header:"Tâcherons",sortable:""},{body:d(({data:s})=>[e("div",ot,[it,e("span",nt,n(s.nombre_tacherons||0),1)])]),_:1})):x("",!0),b.value.includes("members")?(c(),h(t(v),{key:4,header:t(l)("teams.fields.members")},{body:d(({data:s})=>{var m;return[e("div",rt,[(m=s.members)!=null&&m.length?(c(),h(t(be),{key:0},{default:d(()=>[(c(!0),k(re,null,ne(s.members.slice(0,3),p=>(c(),h(t(N),{key:p.id,label:p.name[0],shape:"circle",class:"!border-2 !border-white !bg-primary-100 !text-primary-700 !font-bold"},null,8,["label"]))),128)),s.members.length>3?(c(),h(t(N),{key:0,label:`+${s.members.length-3}`,shape:"circle",class:"!bg-slate-800 !text-white !text-xs"},null,8,["label"])):x("",!0)]),_:2},1024)):x("",!0),e("span",dt,n(s.total_members_count||0)+" pers.",1)])]}),_:1},8,["header"])):x("",!0),i(t(v),{header:t(l)("common.actions"),alignFrozen:"right",frozen:"",class:"pr-8"},{body:d(({data:s})=>[e("div",ct,[i(t(f),{icon:"pi pi-pencil",text:"",rounded:"",onClick:m=>L(s),class:"!text-slate-400 hover:!bg-primary-50 hover:!text-primary-600 transition-all"},null,8,["onClick"]),i(t(f),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:m=>G(s),class:"!text-slate-400 hover:!bg-red-50 hover:!text-red-500 transition-all"},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","selection","filters"])]),i(T,{ref_key:"op",ref:I,appendTo:"body",id:"column_op",class:"p-4"},{default:d(()=>[e("div",mt,n(t(l)("common.columnSelector.title")),1),i(t(q),{modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=s=>b.value=s),options:A.value,optionLabel:"header",optionValue:"field",display:"chip",placeholder:t(l)("common.columnSelector.placeholder"),class:"w-full max-w-xs"},null,8,["modelValue","options","placeholder"])]),_:1},512)]),i(t(ue),{visible:_.value,"onUpdate:visible":a[11]||(a[11]=s=>_.value=s),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"600px"},contentStyle:{maxHeight:"80vh",overflow:"auto"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:d(()=>[e("div",jt,[i(t(f),{label:t(l)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[10]||(a[10]=s=>_.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),i(t(f),{label:t(o).id?t(l)("common.update"):t(l)("common.save"),icon:"pi pi-check-circle",severity:"indigo",class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",onClick:W,loading:t(o).processing},null,8,["label","loading"])])]),default:d(()=>[e("div",pt,[e("div",ut,[ht,e("div",null,[e("h4",xt,n(t(o).id?t(l)("teams.dialog.editTitle"):t(l)("teams.dialog.createTitle")),1),ft])]),i(t(f),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[5]||(a[5]=s=>_.value=!1),class:"text-white hover:bg-white/10"})]),e("div",bt,[e("div",_t,[e("div",gt,[e("div",vt,[e("div",yt,[e("label",wt,n(t(l)("teams.fields.leader")),1),i(t(U),{modelValue:t(o).team_leader_id,"onUpdate:modelValue":a[6]||(a[6]=s=>t(o).team_leader_id=s),options:u.technicians,optionLabel:"name",optionValue:"id",onChange:R,placeholder:t(l)("teams.placeholders.leader"),filter:"",class:"rounded-xl border-slate-200 py-1"},null,8,["modelValue","options","placeholder"])]),e("div",kt,[e("label",Vt,n(t(l)("teams.fields.name")),1),i(t(j),{modelValue:t(o).name,"onUpdate:modelValue":a[7]||(a[7]=s=>t(o).name=s),placeholder:t(l)("teams.placeholders.name"),class:"w-full py-3.5 rounded-xl border-slate-200 focus:ring-4 focus:ring-primary-50"},null,8,["modelValue","placeholder"])]),e("div",Ct,[St,i(t(xe),{modelValue:t(o).nombre_tacherons,"onUpdate:modelValue":a[8]||(a[8]=s=>t(o).nombre_tacherons=s),inputId:"integeronly",class:"w-full",inputClass:"py-3.5 rounded-xl border-slate-200"},null,8,["modelValue"])]),e("div",$t,[e("label",Tt,n(t(l)("teams.fields.members")),1),i(t(q),{modelValue:t(o).members,"onUpdate:modelValue":a[9]||(a[9]=s=>t(o).members=s),options:u.technicians,optionLabel:"name",optionValue:"id",placeholder:t(l)("teams.placeholders.members"),filter:"",display:"chip",class:"rounded-xl border-slate-200 py-1"},null,8,["modelValue","options","placeholder"])])])])])])]),_:1},8,["visible"])]}),_:1})}}};export{ss as default};
