import{u as ne,a as re,b as de,r as p,T as ce,F as f,c as A,d as M,e as V,f as d,o as c,i as o,g as e,Z as ue,j as s,k as L,t as r,l as b,n as pe,s as z,m as me,p as v,X as fe,q as ge,v as ve,h as T}from"./app-B4oSAkVP.js";import{_ as xe}from"./AppLayout-CEyAmMP5.js";import{s as g}from"./index-DVIMWJjq.js";import{s as U}from"./index-DzCpZxvp.js";import{s as k,a as he}from"./index-YrJ63t72.js";import{s as be}from"./index-DzuzenO3.js";import{s as B}from"./index-C20p2cSe.js";import{s as _e}from"./index-CZOaMDIN.js";import{s as ye}from"./index-JNFFLNI-.js";import{s as we}from"./index-DdT1qFJk.js";import{s as H}from"./index-D82-jNZI.js";import{s as ke}from"./index-BTBdV6Li.js";import{a as j,s as q}from"./index-Dhf6pfmr.js";import{s as Ve}from"./index-BOVQwgbQ.js";import{s as Q}from"./index-WjAcbiK8.js";import{s as Se}from"./index-CA3VxhJU.js";import{s as Ce}from"./index-CRfXkZE2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-B59JWmkM.js";import"./index-LzhPMz77.js";import"./index-DjU5rnlX.js";import"./index-W2upbyuC.js";import"./index-gwiffqIQ.js";import"./index-BM7dsjYe.js";import"./index-DecA6guR.js";import"./index-DZohkDvD.js";const Fe={class:"min-h-screen bg-slate-50/50 p-4 lg:p-8"},$e={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8"},Me={class:"flex items-center gap-4"},Ue=s("div",{class:"flex h-16 w-16 items-center justify-center rounded-[2rem] bg-primary-600 shadow-xl shadow-primary-200"},[s("i",{class:"pi pi-bolt text-2xl text-white"}),s("i",{class:"pi pi-sun text-2xl text-white -ml-2"})],-1),Ee={class:"text-3xl font-black text-slate-900 tracking-tight"},Te={class:"text-primary-600"},je={class:"text-slate-500 font-medium"},qe={class:"flex gap-3"},De={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Ne={class:"flex flex-column gap-2"},Re={class:"text-xs font-black text-slate-400 uppercase tracking-widest"},We={class:"flex items-center justify-between"},Pe={class:"text-3xl font-black text-slate-800"},Oe={class:"w-10 h-10 rounded-2xl bg-slate-50 flex items-center justify-center"},Ie={class:"bg-white rounded-[2rem] shadow-xl border border-slate-200 overflow-hidden"},Ae={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},Le={class:"flex items-center gap-2"},ze={class:"flex items-center gap-3"},Be={class:"font-bold text-slate-700"},He={key:0,class:"flex flex-col"},Qe={class:"flex justify-between items-center mb-1 w-full"},Ke={class:"text-sm font-black text-slate-700"},Xe=s("small",null,"MW",-1),Ze={class:"text-[10px] text-slate-400 font-bold"},Ge={key:1,class:"flex items-center justify-center h-full"},Je=s("span",{class:"text-red-500 font-bold text-lg"},"-",-1),Ye=[Je],et={class:"px-3 pt-2 pb-4 w-full"},tt={class:"flex justify-between mt-3 text-xs font-bold text-slate-500"},st={class:"text-sm text-slate-600"},lt={class:"flex justify-end gap-1"},ot={class:"font-semibold mb-3"},at={class:"px-8 py-5 bg-slate-900 text-white rounded-xl flex justify-between items-center relative z-50"},it={class:"flex items-center gap-4"},nt=s("div",{class:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary-200"},[s("i",{class:"pi pi-box text-xl"})],-1),rt={class:"font-black text-slate-100 m-0"},dt={class:"text-xs text-slate-500 m-0"},ct={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth"},ut={class:"grid grid-cols-1 md:grid-cols-12 gap-8"},pt={class:"md:col-span-12 space-y-8"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ft={class:"flex flex-col gap-2"},gt={class:"text-xs font-black text-slate-500 uppercase"},vt={key:0,class:"text-red-500 font-bold italic"},xt={class:"flex flex-col gap-2"},ht={class:"text-xs font-black text-slate-500 uppercase"},bt={key:0,class:"text-red-500 font-bold italic"},_t={class:"flex flex-col gap-2"},yt={class:"text-xs font-black text-slate-500 uppercase"},wt={class:"flex items-center gap-2"},kt={key:0,class:"flex flex-col gap-2"},Vt={class:"text-xs font-black text-slate-500 uppercase"},St={class:"flex flex-col gap-2"},Ct={class:"text-xs font-black text-slate-500 uppercase"},Ft={key:0,class:"text-red-500 font-bold italic"},$t={class:"md:col-span-2 flex flex-col gap-2"},Mt={class:"text-xs font-black text-slate-500 uppercase"},Ut=["placeholder"],Et={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},os={__name:"Regions",props:{regions:Object,filters:Object},setup(C){const{t:a}=ne(),F=C,$=re(),D=de(),N=p(),_=p(!1);p(!1);const R=p(!1),S=p(!1),y=p(!1),x=p(null),W=p(),n=ce({id:null,designation:"",type_centrale:"solaire",puissance_centrale:0,description:"",code:"",status:"active"}),h=p({global:{value:null,matchMode:f.CONTAINS},designation:{operator:A.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},type_centrale:{value:null,matchMode:f.IN},puissance_centrale:{value:[0,1e3],matchMode:f.BETWEEN},status:{value:null,matchMode:f.EQUALS}}),m=p({first:F.regions.from-1,rows:F.regions.per_page,sortField:"created_at",sortOrder:-1,filters:h.value}),E=()=>{y.value=!0;const i={...m.value,page:m.value.first/m.value.rows+1};T.get(route("regions.index"),i,{preserveState:!0,onFinish:()=>{y.value=!1}})},K=()=>{h.value={global:{value:null,matchMode:f.CONTAINS},designation:{operator:A.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},type_centrale:{value:null,matchMode:f.IN},puissance_centrale:{value:[0,1e3],matchMode:f.BETWEEN},status:{value:null,matchMode:f.EQUALS}},m.value.filters=h.value,E()},P=i=>{m.value=i,E()},O=p([{field:"designation",header:"Désignation",default:!0},{field:"type_centrale",header:"Source",default:!0},{field:"puissance_centrale",header:"Capacité",default:!0},{field:"description",header:"Description",default:!1},{field:"code",header:"Code",default:!1},{field:"status",header:"Statut",default:!1}]),w=p(O.value.filter(i=>i.default).map(i=>i.field)),X=i=>{W.value.toggle(i)},Z=M(()=>{const i=F.regions.data||[],l=i.reduce((t,u)=>t+(parseFloat(u.puissance_centrale)||0),0);return{total:F.regions.total||0,totalMW:l.toLocaleString("fr-FR",{minimumFractionDigits:2}),avgPower:i.length>0?(l/i.length).toFixed(1):0,highPerf:i.filter(t=>t.puissance_centrale>500).length}}),G=()=>{n.reset(),S.value=!1,R.value=!1,_.value=!0},J=i=>{n.clearErrors(),Object.assign(n,i),n.code=i.code,S.value=!0,_.value=!0},Y=()=>{if(R.value=!0,!n.designation)return;y.value=!0;const i=S.value?route("regions.update",n.id):route("regions.store"),l=S.value?"put":"post";n.submit(l,i,{onSuccess:()=>{_.value=!1,$.add({severity:"success",summary:"Succès",detail:"Région enregistrée",life:3e3}),y.value=!1},onError:()=>{y.value=!1}})},ee=i=>{D.require({message:`Voulez-vous vraiment supprimer ${i.designation} ?`,header:"Attention",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{T.delete(route("regions.destroy",i.id),{onSuccess:()=>$.add({severity:"info",summary:"Info",detail:"Supprimé"})})}})},te=()=>{D.require({message:`Voulez-vous vraiment supprimer les ${x.value.length} régions sélectionnées ?`,header:"Confirmation de suppression multiple",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:se})},se=()=>{const i=x.value.map(l=>l.id);T.post(route("regions.bulkDestroy"),{ids:i},{onSuccess:()=>{$.add({severity:"info",summary:"Info",detail:"Régions supprimées",life:3e3}),x.value=null},onError:()=>$.add({severity:"error",summary:"Erreur",detail:"Échec de la suppression",life:3e3})})},I=M(()=>[{label:a("regions.types.thermique"),value:"thermique",icon:"pi pi-bolt",color:"red"},{label:a("regions.types.solaire"),value:"solaire",icon:"pi pi-sun",color:"orange"},{label:a("regions.types.hydraulique"),value:"hydraulique",icon:"pi pi-cloud",color:"blue"},{label:a("regions.types.eolienne"),value:"eolienne",icon:"pi pi-directions",color:"green"},{label:a("regions.types.reseauElectrique"),value:"reseau Electrique",icon:"pi pi-share-alt",color:"blue"},{label:a("regions.types.autreSource"),value:"autreSource",icon:"pi pi-ellipsis-h",color:"gray"}]),le=M(()=>[{label:a("regions.status.active"),value:"active"},{label:a("regions.status.inactive"),value:"inactive"}]),oe=M(()=>({total:a("regions.stats.total"),totalMW:a("regions.stats.totalMW"),avgPower:a("regions.stats.avgPower"),highPerf:a("regions.stats.highPerf")})),ae=i=>({solaire:"yellow",thermique:"danger",hydraulique:"info",eolienne:"success","reseau Electrique":"primary"})[i]||"secondary",ie=i=>{m.value.filters=h.value,E()};return(i,l)=>(c(),V(xe,null,{default:d(()=>[o(e(ue),{title:e(a)("regions.title")},null,8,["title"]),s("div",Fe,[s("div",$e,[s("div",Me,[Ue,s("div",null,[s("h1",Ee,[L(r(e(a)("regions.headTitle"))+" ",1),s("span",Te,r(e(a)("regions.headTitle2")),1)]),s("p",je,r(e(a)("regions.subtitle")),1)])]),s("div",qe,[o(e(g),{label:e(a)("regions.actions.resetFilters"),icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:K,class:"rounded-xl"},null,8,["label"]),o(e(g),{label:e(a)("regions.actions.add"),icon:"pi pi-plus",raised:"",onClick:G,class:"rounded-xl px-6"},null,8,["label"])])]),s("div",De,[(c(!0),b(me,null,pe(Z.value,(t,u)=>(c(),b("div",{key:u,class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all"},[s("div",Ne,[s("span",Re,r(oe.value[u]),1),s("div",We,[s("span",Pe,r(t),1),s("div",Oe,[s("i",{class:z([u==="totalMW"?"pi pi-bolt":"pi pi-database","text-slate-400"])},null,2)])])])]))),128))]),s("div",Ie,[o(e(he),{ref_key:"dt",ref:N,value:C.regions.data,selection:x.value,"onUpdate:selection":l[2]||(l[2]=t=>x.value=t),filters:h.value,"onUpdate:filters":l[3]||(l[3]=t=>h.value=t),dataKey:"id",loading:y.value,paginator:!0,rows:C.regions.per_page,totalRecords:C.regions.total,lazy:!0,onPage:l[4]||(l[4]=t=>P(t)),onFilter:l[5]||(l[5]=t=>ie(t)),onSort:l[6]||(l[6]=t=>P(t)),first:m.value.first,"onUpdate:first":l[7]||(l[7]=t=>m.value.first=t),sortField:m.value.sortField,sortOrder:m.value.sortOrder,filterDisplay:"menu",globalFilterFields:["designation","type_centrale","code","status"],class:"p-datatable-custom",removableSort:""},{header:d(()=>[s("div",Ae,[o(e(j),{iconPosition:"left"},{default:d(()=>[o(e(q),{class:"pi pi-search text-slate-400"}),o(e(U),{modelValue:h.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>h.value.global.value=t),placeholder:e(a)("regions.toolbar.searchPlaceholder"),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),s("div",Le,[o(e(g),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:l[1]||(l[1]=t=>N.value.exportCSV())}),o(e(g),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:X}),x.value&&x.value.length>0?(c(),V(e(g),{key:0,label:e(a)("common.deleteSelection",{count:x.value.length}),icon:"pi pi-trash",severity:"danger",onClick:te},null,8,["label"])):v("",!0)])])]),default:d(()=>[o(e(k),{selectionMode:"multiple",headerStyle:"width: 3rem"}),o(e(k),{field:"designation",header:"Désignation",sortable:"",filterField:"designation"},fe({filter:d(({filterModel:t})=>[o(e(U),{modelValue:t.value,"onUpdate:modelValue":u=>t.value=u,type:"text",class:"p-column-filter",placeholder:"Chercher par nom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},[w.value.includes("designation")?{name:"body",fn:d(({data:t})=>[s("div",ze,[o(e(Ve),{label:t.designation[0],shape:"circle",class:"bg-primary-50 text-primary-600 font-bold"},null,8,["label"]),s("span",Be,r(t.designation),1)])]),key:"0"}:void 0]),1024),w.value.includes("type_centrale")?(c(),V(e(k),{key:0,field:"type_centrale",header:"Source / Region",sortable:"",showFilterMatchModes:!1},{body:d(({data:t})=>[o(e(H),{value:t.type_centrale,severity:ae(t.type_centrale),class:"rounded-lg px-3 uppercase text-[10px]"},null,8,["value","severity"])]),filter:d(({filterModel:t})=>[o(e(Q),{modelValue:t.value,"onUpdate:modelValue":u=>t.value=u,options:I.value,optionLabel:"label",optionValue:"value",placeholder:"Tous les types",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1})):v("",!0),w.value.includes("puissance_centrale")?(c(),V(e(k),{key:1,field:"puissance_centrale",header:"Capacité",sortable:"",class:"w-40"},{body:d(({data:t})=>[t.type_centrale!=="reseau Electrique"?(c(),b("div",He,[s("div",Qe,[s("span",Ke,[L(r(t.puissance_centrale)+" ",1),Xe]),s("span",Ze,r((t.puissance_centrale/1e3*100).toFixed(0))+"%",1)]),o(e(ke),{value:t.puissance_centrale/1e3*100,showValue:!1,style:{height:"7px"},class:"rounded-full overflow-hidden"},null,8,["value"])])):(c(),b("div",Ge,Ye))]),filter:d(({filterModel:t})=>[s("div",et,[o(e(Se),{modelValue:t.value,"onUpdate:modelValue":u=>t.value=u,range:"",min:0,max:1e3,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),s("div",tt,[s("span",null,r(t.value[0])+"MW",1),s("span",null,r(t.value[1])+"MW",1)])])]),_:1})):v("",!0),w.value.includes("description")?(c(),V(e(k),{key:2,field:"description",header:"Description"},{body:d(({data:t})=>[s("span",st,r(t.description||"N/A"),1)]),_:1})):v("",!0),w.value.includes("status")?(c(),V(e(k),{key:3,field:"status",header:"Statut"},{body:d(({data:t})=>[o(e(H),{value:t.status,severity:t.status==="active"?"success":"danger",class:"rounded-lg px-3 uppercase text-[10px]"},null,8,["value","severity"])]),_:1})):v("",!0),o(e(k),{header:e(a)("common.actions"),alignFrozen:"right",frozen:"",class:"min-w-[120px]"},{body:d(({data:t})=>[s("div",lt,[o(e(g),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:u=>J(t)},null,8,["onClick"]),o(e(g),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:u=>ee(t)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","selection","filters","loading","rows","totalRecords","first","sortField","sortOrder"])]),o(e(Ce),{ref_key:"op",ref:W,appendTo:"body",id:"column_op",class:"p-4"},{default:d(()=>[s("div",ot,r(e(a)("common.columnSelector.title")),1),o(e(Q),{modelValue:w.value,"onUpdate:modelValue":l[8]||(l[8]=t=>w.value=t),options:O.value,optionLabel:"header",optionValue:"field",display:"chip",placeholder:e(a)("common.columnSelector.placeholder"),class:"w-full max-w-xs"},null,8,["modelValue","options","placeholder"])]),_:1},512)]),o(e(be),{visible:_.value,"onUpdate:visible":l[17]||(l[17]=t=>_.value=t),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"600px"},contentStyle:{maxHeight:"80vh",overflow:"auto"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:d(()=>[s("div",Et,[o(e(g),{label:e(a)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:l[16]||(l[16]=t=>_.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),o(e(g),{label:S.value?e(a)("common.update"):e(a)("common.save"),icon:"pi pi-check-circle",severity:"indigo",class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",onClick:Y,loading:y.value},null,8,["label","loading"])])]),default:d(()=>[s("div",at,[s("div",it,[nt,s("div",null,[s("h4",rt,r(e(a)("regions.dialog.regionSettings")),1),s("p",dt,r(e(a)("regions.dialog.productionInfo")),1)])]),o(e(g),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:l[9]||(l[9]=t=>_.value=!1),class:"text-white hover:bg-white/10"})]),s("div",ct,[s("div",ut,[s("div",pt,[s("div",mt,[s("div",ft,[s("label",gt,r(e(a)("regions.fields.designation")),1),o(e(j),{iconPosition:"left"},{default:d(()=>[o(e(q),{class:"pi pi-map-marker"}),o(e(U),{modelValue:e(n).designation,"onUpdate:modelValue":l[10]||(l[10]=t=>e(n).designation=t),class:"w-full py-3.5 rounded-xl border-slate-200 focus:ring-4 focus:ring-primary-50",placeholder:e(a)("regions.placeholders.designation")},null,8,["modelValue","placeholder"])]),_:1}),e(n).errors.designation?(c(),b("small",vt,r(e(n).errors.designation),1)):v("",!0)]),s("div",xt,[s("label",ht,r(e(a)("regions.fields.status")),1),o(e(B),{modelValue:e(n).status,"onUpdate:modelValue":l[11]||(l[11]=t=>e(n).status=t),options:le.value,optionLabel:"label",optionValue:"value",class:"rounded-xl border-slate-200 py-1"},null,8,["modelValue","options"]),e(n).errors.status?(c(),b("small",bt,r(e(n).errors.status),1)):v("",!0)]),s("div",_t,[s("label",yt,r(e(a)("regions.fields.type")),1),o(e(B),{modelValue:e(n).type_centrale,"onUpdate:modelValue":l[12]||(l[12]=t=>e(n).type_centrale=t),options:I.value,optionLabel:"label",optionValue:"value",class:"rounded-xl border-slate-200 py-1"},{option:d(t=>[s("div",wt,[s("i",{class:z(t.option.icon)},null,2),s("span",null,r(t.option.label),1)])]),_:1},8,["modelValue","options"])]),e(n).type_centrale!=="reseau Electrique"?(c(),b("div",kt,[s("label",Vt,r(e(a)("regions.fields.power")),1),o(e(_e),{modelValue:e(n).puissance_centrale,"onUpdate:modelValue":l[13]||(l[13]=t=>e(n).puissance_centrale=t),showButtons:"",min:0,inputId:"minmaxfraction",minFractionDigits:2,maxFractionDigits:5,suffix:" MW",class:"w-full",inputClass:"py-3.5 rounded-xl border-slate-200"},null,8,["modelValue"])])):v("",!0),s("div",St,[s("label",Ct,r(e(a)("regions.fields.code")),1),o(e(j),{iconPosition:"left"},{default:d(()=>[o(e(q),{class:"pi pi-qrcode"}),o(e(U),{modelValue:e(n).code,"onUpdate:modelValue":l[14]||(l[14]=t=>e(n).code=t),class:"w-full py-3.5 rounded-xl border-slate-200 focus:ring-4 focus:ring-primary-50",placeholder:e(a)("regions.placeholders.code")},null,8,["modelValue","placeholder"])]),_:1}),e(n).errors.code?(c(),b("small",Ft,r(e(n).errors.code),1)):v("",!0)]),s("div",$t,[s("label",Mt,r(e(a)("regions.fields.notes")),1),ge(s("textarea",{"onUpdate:modelValue":l[15]||(l[15]=t=>e(n).description=t),rows:"3",class:"w-full p-4 rounded-2xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-primary-50 transition-all text-sm outline-none",placeholder:e(a)("regions.placeholders.notes")},null,8,Ut),[[ve,e(n).description]])])])])])])]),_:1},8,["visible"]),o(e(ye),{position:"bottom-right"}),o(e(we))]),_:1}))}};export{os as default};
