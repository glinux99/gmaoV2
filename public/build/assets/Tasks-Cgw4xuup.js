import{T as at}from"./index-BbFIc-qF.js";import{s as ot}from"./index-CycCUolZ.js";import{s as rt}from"./index-DBlwtJFe.js";import{s as it}from"./index-RIg7_KOk.js";import{s as nt}from"./index-B0W91G3B.js";import{s as dt}from"./index-CagH4E-9.js";import{s as ct}from"./index-ClmdxtMW.js";import{s as ut,a as pt}from"./index-6CLnIpjK.js";import{s as mt}from"./index-BeaEkU56.js";import{s as _t}from"./index-BeqJB9dn.js";import{s as ft}from"./index-CEA3Snwx.js";import{s as vt,a as bt}from"./index-BvqM3u8T.js";import{s as ht}from"./index-BN5aQcOg.js";import{s as xt}from"./index-BLI3-ZB5.js";import{s as yt}from"./index-DZHXsoj_.js";import{s as gt}from"./index-Ci1herNU.js";import{r as m,a as kt,b as wt,F as C,c as ee,T as ge,d as w,w as te,e as A,f as y,o as p,i as n,g as r,Z as Vt,j as e,t as h,p as T,q as Y,l as f,m as N,n as P,U as Tt,s as F,k as U,h as Z,x as qt,y as Ct}from"./app-BRAmWWDK.js";import{s as St}from"./index-ZzNQsZaI.js";import{s as At}from"./index-BQJ1L68S.js";import{s as re}from"./index-CsEuBKcf.js";import{s as Ut}from"./index-CNGgL0Kp.js";import{_ as Et}from"./AppLayout-DcYAlXcr.js";import{_ as Dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CDA2CSiu.js";import"./index-CcU6oDqo.js";import"./index-LMQAJ2bo.js";import"./index-D3aGqElX.js";import"./DropdownLink-BJ7aGovM.js";const c=R=>(qt("data-v-13ae3493"),R=R(),Ct(),R),jt={class:"quantum-v11-container p-4 lg:p-8 bg-[#f8fafc] min-h-screen"},Mt={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},Ot=c(()=>e("div",{class:"flex items-center gap-4"},[e("div",{class:"flex h-16 w-16 items-center justify-center rounded-[1rem] bg-primary-600 shadow-xl shadow-primary-200"},[e("i",{class:"pi pi-briefcase text-2xl text-white"})]),e("div",null,[e("h1",{class:"text-2xl font-black tracking-tighter text-slate-900 uppercase"},[U(" Ordres de Travail "),e("span",{class:"text-primary-600"},"GMAO")]),e("p",{class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},"Planification & Suivi des Tâches")])],-1)),$t={class:"flex gap-2"},It={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"},Nt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Pt=c(()=>e("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[e("i",{class:"pi pi-briefcase text-2xl text-slate-500"})],-1)),Ft={class:"text-2xl font-black text-slate-800"},Lt=c(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Tâches Totales",-1)),Rt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Bt=c(()=>e("div",{class:"w-14 h-14 rounded-xl bg-amber-50 flex items-center justify-center"},[e("i",{class:"pi pi-spin pi-spinner text-2xl text-amber-500"})],-1)),zt={class:"text-2xl font-black text-slate-800"},Wt=c(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"En Cours",-1)),Ht={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Qt=c(()=>e("div",{class:"w-14 h-14 rounded-xl bg-green-50 flex items-center justify-center"},[e("i",{class:"pi pi-check-circle text-2xl text-green-500"})],-1)),Gt={class:"text-2xl font-black text-slate-800"},Jt=c(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Terminées",-1)),Kt={class:"card-v11 overflow-hidden border border-slate-200 rounded-2xl bg-white shadow-sm"},Yt={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},Zt={class:"flex items-center gap-2"},Xt=["onClick"],es={key:0,class:"flex flex-wrap gap-1"},ts={key:0,class:"flex w-fit items-center gap-3 rounded-full bg-slate-50 p-1 pr-4 border border-slate-100"},ss={class:"text-sm font-bold text-slate-700"},ls={key:1,class:"text-slate-400 text-xs italic"},as={class:"flex items-center gap-2"},os={class:"text-xs font-medium"},rs={class:"font-mono text-sm bg-blue-50 text-blue-600 px-2 py-1 rounded-md"},is={class:"flex justify-end gap-2"},ns={class:"p-2 space-y-3"},ds=c(()=>e("span",{class:"text-[10px] font-black uppercase text-slate-400 block border-b pb-2"},"Colonnes actives",-1)),cs={class:"flex flex-col h-[90vh]"},us={class:"px-8 py-4 bg-slate-900 text-white flex justify-between items-center shrink-0"},ps={class:"flex items-center gap-4"},ms=c(()=>e("div",{class:"p-2 bg-blue-500/20 rounded-lg border border-blue-500/30"},[e("i",{class:"pi pi-shield text-blue-400 text-xl"})],-1)),_s={class:"flex flex-col"},fs={class:"text-sm font-black uppercase tracking-widest text-white leading-none"},vs=c(()=>e("span",{class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1 italic"},"Console d'administration GMAO v2025",-1)),bs={class:"flex items-center gap-6"},hs={class:"flex flex-col items-end mr-4"},xs=c(()=>e("span",{class:"text-[9px] font-bold text-slate-400 uppercase mb-1"},"Niveau d'urgence",-1)),ys={class:"flex-grow p-8 grid grid-cols-12 gap-8 overflow-y-auto bg-slate-50"},gs={class:"col-span-12 md:col-span-4 space-y-6"},ks={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm space-y-5"},ws=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-primary-600 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-tag"}),U(" Contexte Mission ")],-1)),Vs={class:"field"},Ts=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Objet de l'intervention",-1)),qs={class:"field"},Cs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Nature des travaux",-1)),Ss={class:"field"},As=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Actifs Concernés (Équipements)",-1)),Us={class:"field"},Es=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Région Administrative",-1)),Ds={class:"field"},js=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Département Bénéficiaire",-1)),Ms={class:"col-span-12 md:col-span-4 space-y-6"},Os={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm space-y-5"},$s=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-purple-600 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-calendar-clock"}),U(" Planification ")],-1)),Is={class:"field"},Ns=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Début Planifié",-1)),Ps={class:"field"},Fs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Échéance de fin",-1)),Ls={class:"field"},Rs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Récurrence",-1)),Bs={key:0,class:"field"},zs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Intervalle",-1)),Ws={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm space-y-4"},Hs=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-slate-600 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-align-left"}),U(" Description ")],-1)),Qs={class:"col-span-12 md:col-span-4 space-y-6"},Gs={class:"p-6 bg-slate-800 text-white rounded-2xl border border-slate-700 shadow-lg space-y-5"},Js=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-blue-400 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-users"}),U(" Logistique & Assignation ")],-1)),Ks={class:"field"},Ys=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Responsable",-1)),Zs={class:"flex gap-2"},Xs={class:"field"},el=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Statut Opérationnel",-1)),tl={class:"field"},sl=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Budget Estimé",-1)),ll={class:"field"},al=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Temps d'exécution (min)",-1)),ol={class:"pt-4 border-t border-slate-700"},rl={class:"flex items-center gap-3"},il=c(()=>e("span",{class:"text-xs font-black uppercase tracking-tight"},"Consignation (LOTO)",-1)),nl={class:"col-span-12 mt-6"},dl={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"},cl=c(()=>e("div",{class:"px-5 py-3 bg-slate-50/80 border-b border-slate-200 flex items-center justify-between"},[e("h3",{class:"text-xs font-bold uppercase tracking-wider text-slate-600 flex items-center gap-2"},[e("i",{class:"pi pi-wrench text-emerald-500"}),U(" Protocole & Pièces Détachées ")])],-1)),ul={class:"p-5 grid grid-cols-1 lg:grid-cols-2 gap-10"},pl={class:"flex flex-col"},ml={class:"flex justify-between items-center mb-4"},_l={class:"text-sm font-semibold text-slate-800 flex items-center gap-2"},fl={class:"px-2 py-0.5 bg-slate-100 text-slate-500 rounded-full text-[10px]"},vl={key:0,class:"flex-grow flex flex-col items-center justify-center py-10 border-2 border-dashed border-slate-100 rounded-xl bg-slate-50/30"},bl=c(()=>e("i",{class:"pi pi-box text-slate-300 text-3xl mb-2"},null,-1)),hl=c(()=>e("p",{class:"text-xs text-slate-400"},"Aucune pièce requise pour cette intervention",-1)),xl=[bl,hl],yl={key:1,class:"space-y-2 overflow-y-auto max-h-[400px] pr-2"},gl={class:"flex-grow grid grid-cols-12 gap-2"},kl={class:"col-span-8"},wl={key:0,class:"text-xs font-medium truncate"},Vl={key:1,class:"text-xs text-slate-400"},Tl={class:"flex flex-col min-w-0"},ql={class:"text-xs font-bold truncate"},Cl={class:"text-[10px] text-slate-500"},Sl={class:"col-span-4"},Al={class:"p-inputgroup"},Ul=c(()=>e("span",{class:"p-inputgroup-addon bg-slate-50 text-[10px]"},"Qté",-1)),El={class:"mt-4 pt-4 border-t border-slate-100 flex items-center justify-between"},Dl={class:"text-right"},jl=c(()=>e("span",{class:"text-[10px] uppercase font-bold text-slate-400 block tracking-wider"},"Coût Total Estimé",-1)),Ml={class:"text-xl font-black text-emerald-600"},Ol={class:"flex flex-col border-l border-slate-100 pl-4 lg:pl-10"},$l={class:"flex justify-between items-center mb-4"},Il=c(()=>e("h4",{class:"text-sm font-semibold text-slate-800"},"Protocole d'intervention",-1)),Nl={class:"flex items-center gap-3 bg-slate-100 px-3 py-1.5 rounded-full"},Pl=c(()=>e("label",{for:"advanced-instr",class:"text-[10px] font-bold text-slate-600 uppercase"},"Mode Avancé",-1)),Fl={class:"flex-grow"},Ll={key:0,class:"h-full flex flex-col items-center justify-center py-10 bg-slate-50/50 rounded-xl border-2 border-dashed border-slate-100"},Rl=c(()=>e("p",{class:"text-xs text-slate-400 text-center max-w-[200px]"},"Activez le mode avancé pour définir les étapes techniques.",-1)),Bl=[Rl],zl={key:1,class:"space-y-4 max-h-[450px] overflow-y-auto pr-2"},Wl=["onClick"],Hl={class:"text-xs font-bold text-slate-700 uppercase"},Ql={key:0,class:"p-3 bg-slate-50/50 space-y-3 border-t border-slate-100"},Gl={class:"flex justify-between items-center mb-3"},Jl={class:"text-xs font-extrabold text-emerald-700"},Kl={class:"flex gap-1"},Yl={class:"space-y-2"},Zl={class:"flex-grow space-y-2"},Xl={class:"flex gap-2"},ea={class:"flex items-center gap-2 px-2 bg-white border border-slate-200 rounded text-[10px] w-[80px]"},ta=c(()=>e("span",null,"Requis",-1)),sa={class:"shrink-0 flex justify-between items-center w-full px-8 py-4 bg-white/50 backdrop-blur-md border-t border-slate-200"},la={key:0},aa={class:"mb-4"},oa={class:"max-h-64 overflow-y-auto space-y-3 p-3 bg-slate-100 rounded-lg"},ra={key:0,class:"text-center text-sm text-slate-500 py-4"},ia={class:"font-bold text-sm mb-2"},na={class:"pl-4 space-y-2"},da=["for"],ca={class:"p-fluid"},ua={class:"field"},pa=c(()=>e("label",{for:"spare_part_name",class:"font-semibold"},"Nom",-1)),ma={class:"p-error"},_a={class:"field"},fa=c(()=>e("label",{for:"spare_part_reference",class:"font-semibold"},"Référence",-1)),va={class:"p-error"},ba={class:"field"},ha=c(()=>e("label",{for:"spare_part_category",class:"font-semibold"},"Catégorie",-1)),xa={class:"p-error"},ya={class:"field"},ga=c(()=>e("label",{for:"spare_part_stock_quantity",class:"font-semibold"},"Quantité en stock",-1)),ka={class:"p-error"},wa={class:"field"},Va=c(()=>e("label",{for:"spare_part_unit_estimated_cost",class:"font-semibold"},"Coût unitaire",-1)),Ta={class:"p-error"},qa={__name:"Tasks",props:{tasks:Object,filters:Object,equipments:Array,users:Array,teams:Object,regions:Array,departments:Array,equipmentTree:Array,spareParts:Array,categories:Array},setup(R){var be;m(1);const g=R,S=kt(),ie=wt(),E=m(!1),ne=m(!1),X=m(!1),ke=m(!1),we=m(((be=g.filters)==null?void 0:be.search)||""),de=m(),D=m([]),ce=m(),ue=m([{field:"title",header:"Titre"},{field:"equipments",header:"Équipement(s)"},{field:"assignable",header:"Assigné à"},{field:"status",header:"Statut"},{field:"priority",header:"Priorité"},{field:"planned_start_date",header:"Début Planifié"}]),j=m(ue.value.map(s=>s.field)),B=m({global:{value:null,matchMode:C.CONTAINS},title:{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},"assignable.name":{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},status:{value:null,matchMode:C.EQUALS},priority:{value:null,matchMode:C.EQUALS}}),Ve=()=>{B.value={global:{value:null,matchMode:C.CONTAINS},title:{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},"assignable.name":{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},status:{value:null,matchMode:C.EQUALS},priority:{value:null,matchMode:C.EQUALS}},we.value=""};m([]);const z=m({}),W=m(!1),H=m(!1),M=m(null),$=m({}),se=m({}),Q=m(!1),x=ge({name:"",reference:"",category_id:null,stock_quantity:0,unit_estimated_cost:0}),l=ge({id:null,title:"",description:"",assignable_type:null,assignable_id:null,maintenance_type:"Préventive",status:"Planifiée",priority:"Moyenne",planned_start_date:null,planned_end_date:null,time_spent:null,estimated_cost:null,region_id:null,recurrence_type:null,recurrence_interval:null,recurrence_month_interval:null,recurrence_days:[],recurrence_day_of_month:null,recurrence_month:null,reminder_days:null,custom_recurrence_config:null,requester_department:null,department:"",requires_shutdown:!0,instructions:{},equipment_ids:[],related_equipments:{},jobber:0,service_order_description:"x",service_order_cost:0,spare_parts:[]}),Te=m(["Préventive","Corrective","Améliorative","Périodique"]),pe=m(["Planifiée","En cours","En attente","Terminée","Annulée","En retard"]),qe=m(["Basse","Moyenne","Haute","Urgente"]),Ce=m([{label:"Aucun",value:null},{label:"Technicien",value:"App\\Models\\User"},{label:"Équipe",value:"App\\Models\\Team"}]),Se=w(()=>l.assignable_type==="App\\Models\\User"?g.users:l.assignable_type==="App\\Models\\Team"?g.teams:[]),Ae=m([{label:"Aucune",value:null},{label:"Quotidienne",value:"daily"},{label:"Hebdomadaire",value:"weekly"},{label:"Mensuelle",value:"monthly"},{label:"Trimestrielle",value:"quarterly"},{label:"Semestrielle",value:"biannual"},{label:"Annuelle",value:"annual"},{label:"Personnalisée",value:"custom"}]);m([{label:"Lundi",value:1},{label:"Mardi",value:2},{label:"Mercredi",value:3},{label:"Jeudi",value:4},{label:"Vendredi",value:5},{label:"Samedi",value:6},{label:"Dimanche",value:0}]);const Ue=m([{label:"Texte",value:"text"},{label:"Nombre",value:"number"},{label:"Date",value:"date"},{label:"Image",value:"image"},{label:"Signature",value:"signature"},{label:"Booléen",value:"boolean"}]);m([{label:"Janvier",value:1},{label:"Février",value:2},{label:"Mars",value:3},{label:"Avril",value:4},{label:"Mai",value:5},{label:"Juin",value:6},{label:"Juillet",value:7},{label:"Août",value:8},{label:"Septembre",value:9},{label:"Octobre",value:10},{label:"Novembre",value:11},{label:"Décembre",value:12}]),te(()=>l.recurrence_type,s=>{l.recurrence_interval=null,l.recurrence_days=[],l.recurrence_day_of_month=null,l.recurrence_month_interval=null,l.recurrence_month=null}),te(()=>l.related_equipments,(s,t)=>{const d=s?Object.keys(s):[];(t?Object.keys(t):[]).forEach(i=>{d.includes(i)||delete l.instructions[i]})}),te(()=>l.related_equipments,s=>{const t={};if(s){const d=Object.keys(s).filter(o=>s[o].checked);I.value.forEach(o=>{d.includes(o.key)&&(t[o.key]=!0)})}z.value=t,s&&Object.keys(s).forEach(d=>{s[d].checked})},{deep:!0});const Ee=()=>{l.reset(),X.value=!1,ne.value=!1,W.value=!1,E.value=!0,z.value={};const s=new Date,t=new Date(s.getFullYear(),s.getMonth(),s.getDate(),7,0),d=new Date(s.getFullYear(),s.getMonth(),s.getDate(),16,0);l.planned_start_date=t,l.planned_end_date=d},me=s=>{l.id=s.id,l.title=s.title,l.description=s.description,l.assignable_type=s.assignable_type,l.assignable_id=s.assignable_id,l.maintenance_type=s.maintenance_type,l.status=s.status,l.priority=s.priority,l.planned_start_date=s.planned_start_date?new Date(s.planned_start_date):null,l.planned_end_date=s.planned_end_date?new Date(s.planned_end_date):null,l.time_spent=s.time_spent,l.estimated_cost=s.estimated_cost,l.region_id=s.region_id,l.recurrence_type=s.recurrence_type,l.recurrence_interval=s.recurrence_interval,l.recurrence_days=s.recurrence_days||[],l.recurrence_day_of_month=s.recurrence_day_of_month,l.recurrence_month_interval=s.recurrence_month_interval,l.recurrence_month=s.recurrence_month,l.reminder_days=s.reminder_days,l.custom_recurrence_config=s.custom_recurrence_config,l.requester_department=s.requester_department,l.department=s.department,l.requires_shutdown=s.requires_shutdown??!0;const t={};s.instructions&&Array.isArray(s.instructions)&&s.instructions.length>0&&s.instructions.forEach(o=>{const i=String(o.equipment_id);t[i]||(t[i]=[]),t[i].push({...o})}),l.instructions=t,l.images=s.images||[];const d={};s.equipments&&s.equipments.forEach(o=>{d[String(o.id)]={checked:!0,partialChecked:!1}}),l.related_equipments=d,s.spare_parts&&Array.isArray(s.spare_parts)?l.spare_parts=s.spare_parts.map(o=>{var i;return{id:o.id,quantity_used:((i=o.pivot)==null?void 0:i.quantity_used)||1}}):l.spare_parts=[],console.log(l.assignable_id),W.value=!1,X.value=!0,E.value=!0},De=()=>{if(ne.value=!0,!l.title||!l.related_equipments||!l.maintenance_type){S.add({severity:"error",summary:"Erreur",detail:"Veuillez remplir les champs obligatoires.",life:3e3});return}const s=l.related_equipments,t=Object.keys(l.instructions).flatMap(o=>l.instructions[o].map(i=>({...i,equipment_id:parseInt(o)}))),d={...l.data(),spare_parts:l.spare_parts.map(o=>({id:o.id,quantity_used:o.quantity_used})),related_equipments:s,equipment_ids:Object.keys(s).filter(o=>s[o].checked).map(o=>parseInt(o)),instructions:t,planned_start_date:l.planned_start_date?new Date(l.planned_start_date).toISOString().slice(0,19).replace("T"," "):null,planned_end_date:l.planned_end_date?new Date(l.planned_end_date).toISOString().slice(0,19).replace("T"," "):null};console.log("data"),console.log(d),l.assignable_type||(d.assignable_id=null),d.instructions=t,X.value?Z.put(route("tasks.update",l.id),d,{onSuccess:()=>{E.value=!1,S.add({severity:"success",summary:"Succès",detail:"Ordre de Travail mise à jour avec succès.",life:3e3}),l.reset()},onError:o=>{console.error("Erreur lors de la mise à jour de la maintenance",o),S.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue.",life:3e3}),l.errors=o}}):(console.log(d),Z.post(route("tasks.store"),d,{onSuccess:()=>{E.value=!1,S.add({severity:"success",summary:"Succès",detail:"Ordre de Travail créée avec succès.",life:3e3}),l.reset()},onError:o=>{console.error("Erreur lors de la sauvegarde de la maintenance",o),S.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue.",life:3e3}),l.errors=o}}))},je=s=>{ie.require({message:`Êtes-vous sûr de vouloir supprimer la tâche "${s.title}" ?`,header:"Confirmation de suppression",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{Z.delete(route("tasks.destroy",s.id),{onSuccess:()=>{S.add({severity:"success",summary:"Succès",detail:"Ordre de Travail supprimée.",life:3e3})}})}})},Me=()=>{ie.require({message:`Êtes-vous sûr de vouloir supprimer les ${D.value.length} tâches sélectionnées ?`,header:"Confirmation de suppression",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{Z.post(route("tasks.bulkDestroy"),{ids:D.value.map(s=>s.id)},{onSuccess:()=>{S.add({severity:"success",summary:"Succès",detail:"Tâches supprimées avec succès.",life:3e3}),D.value=[]}})}})},Oe=()=>{de.value.exportCSV()},$e=s=>({Planifiée:"info","En cours":"warning",Terminée:"success",Annulée:"secondary","En retard":"danger","En attente":"contrast"})[s]||null,le=s=>({Basse:"info",Moyenne:"success",Haute:"warning",Urgente:"danger"})[s]||null,Ie=w(()=>X.value?"Modifier la Ordre de Travail":"Créer une nouvelle Ordre de Travail"),Ne=w(()=>!D.value||D.value.length<2),ae=w(()=>{const s=g.tasks.data.length,t=g.tasks.data.filter(o=>o.status==="En cours").length,d=g.tasks.data.filter(o=>o.status==="Terminée").length;return{total:s,inProgress:t,completed:d}}),I=w(()=>{if(!l.related_equipments||Object.keys(l.related_equipments).length===0)return[];const s=Object.keys(l.related_equipments).filter(o=>l.related_equipments[o]),t=new Map,d=(o,i)=>{if(o.key===i)return o.children&&o.children.length>0?o.children.forEach(u=>{t.has(u.key)||t.set(u.key,u)}):t.has(o.key)||t.set(o.key,o),o;if(o.children)for(const u of o.children){const v=d(u,i);if(v)return v}return null};return s.forEach(o=>{G.value.forEach(i=>d(i,o))}),Array.from(t.values())}),Pe=w(()=>{if(!I.value.length)return[];const s=new Map,t=(d,o)=>{for(const i of d){if(i.children&&i.children.some(u=>u.key===o))return i;if(i.children){const u=t(i.children,o);if(u)return u}}return null};return I.value.forEach(d=>{const o=t(G.value,d.key),i=o?o.key:"root",u=o?o.label:"Équipements de premier niveau";s.has(i)||s.set(i,{parent:{key:i,label:u},children:[]}),s.get(i).children.push(d)}),Array.from(s.values())}),Fe=s=>{se.value[s]=!(se.value[s]??!0)},_e=s=>se.value[s]??!0,Le=s=>{l.instructions[s]||(l.instructions[s]=[]),l.instructions[s].push({label:"",type:"text",is_required:!1})},Re=(s,t)=>{l.instructions[s]&&l.instructions[s][t]&&l.instructions[s].splice(t,1)},Be=s=>{M.value=s,$.value={},H.value=!0},fe=w(()=>M.value?I.value.find(s=>s.key===M.value):null),ze=w(()=>{const s=M.value;if(!s)return[];const t=new Set(I.value.filter(o=>o.key!==s&&z.value[o.key]).map(o=>o.key)),d=o=>o.map(i=>{const u=i.children?d(i.children):[];return t.has(i.key)||u.length>0?{...i,children:u.length>0?u:void 0}:null}).filter(Boolean);return d(G.value)}),We=w(()=>{const s=M.value;if(!s)return[];const t=I.value.filter(i=>i.key!==s&&z.value[i.key]),d=new Map,o=(i,u)=>{for(const v of i){if(v.children&&v.children.some(k=>k.key===u))return v;if(v.children){const k=o(v.children,u);if(k)return k}}return null};return t.forEach(i=>{const u=o(G.value,i.key);u&&(d.has(u.key)||d.set(u.key,{parent:u,children:[]}),d.get(u.key).children.push(i))}),Array.from(d.values())}),He=w(()=>M.value?I.value.filter(s=>s.key!==M.value&&z.value[s.key]):[]),Qe=()=>{const s=l.instructions[M.value];if(!s)return;const t=new Set,d=Object.keys($.value).filter(u=>$.value[u].checked),o=(u,v)=>{for(const k of u){if(k.key===v)return k;if(k.children){const V=o(k.children,v);if(V)return V}}return null},i=u=>{let v=[];return!u.children||u.children.length===0?v.push(u.key):u.children.forEach(k=>{v.push(...i(k))}),v};d.forEach(u=>{const v=o(ze.value,u);v&&i(v).forEach(V=>t.add(V))}),t.forEach(u=>{u&&(l.instructions[u]=JSON.parse(JSON.stringify(s)))}),H.value=!1},Ge=w(()=>Object.keys($.value).filter(s=>$.value[s]).length),G=w(()=>{if(!g.equipmentTree||typeof g.equipmentTree!="object")return[];const s=t=>t?{key:String(t.id),label:t.label,icon:"pi pi-fw pi-cog",children:t.children?t.children.map(s).filter(d=>d):[]}:null;return Object.values(g.equipmentTree).map(s).filter(t=>t)}),Je=w(()=>{if(!g.departments||!Array.isArray(g.departments))return[];const s=t=>t?{key:t.label,label:t.label,children:t.children?t.children.map(s).filter(d=>d):[]}:null;return g.departments.map(s).filter(t=>t)}),Ke=()=>{l.spare_parts.push({id:null,quantity_used:1})},Ye=s=>{l.spare_parts.splice(s,1)},Ze=()=>{x.reset(),Q.value=!0},Xe=()=>{x.post(route("spare-parts.store"),{onSuccess:()=>{Q.value=!1,S.add({severity:"success",summary:"Succès",detail:"Pièce détachée créée avec succès.",life:3e3}),Z.reload({only:["spareParts"]})},onError:s=>{S.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue lors de la création de la pièce détachée.",life:3e3})}})},ve=w(()=>l.spare_parts.reduce((s,t)=>{if(!t.id)return s;const d=g.spareParts.find(i=>i.id===t.id),o=(d==null?void 0:d.unit_estimated_cost)||0;return s+o*(t.quantity_used||0)},0));return te(ve,s=>{l.service_order_cost=s,s>0&&!l.service_order_description&&(l.service_order_description="Paiement des pièces détachées et autres")}),(s,t)=>{const d=gt,o=yt,i=xt,u=vt,v=ht,k=bt,V=ut,he=ft,et=_t,q=mt,tt=pt,st=ct,xe=dt,ye=nt,L=it,oe=rt,lt=ot,J=at;return p(),A(Et,{title:"Gestion des Ordre de Travails"},{default:y(()=>[n(r(Vt),{title:"Ordres de Travail"}),n(d),n(o),e("div",jt,[e("div",Mt,[Ot,e("div",$t,[n(i,{label:"Nouvel Ordre de Travail",icon:"pi pi-plus",loading:ke.value,class:"shadow-lg shadow-primary-200",onClick:Ee},null,8,["loading"])])]),e("div",It,[e("div",Nt,[Pt,e("div",null,[e("div",Ft,h(ae.value.total),1),Lt])]),e("div",Rt,[Bt,e("div",null,[e("div",zt,h(ae.value.inProgress),1),Wt])]),e("div",Ht,[Qt,e("div",null,[e("div",Gt,h(ae.value.completed),1),Jt])])]),e("div",Kt,[n(tt,{value:g.tasks.data,ref_key:"dt",ref:de,dataKey:"id",selection:D.value,"onUpdate:selection":t[2]||(t[2]=a=>D.value=a),paginator:!0,rows:10,filters:B.value,"onUpdate:filters":t[3]||(t[3]=a=>B.value=a),filterDisplay:"menu",globalFilterFields:["title","assignable.name","status","priority"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:"{first} à {last} sur {totalRecords}",class:"p-datatable-sm quantum-table"},{header:y(()=>[e("div",Yt,[n(k,{iconPosition:"left"},{default:y(()=>[n(u,{class:"pi pi-search text-slate-400"}),n(v,{modelValue:B.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=a=>B.value.global.value=a),placeholder:"Rechercher une tâche...",class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue"])]),_:1}),e("div",Zt,[Ne.value?T("",!0):(p(),A(i,{key:0,label:`Supprimer (${D.value.length})`,icon:"pi pi-trash",severity:"danger",onClick:Me},null,8,["label"])),Y(n(i,{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:Ve,class:"rounded-xl"},null,512),[[J,"Réinitialiser les filtres",void 0,{bottom:!0}]]),Y(n(i,{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:Oe},null,512),[[J,"Exporter",void 0,{bottom:!0}]]),Y(n(i,{icon:"pi pi-columns",text:"",rounded:"",severity:"secondary",onClick:t[1]||(t[1]=a=>ce.value.toggle(a))},null,512),[[J,"Colonnes",void 0,{bottom:!0}]])])])]),default:y(()=>[n(V,{selectionMode:"multiple",headerStyle:"width: 3rem"}),j.value.includes("title")?(p(),A(V,{key:0,header:"Titre de la tâche",minWidth:"300px"},{body:y(({data:a})=>[e("div",{class:"font-bold text-slate-800 tracking-tight cursor-pointer",onClick:_=>me(a)},h(a.title),9,Xt)]),_:1})):T("",!0),j.value.includes("equipments")?(p(),A(V,{key:1,header:"Équipement(s)",minWidth:"250px"},{body:y(a=>{var _;return[(_=a.data.equipments)!=null&&_.length?(p(),f("div",es,[(p(!0),f(N,null,P(a.data.equipments,b=>(p(),A(he,{key:b.id,value:b.designation,class:"!bg-slate-200 !text-slate-700 !font-bold"},null,8,["value"]))),128))])):T("",!0)]}),_:1})):T("",!0),j.value.includes("assignable")?(p(),A(V,{key:2,field:"assignable.name",header:"Assigné à",minWidth:"200px"},{body:y(a=>[a.data.assignable?(p(),f("div",ts,[n(et,{label:a.data.assignable.name[0],shape:"circle",class:"!bg-slate-900 !text-white !font-black"},null,8,["label"]),e("span",ss,h(a.data.assignable.name),1)])):(p(),f("span",ls,"Non assigné"))]),filter:y(({filterModel:a})=>[n(v,{modelValue:a.constraints[0].value,"onUpdate:modelValue":_=>a.constraints[0].value=_,type:"text",class:"p-column-filter",placeholder:"Filtrer par assigné"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})):T("",!0),j.value.includes("status")?(p(),A(V,{key:3,field:"status",header:"Statut",minWidth:"150px"},{body:y(a=>[n(he,{value:a.data.status,severity:$e(a.data.status),class:"uppercase text-[9px] px-2"},null,8,["value","severity"])]),filter:y(({filterModel:a})=>[n(q,{modelValue:a.value,"onUpdate:modelValue":_=>a.value=_,options:pe.value,placeholder:"Filtrer par statut",class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1})):T("",!0),j.value.includes("priority")?(p(),A(V,{key:4,field:"priority",header:"Priorité",minWidth:"150px"},{body:y(({data:a})=>[e("div",as,[e("div",{class:"w-2 h-2 rounded-full",style:Tt({backgroundColor:le(a.priority)==="danger"?"#ef4444":le(a.priority)==="warning"?"#f59e0b":le(a.priority)==="success"?"#10b981":"#64748b"})},null,4),e("span",os,h(a.priority),1)])]),_:1})):T("",!0),j.value.includes("planned_start_date")?(p(),A(V,{key:5,field:"planned_start_date",header:"Début Planifié",minWidth:"200px"},{body:y(a=>[e("span",rs,h(new Date(a.data.planned_start_date).toLocaleString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),_:1})):T("",!0),n(V,{header:"Actions",alignFrozen:"right",frozen:"",class:"pr-8"},{body:y(({data:a})=>[e("div",is,[Y(n(i,{icon:"pi pi-pencil",text:"",rounded:"",onClick:_=>me(a),class:"!text-slate-400 hover:!bg-primary-50 hover:!text-primary-600 transition-all"},null,8,["onClick"]),[[J,"Modifier",void 0,{top:!0}]]),Y(n(i,{icon:"pi pi-trash",text:"",rounded:"",onClick:_=>je(a),class:"!text-slate-400 hover:!bg-red-50 hover:!text-red-500 transition-all"},null,8,["onClick"]),[[J,"Supprimer",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","selection","filters"])])]),n(r(St),{ref_key:"op",ref:ce,class:"quantum-overlay"},{default:y(()=>[e("div",ns,[ds,n(r(At),{modelValue:j.value,"onUpdate:modelValue":t[4]||(t[4]=a=>j.value=a),options:ue.value,optionLabel:"header",optionValue:"field",display:"chip",class:"w-64 quantum-multiselect"},null,8,["modelValue","options"])])]),_:1},512),n(r(re),{visible:E.value,"onUpdate:visible":t[26]||(t[26]=a=>E.value=a),modal:"",header:!1,closable:!1,class:"quantum-dialog w-full max-w-7xl overflow-hidden",pt:{root:{class:"border-none shadow-3xl bg-white rounded-xl"},mask:{style:"backdrop-filter: blur(15px); background: rgba(15, 23, 42, 0.8)"}}},{default:y(()=>[e("div",cs,[e("div",us,[e("div",ps,[ms,e("div",_s,[e("h2",fs,h(Ie.value),1),vs])]),e("div",bs,[e("div",hs,[xs,n(st,{modelValue:r(l).priority,"onUpdate:modelValue":t[5]||(t[5]=a=>r(l).priority=a),options:qe.value,class:"p-selectbutton-sm custom-dark-priority"},null,8,["modelValue","options"])]),n(i,{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:t[6]||(t[6]=a=>E.value=!1),class:"text-white hover:bg-white/10"})])]),e("div",ys,[e("div",gs,[e("div",ks,[ws,e("div",Vs,[Ts,n(v,{modelValue:r(l).title,"onUpdate:modelValue":t[7]||(t[7]=a=>r(l).title=a),class:"w-full",placeholder:"Ex: Remplacement des filtres..."},null,8,["modelValue"])]),e("div",qs,[Cs,n(q,{modelValue:r(l).maintenance_type,"onUpdate:modelValue":t[8]||(t[8]=a=>r(l).maintenance_type=a),options:Te.value,class:"w-full"},null,8,["modelValue","options"])]),e("div",Ss,[As,n(xe,{modelValue:r(l).related_equipments,"onUpdate:modelValue":t[9]||(t[9]=a=>r(l).related_equipments=a),options:G.value,selectionMode:"checkbox",display:"chip",placeholder:"Choisir les équipements",class:"w-full"},null,8,["modelValue","options"])]),e("div",Us,[Es,n(q,{modelValue:r(l).region_id,"onUpdate:modelValue":t[10]||(t[10]=a=>r(l).region_id=a),options:g.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full"},null,8,["modelValue","options"])]),e("div",Ds,[js,n(xe,{modelValue:r(l).department,"onUpdate:modelValue":t[11]||(t[11]=a=>r(l).department=a),options:Je.value,placeholder:"Service",class:"w-full"},{header:y(a=>[]),_:1},8,["modelValue","options"])])])]),e("div",Ms,[e("div",Os,[$s,e("div",Is,[Ns,n(ye,{modelValue:r(l).planned_start_date,"onUpdate:modelValue":t[12]||(t[12]=a=>r(l).planned_start_date=a),showTime:"",hourFormat:"24",class:"w-full"},null,8,["modelValue"])]),e("div",Ps,[Fs,n(ye,{modelValue:r(l).planned_end_date,"onUpdate:modelValue":t[13]||(t[13]=a=>r(l).planned_end_date=a),showTime:"",hourFormat:"24",class:"w-full"},null,8,["modelValue"])]),e("div",Ls,[Rs,n(q,{modelValue:r(l).recurrence_type,"onUpdate:modelValue":t[14]||(t[14]=a=>r(l).recurrence_type=a),options:Ae.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),r(l).recurrence_type?(p(),f("div",Bs,[zs,n(L,{modelValue:r(l).recurrence_interval,"onUpdate:modelValue":t[15]||(t[15]=a=>r(l).recurrence_interval=a),class:"w-full",suffix:" cycles"},null,8,["modelValue"])])):T("",!0)]),e("div",Ws,[Hs,n(r(Ut),{modelValue:r(l).description,"onUpdate:modelValue":t[16]||(t[16]=a=>r(l).description=a),rows:"5",class:"w-full text-sm",placeholder:"Notes additionnelles pour l'équipe terrain..."},null,8,["modelValue"])])]),e("div",Qs,[e("div",Gs,[Js,e("div",Ks,[Ys,e("div",Zs,[n(q,{modelValue:r(l).assignable_type,"onUpdate:modelValue":t[17]||(t[17]=a=>r(l).assignable_type=a),options:Ce.value,optionLabel:"label",optionValue:"value",class:"w-1/2"},null,8,["modelValue","options"]),n(q,{modelValue:r(l).assignable_id,"onUpdate:modelValue":t[18]||(t[18]=a=>r(l).assignable_id=a),options:Se.value,optionLabel:"name",optionValue:"id",filter:"",class:"w-1/2"},null,8,["modelValue","options"])])]),e("div",Xs,[el,n(q,{modelValue:r(l).status,"onUpdate:modelValue":t[19]||(t[19]=a=>r(l).status=a),options:pe.value,class:"w-full"},null,8,["modelValue","options"])]),e("div",tl,[sl,n(L,{modelValue:r(l).estimated_cost,"onUpdate:modelValue":t[20]||(t[20]=a=>r(l).estimated_cost=a),mode:"currency",currency:"USD",locale:"fr-FR",class:"w-full"},null,8,["modelValue"])]),e("div",ll,[al,n(L,{modelValue:r(l).time_spent,"onUpdate:modelValue":t[21]||(t[21]=a=>r(l).time_spent=a),suffix:" min",class:"w-full"},null,8,["modelValue"])]),e("div",ol,[e("div",{class:F(["p-4 rounded-xl border-2 transition-all duration-300 cursor-pointer",r(l).requires_shutdown?"bg-red-900/50 border-red-700":"bg-slate-700/50 border-transparent"]),onClick:t[23]||(t[23]=a=>r(l).requires_shutdown=!r(l).requires_shutdown)},[e("div",rl,[n(oe,{modelValue:r(l).requires_shutdown,"onUpdate:modelValue":t[22]||(t[22]=a=>r(l).requires_shutdown=a),binary:!0},null,8,["modelValue"]),il])],2)])])]),e("div",nl,[e("div",dl,[cl,e("div",ul,[e("div",pl,[e("div",ml,[e("h4",_l,[U(" Inventaire des pièces "),e("span",fl,h(r(l).spare_parts.length),1)]),n(i,{icon:"pi pi-plus",label:"Ajouter",size:"small",onClick:Ke,class:"p-button-sm"})]),r(l).spare_parts.length===0?(p(),f("div",vl,xl)):(p(),f("div",yl,[(p(!0),f(N,null,P(r(l).spare_parts,(a,_)=>(p(),f("div",{key:_,class:"group flex items-start gap-2 p-3 bg-white border border-slate-200 rounded-lg hover:border-emerald-200 transition-colors shadow-sm"},[e("div",gl,[e("div",kl,[n(q,{modelValue:a.id,"onUpdate:modelValue":b=>a.id=b,options:g.spareParts,optionValue:"id",filter:"",placeholder:"Rechercher une pièce...",class:"w-full p-inputtext-sm custom-dropdown",scrollHeight:"250px"},{value:y(b=>{var K;return[b.value?(p(),f("div",wl,h(((K=g.spareParts.find(O=>O.id===b.value))==null?void 0:K.reference)||"Sélectionné"),1)):(p(),f("span",Vl,h(b.placeholder),1))]}),option:y(b=>[e("div",Tl,[e("span",ql,h(b.option.designation),1),e("span",Cl,h(b.option.reference),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),e("div",Sl,[e("div",Al,[Ul,n(L,{modelValue:a.quantity_used,"onUpdate:modelValue":b=>a.quantity_used=b,min:1,class:"p-inputtext-sm w-full"},null,8,["modelValue","onUpdate:modelValue"])])])]),n(i,{icon:"pi pi-trash",severity:"danger",text:"",size:"small",onClick:b=>Ye(_),class:"opacity-0 group-hover:opacity-100 transition-opacity"},null,8,["onClick"])]))),128))])),e("div",El,[n(i,{label:"Créer nouveau",icon:"pi pi-external-link",severity:"secondary",text:"",size:"small",onClick:Ze}),e("div",Dl,[jl,e("p",Ml,h(new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(ve.value)),1)])])]),e("div",Ol,[e("div",$l,[Il,e("div",Nl,[Pl,n(lt,{modelValue:W.value,"onUpdate:modelValue":t[24]||(t[24]=a=>W.value=a),scale:"0.8"},null,8,["modelValue"])])]),e("div",Fl,[W.value?(p(),f("div",zl,[(p(!0),f(N,null,P(Pe.value,a=>(p(),f("div",{key:a.parent.key,class:"border border-slate-200 rounded-xl overflow-hidden shadow-sm"},[e("div",{onClick:_=>Fe(a.parent.key),class:"flex justify-between items-center px-4 py-3 bg-white hover:bg-slate-50 cursor-pointer transition-colors"},[e("span",Hl,h(a.parent.label),1),e("i",{class:F(["pi text-[10px] transition-transform duration-200",_e(a.parent.key)?"pi-chevron-down":"pi-chevron-right"])},null,2)],8,Wl),_e(a.parent.key)?(p(),f("div",Ql,[(p(!0),f(N,null,P(a.children,_=>(p(),f("div",{key:_.key,class:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm"},[e("div",Gl,[e("span",Jl,h(_.label),1),e("div",Kl,[n(i,{icon:"pi pi-plus",size:"small",severity:"success",text:"",rounded:"",onClick:b=>Le(_.key)},null,8,["onClick"]),n(i,{icon:"pi pi-copy",size:"small",severity:"secondary",text:"",rounded:"",onClick:b=>Be(_.key)},null,8,["onClick"])])]),e("div",Yl,[(p(!0),f(N,null,P(r(l).instructions[_.key],(b,K)=>(p(),f("div",{key:K,class:"flex gap-2 items-start bg-slate-50 p-2 rounded border border-slate-100"},[e("div",Zl,[n(v,{modelValue:b.label,"onUpdate:modelValue":O=>b.label=O,placeholder:"Action à réaliser...",class:"w-full p-inputtext-sm text-xs"},null,8,["modelValue","onUpdate:modelValue"]),e("div",Xl,[n(q,{modelValue:b.type,"onUpdate:modelValue":O=>b.type=O,options:Ue.value,optionLabel:"label",optionValue:"value",class:"flex-1 p-inputtext-sm text-xs"},null,8,["modelValue","onUpdate:modelValue","options"]),e("div",ea,[n(oe,{modelValue:b.is_required,"onUpdate:modelValue":O=>b.is_required=O,binary:!0},null,8,["modelValue","onUpdate:modelValue"]),ta])])]),n(i,{icon:"pi pi-times",severity:"danger",text:"",size:"small",onClick:O=>Re(_.key,K)},null,8,["onClick"])]))),128))])]))),128))])):T("",!0)]))),128))])):(p(),f("div",Ll,Bl))])])])])])]),e("div",sa,[n(i,{label:"Annuler",icon:"pi pi-times",severity:"secondary",text:"",onClick:t[25]||(t[25]=a=>E.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"}),n(i,{label:"Enregistrer l'Ordre",icon:"pi pi-check-circle",onClick:De,loading:r(l).processing,class:"px-8 h-12 rounded-xl shadow-lg shadow-primary-100 font-black uppercase text-xs"},null,8,["loading"])])])]),_:1},8,["visible"]),n(r(re),{visible:H.value,"onUpdate:visible":t[28]||(t[28]=a=>H.value=a),modal:"",header:"Copier les instructions",style:{width:"40rem"}},{footer:y(()=>[n(i,{label:"Annuler",icon:"pi pi-times",onClick:t[27]||(t[27]=a=>H.value=!1),class:"p-button-text"}),n(i,{label:"Appliquer la copie",icon:"pi pi-check",onClick:Qe,disabled:!Ge.value},null,8,["disabled"])]),default:y(()=>[fe.value?(p(),f("div",la,[e("p",aa,[U("Copier les instructions de "),e("strong",null,h(fe.value.label),1),U(" vers :")]),e("div",oa,[He.value.length===0?(p(),f("div",ra," Aucune autre destination disponible. ")):T("",!0),(p(!0),f(N,null,P(We.value,a=>(p(),f("div",{key:a.parent.key},[e("div",ia,h(a.parent.label),1),e("div",na,[(p(!0),f(N,null,P(a.children,_=>(p(),f("div",{key:_.key,class:"flex items-center"},[n(oe,{modelValue:$.value[_.key],"onUpdate:modelValue":b=>$.value[_.key]=b,inputId:`target-${_.key}`,binary:!0},null,8,["modelValue","onUpdate:modelValue","inputId"]),e("label",{for:`target-${_.key}`,class:"ml-2"},h(_.label),9,da)]))),128))])]))),128))])])):T("",!0)]),_:1},8,["visible"]),n(r(re),{visible:Q.value,"onUpdate:visible":t[35]||(t[35]=a=>Q.value=a),modal:"",header:"Créer une nouvelle pièce détachée",style:{width:"30rem"}},{footer:y(()=>[n(i,{label:"Annuler",icon:"pi pi-times",onClick:t[34]||(t[34]=a=>Q.value=!1),class:"p-button-text"}),n(i,{label:"Créer",icon:"pi pi-check",onClick:Xe,loading:r(x).processing},null,8,["loading"])]),default:y(()=>[e("div",ca,[e("div",ua,[pa,n(v,{id:"spare_part_name",modelValue:r(x).name,"onUpdate:modelValue":t[29]||(t[29]=a=>r(x).name=a),modelModifiers:{trim:!0},class:F({"p-invalid":r(x).errors.name})},null,8,["modelValue","class"]),e("small",ma,h(r(x).errors.name),1)]),e("div",_a,[fa,n(v,{id:"spare_part_reference",modelValue:r(x).reference,"onUpdate:modelValue":t[30]||(t[30]=a=>r(x).reference=a),modelModifiers:{trim:!0},class:F({"p-invalid":r(x).errors.reference})},null,8,["modelValue","class"]),e("small",va,h(r(x).errors.reference),1)]),e("div",ba,[ha,n(q,{id:"spare_part_category",modelValue:r(x).category_id,"onUpdate:modelValue":t[31]||(t[31]=a=>r(x).category_id=a),options:g.categories,optionLabel:"designation",optionValue:"id",placeholder:"Sélectionner une catégorie",class:F({"p-invalid":r(x).errors.category_id})},null,8,["modelValue","options","class"]),e("small",xa,h(r(x).errors.category_id),1)]),e("div",ya,[ga,n(L,{id:"spare_part_stock_quantity",modelValue:r(x).stock_quantity,"onUpdate:modelValue":t[32]||(t[32]=a=>r(x).stock_quantity=a),min:0,class:F({"p-invalid":r(x).errors.stock_quantity})},null,8,["modelValue","class"]),e("small",ka,h(r(x).errors.stock_quantity),1)]),e("div",wa,[Va,n(L,{id:"spare_part_unit_estimated_cost",modelValue:r(x).unit_estimated_cost,"onUpdate:modelValue":t[33]||(t[33]=a=>r(x).unit_estimated_cost=a),mode:"currency",currency:"USD",locale:"fr-FR",min:0,class:F({"p-invalid":r(x).errors.unit_estimated_cost})},null,8,["modelValue","class"]),e("small",Ta,h(r(x).errors.unit_estimated_cost),1)])])]),_:1},8,["visible"])]),_:1})}}},to=Dt(qa,[["__scopeId","data-v-13ae3493"]]);export{to as default};
