import{T as ie}from"./index-CrFEKHH1.js";import{u as re,a as ne,b as de,r as v,d as x,T as z,F,c as B,e as N,f as p,o as u,i as a,g as e,Z as ce,j as s,l as h,n as U,t as c,s as I,m as O,p as j,q as M,U as E,k as ue,h as H}from"./app-gDNqx2_D.js";import{_ as pe}from"./AppLayout-SGD7JHFV.js";import{s as m}from"./index-BFXGy4uN.js";import{s as T}from"./index-DnMOyY1I.js";import{s as w,a as me}from"./index-C2t85Ev4.js";import{s as be}from"./index-bSGFH6Vt.js";import{s as fe}from"./index-qtJx-Jx6.js";import{s as ge}from"./index-tkdp3lW-.js";import{s as ve}from"./index-psDJnd0s.js";import{s as he}from"./index-D4DTux10.js";import{s as W}from"./index-BHExvObj.js";import{s as xe}from"./index-Dqyvdu4C.js";import{s as _e}from"./index-B3zaMp9D.js";import{a as ye,s as we}from"./index-3Y3FmX7C.js";import{s as ke}from"./index-DNoI7EM0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DIW2SyDI.js";import"./index-E0OnojZQ.js";import"./index-CadKbAM9.js";import"./index-C57fO0mp.js";import"./index-qcYzN5_Q.js";import"./index-DWMCXZ5G.js";import"./index-Sf75UUsw.js";import"./index-CaNPRaEQ.js";const Ce={class:"min-h-screen bg-slate-50/50 p-4 lg:p-8"},Ve={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8"},Se=s("div",{class:"flex items-center gap-4"},[s("div",{class:"flex h-16 w-16 items-center justify-center rounded-[2rem] bg-primary-600 shadow-xl shadow-primary-200"},[s("i",{class:"pi pi-tags text-2xl text-white"})]),s("h1",{class:"text-3xl font-black text-slate-900 tracking-tight"},[ue("Configuration des "),s("span",{class:"text-primary-600"},"Labels")])],-1),$e={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Fe={class:"flex flex-column gap-2"},Te={class:"text-xs font-black text-slate-400 uppercase tracking-widest"},Pe={class:"flex items-center justify-between"},Le={class:"text-3xl font-black text-slate-800"},Ne={class:"w-10 h-10 rounded-2xl bg-slate-50 flex items-center justify-center"},Ue={class:"bg-white rounded-[2rem] shadow-xl border border-slate-200 overflow-hidden"},Oe={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},je={class:"flex gap-2"},De={class:"flex items-center gap-3"},qe={class:"font-black text-slate-700"},Ae={class:"flex flex-wrap gap-1"},Re={key:0,class:"text-xs italic text-slate-400"},ze={class:"flex gap-1"},Be={class:"px-8 py-5 bg-slate-900 text-white rounded-xl flex justify-between items-center relative z-50"},Ie={class:"flex items-center gap-4"},Me=s("div",{class:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary-200"},[s("i",{class:"pi pi-tag text-xl"})],-1),Ee={class:"flex flex-col"},He={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},We={class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"},Je={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth"},Ge={class:"grid grid-cols-1 md:grid-cols-12 gap-8"},Ke={class:"md:col-span-12 space-y-8"},Ze={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Qe={class:"md:col-span-2 flex flex-col gap-2"},Xe={class:"text-xs font-black text-slate-500 uppercase tracking-widest"},Ye={key:0,class:"text-red-500 font-bold"},es={class:"space-y-2"},ss={class:"text-xs font-black text-slate-500 uppercase tracking-widest"},ts={class:"flex items-center gap-3 p-2 bg-white rounded-xl border border-slate-200"},ls={class:"font-mono text-xs font-bold text-slate-400"},as={class:"md:col-span-3 space-y-2"},os={class:"text-xs font-black text-slate-500 uppercase tracking-widest"},is={class:"space-y-6"},rs={class:"flex items-center gap-4 bg-slate-50 p-4 rounded-2xl border border-slate-100"},ns={class:"font-black text-slate-800 m-0"},ds={class:"text-xs text-slate-500 m-0"},cs={key:0,class:"space-y-4"},us={class:"col-span-5"},ps={class:"col-span-4"},ms={class:"col-span-2 flex items-center justify-center gap-2"},bs=["for"],fs={class:"col-span-1 flex justify-end"},gs={key:1,class:"text-center py-8 bg-slate-50 rounded-3xl border-2 border-dashed border-slate-200"},vs=s("p",{class:"text-slate-400 text-sm italic"},"Aucune caractéristique définie pour ce label.",-1),hs=[vs],xs={class:"flex justify-end"},_s={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},Ws={__name:"Labels",props:{labels:Object,filters:Object},setup(V){var A,R;const{t:l}=re(),k=V,C=ne(),P=de(),D=v(),_=v(!1),S=v(!1),b=v(!1);v(((A=k.filters)==null?void 0:A.search)||"");const y=v([]),J=v([{label:x(()=>l("labels.types.text")),value:"text"},{label:x(()=>l("labels.types.number")),value:"number"},{label:x(()=>l("labels.types.date")),value:"date"},{label:x(()=>l("labels.types.file")),value:"file"},{label:x(()=>l("labels.types.boolean")),value:"boolean"},{label:x(()=>l("labels.types.select")),value:"select"}]),r=z({id:null,designation:"",description:"",color:"3B82F6",characteristics:[]}),G=x(()=>{const i=k.labels.data||[];return{total:i.length,withChars:i.filter(o=>{var f;return((f=o.label_characteristics)==null?void 0:f.length)>0}).length}}),L=v(!1),n=v({first:k.labels.from-1,rows:k.labels.per_page,sortField:"created_at",sortOrder:-1,filters:{global:{value:((R=k.filters)==null?void 0:R.search)||null,matchMode:F.CONTAINS},designation:{operator:B.AND,constraints:[{value:null,matchMode:F.STARTS_WITH}]}}}),K=()=>{n.value.filters={global:{value:null,matchMode:F.CONTAINS},designation:{operator:B.AND,constraints:[{value:null,matchMode:F.STARTS_WITH}]}},$()},$=()=>{L.value=!0,H.get(route("labels.index"),{page:n.value.first/n.value.rows+1,per_page:n.value.rows,sortField:n.value.sortField,sortOrder:n.value.sortOrder===1?"asc":"desc",search:n.value.filters.global.value},{preserveState:!0,replace:!0,onFinish:()=>{L.value=!1}})},Z=i=>{n.value.first=i.first,n.value.rows=i.rows,$()},Q=i=>{n.value.sortField=i.sortField,n.value.sortOrder=i.sortOrder,$()},X=i=>{n.value.filters=i.filters,$()},Y=()=>{r.reset(),b.value=!1,S.value=!1,_.value=!0},ee=i=>{r.id=i.id,r.designation=i.designation,r.description=i.description,r.color=i.color.replace("#",""),r.characteristics=i.label_characteristics?JSON.parse(JSON.stringify(i.label_characteristics)):[],b.value=!0,_.value=!0},se=()=>{if(S.value=!0,!r.designation)return;b.value&&r.isDirty?P.require({message:l("labels.messages.confirmChange"),header:l("common.confirmation"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-warning",accept:()=>q()}):q()},q=()=>{const i=b.value?route("labels.update",r.id):route("labels.store"),o=b.value?"put":"post";r.transform(f=>({...f,color:"#"+f.color,characteristics:f.characteristics.filter(t=>t.name.trim()!=="")})).submit(o,i,{onSuccess:()=>{_.value=!1,C.add({severity:"success",summary:"Succès",detail:l(`labels.messages.${b.value?"updateSuccess":"createSuccess"}`),life:3e3}),r.reset()},onError:()=>C.add({severity:"error",summary:"Erreur",detail:l("common.errorOccurred"),life:3e3})})},te=i=>{P.require({message:l("labels.messages.confirmDelete",{name:i.designation}),header:l("common.deleteConfirmation"),icon:"pi pi-exclamation-circle",acceptClass:"p-button-danger",accept:()=>{H.delete(route("labels.destroy",i.id),{onSuccess:()=>C.add({severity:"success",summary:"Supprimé",detail:l("labels.messages.deleteSuccess"),life:3e3})})}})},le=()=>{P.require({message:l("labels.messages.confirmBulkDelete"),header:l("common.deleteConfirmation"),icon:"pi pi-exclamation-circle",acceptClass:"p-button-danger",accept:()=>{z({ids:y.value.map(o=>o.id)}).post(route("labels.bulkDestroy"),{onSuccess:()=>{C.add({severity:"success",summary:"Supprimé",detail:l("labels.messages.bulkDeleteSuccess"),life:3e3}),y.value=[]},onError:()=>C.add({severity:"error",summary:"Erreur",detail:l("common.errorOccurred"),life:3e3})})}})},ae=()=>{r.characteristics.push({id:null,name:"",type:"text",is_required:!1})},oe=i=>{r.characteristics.splice(i,1)};return x(()=>b.value?l("labels.dialog.editTitle"):l("labels.dialog.createTitle")),(i,o)=>{const f=ie;return u(),N(pe,{title:"Gestion des Labels"},{default:p(()=>[a(e(ce),{title:e(l)("labels.title")},null,8,["title"]),s("div",Ce,[s("div",Ve,[Se,a(e(m),{label:e(l)("labels.actions.add"),icon:"pi pi-plus",raised:"",onClick:Y,class:"rounded-xl px-6"},null,8,["label"])]),s("div",$e,[(u(!0),h(O,null,U(G.value,(t,d)=>(u(),h("div",{key:d,class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all"},[s("div",Fe,[s("span",Te,c(e(l)(`labels.stats.${d}`)),1),s("div",Pe,[s("span",Le,c(t),1),s("div",Ne,[s("i",{class:I([d==="total"?"pi pi-tags":"pi pi-sitemap","text-slate-400"])},null,2)])])])]))),128))]),s("div",Ue,[a(e(ve)),a(e(he)),a(e(me),{ref_key:"dt",ref:D,value:V.labels.data,selection:y.value,"onUpdate:selection":o[2]||(o[2]=t=>y.value=t),dataKey:"id",lazy:!0,paginator:!0,rowsPerPageOptions:[15,30,50,100,500],totalRecords:V.labels.total,rows:V.labels.per_page,loading:L.value,onPage:o[3]||(o[3]=t=>Z(t)),onSort:o[4]||(o[4]=t=>Q(t)),onFilter:o[5]||(o[5]=t=>X(t)),filters:n.value.filters,"onUpdate:filters":o[6]||(o[6]=t=>n.value.filters=t),filterDisplay:"menu",globalFilterFields:["designation","description"],class:"p-datatable-custom",removableSort:"",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",responsiveLayout:"scroll",currentPageReportTemplate:e(l)("myActivities.table.report")},{header:p(()=>[s("div",Oe,[a(e(ye),{iconPosition:"left"},{default:p(()=>[a(e(we),{class:"pi pi-search text-slate-400"}),a(e(T),{modelValue:n.value.filters.global.value,"onUpdate:modelValue":o[0]||(o[0]=t=>n.value.filters.global.value=t),placeholder:e(l)("labels.toolbar.searchPlaceholder"),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),s("div",je,[y.value.length?(u(),N(e(m),{key:0,label:`Supprimer (${y.value.length})`,icon:"pi pi-trash",severity:"danger",onClick:le,class:"rounded-xl"},null,8,["label"])):j("",!0),M(a(e(m),{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:K,class:"rounded-xl"},null,512),[[f,e(l)("labels.toolbar.resetFilters"),void 0,{bottom:!0}]]),a(e(m),{label:e(l)("common.export"),icon:"pi pi-upload",severity:"secondary",text:"",onClick:o[1]||(o[1]=t=>D.value.exportCSV())},null,8,["label"])])])]),default:p(()=>[a(e(w),{selectionMode:"multiple",headerStyle:"width: 3rem"}),a(e(w),{field:"designation",header:e(l)("labels.fields.name"),sortable:""},{body:p(({data:t})=>[s("div",De,[a(e(ke),{label:t.designation[0],shape:"circle",style:E({backgroundColor:t.color+"20",color:t.color}),class:"font-bold"},null,8,["label","style"]),s("span",qe,c(t.designation),1)])]),filter:p(({filterModel:t})=>[a(e(T),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,type:"text",class:"p-column-filter",placeholder:e(l)("common.searchByName")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"]),a(e(w),{header:e(l)("labels.fields.style")},{body:p(({data:t})=>[a(e(W),{value:t.color,style:E({backgroundColor:t.color,color:"#fff"}),class:"rounded-lg px-3 border-none"},null,8,["value","style"])]),_:1},8,["header"]),a(e(w),{field:"description",header:e(l)("labels.fields.description"),class:"text-slate-500 text-sm"},null,8,["header"]),a(e(w),{header:e(l)("labels.fields.characteristics")},{body:p(({data:t})=>{var d;return[s("div",Ae,[(u(!0),h(O,null,U(t.label_characteristics,g=>(u(),N(e(W),{key:g.id,value:g.name,severity:"secondary",class:"bg-slate-100 text-slate-600 border-none px-2"},null,8,["value"]))),128)),(d=t.label_characteristics)!=null&&d.length?j("",!0):(u(),h("span",Re,"Aucune"))])]}),_:1},8,["header"]),a(e(w),{header:e(l)("common.actions"),alignFrozen:"right",frozen:""},{body:p(({data:t})=>[s("div",ze,[a(e(m),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:d=>ee(t)},null,8,["onClick"]),a(e(m),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:d=>te(t)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","selection","totalRecords","rows","loading","filters","currentPageReportTemplate"])])]),a(e(be),{visible:_.value,"onUpdate:visible":o[12]||(o[12]=t=>_.value=t),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"600px"},contentStyle:{maxHeight:"85vh",overflow:"auto"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:p(()=>[s("div",_s,[a(e(m),{label:e(l)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:o[11]||(o[11]=t=>_.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),a(e(m),{label:b.value?e(l)("common.update"):e(l)("common.save"),icon:"pi pi-check-circle",severity:"indigo",class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",onClick:se,loading:e(r).processing},null,8,["label","loading"])])]),default:p(()=>[s("div",Be,[s("div",Ie,[Me,s("div",Ee,[s("h2",He,c(b.value?e(l)("labels.dialog.editTitle"):e(l)("labels.dialog.createTitle")),1),s("span",We,c(b.value?e(l)("labels.dialog.editSubtitle"):e(l)("labels.dialog.createSubtitle")),1)])]),M(a(e(m),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:o[7]||(o[7]=t=>_.value=!1),class:"text-white hover:bg-white/10"},null,512),[[f,e(l)("common.cancel"),void 0,{bottom:!0}]])]),s("div",Je,[s("div",Ge,[s("div",Ke,[s("div",Ze,[s("div",Qe,[s("label",Xe,c(e(l)("labels.fields.name")),1),a(e(T),{modelValue:e(r).designation,"onUpdate:modelValue":o[8]||(o[8]=t=>e(r).designation=t),class:I(["w-full py-3.5 rounded-xl border-slate-200 shadow-inner",{"p-invalid":S.value&&!e(r).designation}])},null,8,["modelValue","class"]),S.value&&!e(r).designation?(u(),h("small",Ye,c(e(l)("labels.validation.nameRequired")),1)):j("",!0)]),s("div",es,[s("label",ss,c(e(l)("labels.fields.color")),1),s("div",ts,[a(e(_e),{modelValue:e(r).color,"onUpdate:modelValue":o[9]||(o[9]=t=>e(r).color=t)},null,8,["modelValue"]),s("span",ls,"#"+c(e(r).color),1)])]),s("div",as,[s("label",os,c(e(l)("labels.fields.description")),1),a(e(ge),{modelValue:e(r).description,"onUpdate:modelValue":o[10]||(o[10]=t=>e(r).description=t),rows:"2",class:"w-full rounded-xl border-slate-200"},null,8,["modelValue"])])]),s("div",is,[s("div",rs,[s("div",null,[s("h4",ns,c(e(l)("labels.fields.technicalAttributes")),1),s("p",ds,c(e(l)("labels.fields.technicalAttributesSubtitle")),1)])]),e(r).characteristics.length?(u(),h("div",cs,[(u(!0),h(O,null,U(e(r).characteristics,(t,d)=>(u(),h("div",{key:d,class:"grid grid-cols-12 items-center gap-3 p-4 bg-white border border-slate-100 rounded-2xl shadow-sm"},[s("div",us,[a(e(T),{modelValue:t.name,"onUpdate:modelValue":g=>t.name=g,placeholder:e(l)("labels.fields.charName"),class:"w-full rounded-lg border-slate-200 text-sm"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),s("div",ps,[a(e(fe),{modelValue:t.type,"onUpdate:modelValue":g=>t.type=g,options:J.value,optionLabel:"label",optionValue:"value",class:"w-full rounded-lg border-slate-200 text-sm",disabled:t.id!==null},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),s("div",ms,[a(e(xe),{modelValue:t.is_required,"onUpdate:modelValue":g=>t.is_required=g,binary:!0,inputId:`req-${d}`},null,8,["modelValue","onUpdate:modelValue","inputId"]),s("label",{for:`req-${d}`,class:"text-xs font-bold text-slate-500"},c(e(l)("labels.fields.isRequiredShort")),9,bs)]),s("div",fs,[a(e(m),{icon:"pi pi-trash",severity:"danger",text:"",rounded:"",onClick:g=>oe(d)},null,8,["onClick"])])]))),128))])):(u(),h("div",gs,hs))]),s("div",xs,[a(e(m),{label:e(l)("labels.actions.addChar"),icon:"pi pi-plus",severity:"secondary",outlined:"",onClick:ae,class:"rounded-xl"},null,8,["label"])])])])])]),_:1},8,["visible"])]),_:1})}}};export{Ws as default};
