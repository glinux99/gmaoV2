import{T as Ce}from"./index-CQck-czE.js";import{u as Te,a as Se,b as ze,r as g,d as C,T as $e,w as B,l as m,i as r,f as c,g as e,z as ae,m as K,F as A,c as W,o as d,Z as Ue,j as s,t as o,p as _,n as q,s as je,k as Fe,q as M,e as h,A as De,h as oe}from"./app-BTm5MPCd.js";import{_ as Ae}from"./AppLayout-PXrFRazT.js";import{u as Le,s as Ne}from"./index-B2S-zrPE.js";import{s as f}from"./index-DR-PVOhd.js";import{s as j}from"./index-DGDWVGXJ.js";import{a as Re,s as y}from"./index-Dpj4P_iu.js";import{s as ne}from"./index-C9ua_LZc.js";import{s as T}from"./index-DR_P-HCg.js";import{s as ie}from"./index-C3ZvT3G3.js";import{s as Ee}from"./index-DWk9iUT_.js";import{s as Ie}from"./index-DggD9_PH.js";import{a as Ke,s as Me}from"./index-CwE9RYdH.js";import{s as E}from"./index-B_B1CqLL.js";import{s as Oe}from"./index-CM1LmSBY.js";import{s as He}from"./index-5eLJkV0u.js";import{s as Be}from"./index-DGQuV0xQ.js";import{s as We}from"./index-4qHTzGaD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CqRe5Bfh.js";import"./index-CZPsBpjb.js";import"./index-U7kuayBf.js";import"./index-X3iKIzTH.js";import"./index-DOcyrvpR.js";import"./index-BMBaB7B1.js";import"./index-DJd_Kodp.js";import"./index-sPpDuk3t.js";const qe={class:"p-4 lg:p-10 bg-[#F8FAFC] min-h-screen"},Qe={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-10"},Ze={class:"flex items-center gap-4"},Ge=s("div",{class:"w-14 h-14 bg-primary-600 rounded-2xl flex items-center justify-center shadow-xl shadow-primary-100 rotate-3"},[s("i",{class:"pi pi-key text-white text-xl"})],-1),Je=["innerHTML"],Xe={class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},Ye={class:"flex gap-3 bg-white p-2 rounded-2xl shadow-sm border border-slate-100"},Pe={key:0,class:"flex gap-2"},et={class:"flex gap-2"},tt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},st={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},lt=s("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[s("i",{class:"pi pi-key text-2xl text-slate-500"})],-1),at={class:"text-2xl font-black text-slate-800"},ot={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},nt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},it=s("div",{class:"w-14 h-14 rounded-xl bg-green-50 flex items-center justify-center"},[s("i",{class:"pi pi-check-circle text-2xl text-green-500"})],-1),rt={class:"text-2xl font-black text-slate-800"},dt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},ct={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},ut=s("div",{class:"w-14 h-14 rounded-xl bg-red-50 flex items-center justify-center"},[s("i",{class:"pi pi-exclamation-triangle text-2xl text-red-500"})],-1),pt={class:"text-2xl font-black text-slate-800"},mt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},_t={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},ft=s("div",{class:"w-14 h-14 rounded-xl bg-sky-50 flex items-center justify-center"},[s("i",{class:"pi pi-inbox text-2xl text-sky-500"})],-1),xt={class:"text-2xl font-black text-slate-800"},bt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},ht={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},yt={class:"lg:col-span-2"},vt={class:"text-sm font-black text-slate-600 uppercase tracking-widest mb-4"},gt={key:0,class:"flex flex-wrap gap-4"},kt=["onClick"],wt=s("div",{class:"w-10 h-10 rounded-lg bg-sky-100 flex items-center justify-center"},[s("i",{class:"pi pi-map-marker text-lg text-sky-600"})],-1),Vt={class:"text-xl font-black text-slate-800"},Ct={class:"text-[10px] font-bold text-slate-500 uppercase tracking-wider"},Tt={key:1,class:"text-center py-4 bg-white rounded-xl border border-slate-200 text-slate-400 italic text-sm"},St={key:2,class:"mt-6 p-6 bg-primary-50 border-2 border-dashed border-primary-200 rounded-2xl animate-fade-in"},zt={class:"flex justify-between items-center mb-4"},$t={class:"text-sm font-black text-primary-800 uppercase tracking-widest"},Ut={class:"text-primary-600"},jt={class:"flex flex-wrap gap-3"},Ft=s("div",{class:"w-8 h-8 rounded-md bg-primary-100 flex items-center justify-center"},[s("i",{class:"pi pi-compass text-sm text-primary-700"})],-1),Dt={class:"text-lg font-black text-slate-800"},At={class:"text-[9px] font-bold text-primary-600/80 uppercase tracking-wider"},Lt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm"},Nt={class:"text-sm font-black text-slate-600 uppercase tracking-widest mb-4"},Rt={class:"flex justify-center items-center h-48"},Et={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-200/60 overflow-hidden"},It={class:"flex justify-between items-center p-4"},Kt={class:"flex items-center gap-2"},Mt={class:"flex items-center gap-4"},Ot=s("div",{class:"w-12 h-12 rounded-xl flex items-center justify-center bg-slate-100"},[s("i",{class:"pi pi-key text-slate-500"})],-1),Ht={class:"flex flex-col"},Bt=["onClick"],Wt={class:"text-[10px] font-mono text-slate-400 tracking-tighter"},qt=["href"],Qt=s("i",{class:"pi pi-user text-primary-400 text-xs group-hover:text-primary-600"},null,-1),Zt={class:"text-sm font-bold text-slate-600 group-hover:text-primary-600 group-hover:underline"},Gt={key:1,class:"text-slate-400 text-xs italic"},Jt=["href"],Xt=s("i",{class:"pi pi-bolt text-primary-400 text-xs group-hover:text-primary-600"},null,-1),Yt={class:"text-sm font-bold text-slate-600 group-hover:text-primary-600 group-hover:underline"},Pt={key:1,class:"text-slate-400 text-xs italic"},es={class:"text-xs font-medium text-slate-500"},ts={class:"text-xs font-medium text-slate-500"},ss={class:"text-xs font-medium text-slate-500"},ls={class:"text-xs font-medium text-slate-500"},as={class:"text-xs font-medium text-slate-500"},os=["title"],ns={class:"flex gap-2 justify-end"},is={class:"text-sm font-black text-slate-800 mb-4"},rs={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50 rounded-xl"},ds={class:"flex items-center gap-4"},cs=s("div",{class:"p-2.5 bg-blue-500/20 rounded-xl border border-blue-500/30"},[s("i",{class:"pi pi-key text-blue-400 text-xl"})],-1),us={class:"flex flex-col"},ps={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},ms={class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"},_s={class:"p-8 bg-white max-h-[70vh] overflow-y-auto scroll-smooth"},fs={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 py-4"},xs={class:"flex flex-col gap-2 md:col-span-2"},bs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},hs={class:"flex flex-col gap-2"},ys={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},vs={class:"flex flex-col gap-2"},gs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},ks={class:"flex flex-col gap-2"},ws={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Vs={class:"flex flex-col gap-2"},Cs={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Ts={class:"flex flex-col gap-2"},Ss={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},zs={key:0,class:"flex items-center gap-2 overflow-hidden"},$s={class:"flex flex-row items-center gap-2 truncate"},Us={class:"text-xs font-semibold text-slate-900 leading-none"},js={class:"text-[10px] text-indigo-600 font-bold uppercase leading-none"},Fs={key:0,class:"pi pi-exclamation-triangle text-red-500 text-[10px]"},Ds={key:1,class:"text-xs text-slate-400 font-normal"},As={class:"flex items-center justify-between w-full py-0"},Ls={class:"flex flex-col py-1"},Ns={class:"text-xs font-bold text-slate-800 leading-tight"},Rs={class:"flex items-center gap-1"},Es={class:"text-[9px] text-slate-500 uppercase tracking-tighter"},Is={class:"flex gap-1"},Ks={class:"py-1 px-3 border-t bg-slate-50 text-[9px] text-slate-400 italic"},Ms={class:"flex flex-col gap-2"},Os={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Hs={key:0},Bs={key:1},Ws={class:"flex justify-between items-center w-full"},qs={class:"font-bold"},Qs={key:0,class:"text-xs text-slate-500 ml-4 flex items-center gap-1"},Zs=s("i",{class:"pi pi-user text-[9px]"},null,-1),Gs={class:"flex flex-col gap-2"},Js={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Xs={class:"flex flex-col gap-2"},Ys={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Ps={class:"flex flex-col gap-2"},el={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},tl={class:"flex flex-col gap-2 md:col-span-2"},sl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},ll={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},al={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50 rounded-xl"},ol={class:"flex items-center gap-4"},nl=s("div",{class:"p-2.5 bg-blue-500/20 rounded-xl border border-blue-500/30"},[s("i",{class:"pi pi-arrows-h text-blue-400 text-xl"})],-1),il={class:"flex flex-col"},rl={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},dl=s("span",{class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"},"Mouvement inter-régional",-1),cl={class:"p-8 bg-white max-h-[70vh] overflow-y-auto scroll-smooth space-y-6"},ul={class:"flex flex-col gap-2"},pl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},ml={key:0,class:"p-error"},_l={class:"flex flex-col gap-2"},fl={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},xl={class:"flex items-center justify-between w-full"},bl={class:"flex flex-col"},hl={class:"font-bold text-sm"},yl={class:"flex items-center gap-2 text-xs text-slate-500"},vl=s("i",{class:"pi pi-map-marker text-[10px]"},null,-1),gl={class:"font-semibold text-slate-600"},kl=s("i",{class:"pi pi-angle-right text-[8px] text-primary-500"},null,-1),wl={class:"font-black text-primary-600"},Vl={class:"p-4 bg-slate-50 rounded-2xl border border-slate-100"},Cl={class:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3"},Tl={class:"max-h-48 overflow-y-auto space-y-2 pr-2"},Sl={class:"text-sm font-bold text-slate-700"},zl={key:0,class:"text-center py-4 text-slate-400 italic text-xs"},$l={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},la={__name:"Keypads",props:{keypads:Object,filters:Object,connections:Array,regions:Array,zones:Array,meters:Array},setup(k){const{t:l}=Te(),v=k,L=Se(),Q=ze(),Z=g(),$=g(!1),S=g(!1),w=g([]),G=g(),re=g([{field:"serial_number",header:l("keypads.table.serial_number")},{field:"model",header:l("keypads.table.model")},{field:"manufacturer",header:l("keypads.table.manufacturer")},{field:"type",header:l("keypads.table.type")},{field:"status",header:l("keypads.table.status")},{field:"connection_full_name",header:l("keypads.table.connection_full_name")},{field:"meter_serial_number",header:l("keypads.table.meter_serial_number")},{field:"installation_date",header:l("keypads.table.installation_date")},{field:"region_name",header:l("keypads.table.region_name")},{field:"zone_name",header:l("keypads.table.zone_name")},{field:"notes",header:l("keypads.table.notes")}]),x=g(["serial_number","status","connection_full_name","meter_serial_number","region_name"]),N=g(),J=()=>{N.value={global:{value:null,matchMode:A.CONTAINS},serial_number:{operator:W.AND,constraints:[{value:null,matchMode:A.STARTS_WITH}]},type:{value:null,matchMode:A.EQUALS},status:{value:null,matchMode:A.EQUALS},"connection.full_name":{operator:W.AND,constraints:[{value:null,matchMode:A.STARTS_WITH}]},"meter.serial_number":{operator:W.AND,constraints:[{value:null,matchMode:A.STARTS_WITH}]}}};J();const U=C(()=>{const i={total:v.keypads.data.length,available:0,installed:0,faulty:0};return v.keypads.data.forEach(a=>{i.hasOwnProperty(a.status)&&i[a.status]++}),i}),X=C(()=>{const i={};return v.keypads.data.forEach(a=>{var u;if(a.status==="available"&&a.region){const t=((u=a.region)==null?void 0:u.designation)||"Non spécifiée";i[t]||(i[t]=0),i[t]++}}),Object.entries(i).map(([a,u])=>({name:a,count:u}))}),Y=C(()=>{if(!V.value)return[];const i={};return v.keypads.data.forEach(a=>{var t,p;const u=((t=a.region)==null?void 0:t.designation)||"Non spécifiée";if(a.status==="available"&&u===V.value){const b=((p=a.zone)==null?void 0:p.nomenclature)||"Hors-zone";i[b]||(i[b]=0),i[b]++}}),Object.entries(i).map(([a,u])=>({name:a,count:u})).sort((a,u)=>a.name.localeCompare(u.name))}),de=C(()=>{var u,t,p;const i=getComputedStyle(document.documentElement),a=(b,F)=>i.getPropertyValue(b).trim()||F;return{labels:[l("keypads.stats.installed"),l("keypads.stats.available"),l("keypads.stats.faulty")],datasets:[{data:[((u=U.value)==null?void 0:u.installed)||0,((t=U.value)==null?void 0:t.available)||0,((p=U.value)==null?void 0:p.faulty)||0],backgroundColor:[a("--indigo-500","#6366f1"),a("--orange-500","#f59e0b"),a("--rose-500","#f43f5e")],hoverBackgroundColor:[a("--indigo-400","#818cf8"),a("--orange-400","#fbbf24"),a("--rose-400","#fb7185")]}]}}),ce=g({plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,font:{weight:"bold"}}}}}),P=g(["standard","avancé"]),ee=g(["available","installed","faulty"]),te=i=>({installed:"success",available:"info",faulty:"danger"})[i]||"secondary",n=$e({id:null,serial_number:"",model:"",manufacturer:"",type:"standard",status:"available",installation_date:null,connection_id:null,region_id:null,zone_id:null,meter_id:null,notes:""}),ue=()=>{n.reset(),S.value=!1,n.installation_date=new Date,$.value=!0},se=i=>{n.clearErrors(),Object.assign(n,{...i,installation_date:i.installation_date?new Date(i.installation_date):null}),S.value=!0,$.value=!0},pe=()=>{const i=S.value?route("keypads.update",n.id):route("keypads.store"),a=S.value?"put":"post";n.transform(u=>({...u,installation_date:u.installation_date?new Date(u.installation_date).toISOString().split("T")[0]:null})).submit(a,i,{onSuccess:()=>{$.value=!1,L.add({severity:"success",summary:l("common.success"),detail:`Clavier ${S.value?"mis à jour":"créé"} avec succès.`,life:3e3})},onError:u=>{const t=Object.values(u).join(", ");L.add({severity:"error",summary:"Erreur de sauvegarde",detail:t,life:5e3})}})},me=i=>{Q.require({message:l("keypads.confirm.deleteMessage",{serial_number:i.serial_number}),header:l("keypads.confirm.deleteHeader"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{oe.delete(route("keypads.destroy",i.id),{onSuccess:()=>L.add({severity:"success",summary:l("common.success"),detail:l("keypads.toast.deleteSuccess"),life:3e3})})}})},_e=()=>{Q.require({message:l("keypads.confirm.bulkDeleteMessage",{count:w.value.length}),header:l("keypads.confirm.bulkDeleteHeader"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",acceptLabel:l("common.delete"),rejectLabel:l("common.cancel"),accept:()=>{fe()}})},fe=()=>{oe.post(route("keypads.bulkdestroy"),{ids:w.value.map(i=>i.id)},{onSuccess:()=>{L.add({severity:"success",summary:l("common.success"),detail:l("keypads.toast.bulkDeleteSuccess"),life:3e3}),w.value=[]},onError:()=>{L.add({severity:"error",summary:l("common.error"),detail:l("keypads.toast.bulkDeleteError"),life:3e3})}})},xe=C(()=>v.keypads.data),{transferDialog:R,transferForm:z,itemsToTransfer:I,transferSearchQuery:O,availableItemsForTransfer:be,openTransferDialog:he,confirmTransfer:ye,searchItemsForTransfer:ve,addItemToTransfer:ge,removeItemFromTransfer:ke}=Le({allItems:xe,selectedItems:w,transferRouteName:route("keypads.bulk-transfer"),idKey:"keypad_ids",stockStatus:"available",translations:{attention:l("common.attention"),selectDestinationRegion:l("keypads.toast.selectDestinationRegion"),success:l("common.success"),transferSuccess:i=>l("keypads.toast.transferSuccess",{count:i}),transferError:l("keypads.toast.transferError")}}),we=C(()=>v.keypads.data.map(i=>{var a,u,t;return{...i,connection_full_name:i.connection?`${i.connection.first_name} ${i.connection.last_name}`.trim():l("keypads.table.unassigned"),meter_serial_number:((a=i.meter)==null?void 0:a.serial_number)||l("keypads.table.unassigned"),region_name:((u=i.region)==null?void 0:u.designation)||l("common.notApplicable"),zone_name:((t=i.zone)==null?void 0:t.nomenclature)||l("common.notApplicable")}})),H=C(()=>n.region_id?v.zones.filter(i=>i.region_id===n.region_id):[]);B(()=>n.region_id,i=>{H.value.some(a=>a.id===n.zone_id)||(n.zone_id=null)}),B(()=>n.meter_id,i=>{if(n.connection_id||(n.region_id=null,n.zone_id=null),i){const a=v.meters.find(u=>u.id===i);a&&(n.connection_id||(n.region_id=a.region_id,n.zone_id=a.zone_id)),console.log(n.region_id,n.zone_id,a)}else n.connection_id||(n.region_id=null,n.zone_id=null)}),B(()=>n.connection_id,i=>{if(n.region_id=null,n.zone_id=null,n.meter_id=null,i){const a=v.connections.find(u=>u.id===i);a&&(n.region_id=a.region_id,n.zone_id=a.zone_id,n.meter_id=a.meter_id)}});const le=C(()=>{const i=new Set(v.keypads.data.map(a=>a.meter_id).filter(a=>a!=null));return v.meters.filter(a=>{const u=!i.has(a.id),t=S.value&&n.meter_id===a.id;return u||t})});C(()=>n.connection_id?v.connections.find(i=>i.id===n.connection_id):null);const V=g(null),Ve=i=>{V.value===i?V.value=null:V.value=i};return(i,a)=>{const u=Ce;return d(),m(K,null,[r(Ae,null,{default:c(()=>[r(e(Ue),{title:e(l)("keypads.title")},null,8,["title"]),s("div",qe,[s("div",Qe,[s("div",Ze,[Ge,s("div",null,[s("h1",{class:"text-2xl font-black tracking-tighter text-slate-900 uppercase",innerHTML:e(l)("keypads.titleHtml")},null,8,Je),s("p",Xe,o(e(l)("keypads.subtitle")),1)])]),s("div",Ye,[w.value.length>0?(d(),m("div",Pe,[r(e(f),{label:e(l)("keypads.actions.transfer")+` (${w.value.length})`,icon:"pi pi-arrows-h",severity:"info",onClick:e(he),class:"rounded-xl px-4"},null,8,["label","onClick"]),r(e(f),{label:e(l)("keypads.actions.delete")+` (${w.value.length})`,icon:"pi pi-trash",severity:"danger",onClick:_e,class:"rounded-xl px-4"},null,8,["label"])])):_("",!0),s("div",et,[r(e(f),{label:e(l)("keypads.actions.add"),icon:"pi pi-plus",severity:"primary",raised:"",onClick:ue,class:"rounded-xl px-6"},null,8,["label"])])])]),s("div",tt,[s("div",st,[lt,s("div",null,[s("div",at,o(U.value.total),1),s("div",ot,o(e(l)("keypads.stats.total")),1)])]),s("div",nt,[it,s("div",null,[s("div",rt,o(U.value.installed),1),s("div",dt,o(e(l)("keypads.stats.installed")),1)])]),s("div",ct,[ut,s("div",null,[s("div",pt,o(U.value.faulty),1),s("div",mt,o(e(l)("keypads.stats.faulty")),1)])]),s("div",_t,[ft,s("div",null,[s("div",xt,o(U.value.available),1),s("div",bt,o(e(l)("keypads.stats.available")),1)])])]),s("div",ht,[s("div",yt,[s("h3",vt,o(e(l)("keypads.stats.stock_by_region")),1),X.value.length>0?(d(),m("div",gt,[(d(!0),m(K,null,q(X.value,t=>(d(),m("div",{key:t.name,onClick:p=>Ve(t.name),class:je(["p-4 bg-white rounded-xl border-2 shadow-sm flex items-center gap-4 cursor-pointer transition-all duration-300",V.value===t.name?"border-primary-500 ring-4 ring-primary-100":"border-slate-200 hover:border-primary-300"])},[wt,s("div",null,[s("div",Vt,o(t.count),1),s("div",Ct,o(t.name),1)])],10,kt))),128))])):(d(),m("div",Tt,o(e(l)("keypads.messages.no_stock")),1)),V.value&&Y.value.length>0?(d(),m("div",St,[s("div",zt,[s("h3",$t,[Fe(o(e(l)("keypads.stats.stock_detail_for"))+" ",1),s("span",Ut,o(V.value),1)]),M(r(e(f),{icon:"pi pi-times",text:"",rounded:"",severity:"secondary",onClick:a[0]||(a[0]=t=>V.value=null)},null,512),[[u,e(l)("keypads.actions.close_details"),void 0,{bottom:!0}]])]),s("div",jt,[(d(!0),m(K,null,q(Y.value,t=>(d(),m("div",{key:t.name,class:"p-3 bg-white rounded-lg border border-primary-100 shadow-sm flex items-center gap-3"},[Ft,s("div",null,[s("div",Dt,o(t.count),1),s("div",At,o(t.name),1)])]))),128))])])):_("",!0)]),s("div",Lt,[s("h3",Nt,o(e(l)("keypads.stats.distribution_by_status")),1),s("div",Rt,[r(e(We),{type:"doughnut",data:de.value,options:ce.value,class:"w-full md:w-48"},null,8,["data","options"])])])]),s("div",Et,[r(e(Re),{ref_key:"dt",ref:Z,value:we.value,filters:N.value,"onUpdate:filters":a[4]||(a[4]=t=>N.value=t),selection:w.value,"onUpdate:selection":a[5]||(a[5]=t=>w.value=t),dataKey:"id",paginator:!0,rows:15,filterDisplay:"menu",globalFilterFields:["serial_number","model","manufacturer","type","status","connection_full_name","meter_serial_number"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:e(l)("keypads.table.report"),class:"ultimate-table"},{header:c(()=>[s("div",It,[r(e(Ke),{iconPosition:"left"},{default:c(()=>[r(e(Me),{class:"pi pi-search text-primary-500"}),r(e(j),{modelValue:N.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>N.value.global.value=t),placeholder:e(l)("keypads.table.search_placeholder"),class:"w-full md:w-96 rounded-2xl border-none bg-slate-100"},null,8,["modelValue","placeholder"])]),_:1}),s("div",Kt,[M(r(e(f),{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:J,class:"rounded-xl"},null,512),[[u,e(l)("common.resetFilters"),void 0,{bottom:!0}]]),M(r(e(f),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:a[2]||(a[2]=t=>Z.value.exportCSV())},null,512),[[u,e(l)("common.exportCSV"),void 0,{bottom:!0}]]),M(r(e(f),{icon:"pi pi-cog",text:"",rounded:"",severity:"secondary",onClick:a[3]||(a[3]=t=>G.value.toggle(t))},null,512),[[u,e(l)("common.selectColumns"),void 0,{bottom:!0}]])])])]),default:c(()=>[r(e(y),{selectionMode:"multiple",headerStyle:"width: 3rem",frozen:""}),x.value.includes("serial_number")?(d(),h(e(y),{key:0,field:"serial_number",header:e(l)("keypads.table.serial_number"),sortable:"",filterField:"serial_number",frozen:"",class:"min-w-[250px]"},{body:c(({data:t})=>[s("div",Mt,[Ot,s("div",Ht,[s("a",{href:"#",onClick:De(p=>se(t),["prevent"]),class:"font-black text-slate-800 leading-none mb-1 hover:text-primary-600 hover:underline"},o(t.serial_number),9,Bt),s("span",Wt,o(t.manufacturer)+" - "+o(t.model),1)])])]),filter:c(({filterModel:t})=>[r(e(j),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,type:"text",class:"p-column-filter",placeholder:e(l)("keypads.filter.by_serial")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):_("",!0),x.value.includes("status")?(d(),h(e(y),{key:1,field:"status",header:e(l)("keypads.table.status"),sortable:"",filterField:"status"},{body:c(({data:t})=>[r(e(E),{value:t.status,severity:te(t.status),class:"rounded-lg px-3 font-black text-[10px] uppercase"},null,8,["value","severity"])]),filter:c(({filterModel:t})=>[r(e(T),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,options:ee.value,placeholder:e(l)("keypads.filter.by_status"),class:"w-full",showClear:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"])):_("",!0),x.value.includes("type")?(d(),h(e(y),{key:2,field:"type",header:e(l)("keypads.table.type"),sortable:"",filterField:"type"},{body:c(({data:t})=>[r(e(E),{value:t.type,class:"rounded-lg px-3 font-black text-[10px] uppercase border-none"},null,8,["value"])]),filter:c(({filterModel:t})=>[r(e(T),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,options:P.value,placeholder:e(l)("keypads.filter.by_type"),class:"w-full",showClear:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"])):_("",!0),x.value.includes("connection_full_name")?(d(),h(e(y),{key:3,field:"connection_full_name",header:e(l)("keypads.table.connection_full_name"),sortable:"",filterField:"connection.full_name"},{body:c(({data:t})=>[t.connection?(d(),m("a",{key:0,href:i.route("connections.show",t.connection.id),class:"flex items-center gap-2 group"},[Qt,s("span",Zt,o(t.connection_full_name),1)],8,qt)):(d(),m("span",Gt,o(e(l)("keypads.table.unassigned")),1))]),filter:c(({filterModel:t})=>[r(e(j),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,type:"text",class:"p-column-filter",placeholder:e(l)("keypads.filter.by_client")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):_("",!0),x.value.includes("meter_serial_number")?(d(),h(e(y),{key:4,field:"meter_serial_number",header:e(l)("keypads.table.meter_serial_number"),sortable:"",filterField:"meter.serial_number"},{body:c(({data:t})=>[t.meter?(d(),m("a",{key:0,href:i.route("meters.index",{global:t.meter.serial_number}),class:"flex items-center gap-2 group"},[Xt,s("span",Yt,o(t.meter_serial_number),1)],8,Jt)):(d(),m("span",Pt,o(e(l)("keypads.table.unassigned")),1))]),filter:c(({filterModel:t})=>[r(e(j),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,type:"text",class:"p-column-filter",placeholder:e(l)("keypads.filter.by_meter")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):_("",!0),x.value.includes("installation_date")?(d(),h(e(y),{key:5,field:"installation_date",header:e(l)("keypads.table.installation_date"),sortable:"",filterField:"installation_date",dataType:"date"},{body:c(({data:t})=>[s("span",es,o(t.installation_date?new Date(t.installation_date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):e(l)("common.notApplicableShort")),1)]),filter:c(({filterModel:t})=>[r(e(ie),{modelValue:t.value,"onUpdate:modelValue":p=>t.value=p,dateFormat:"dd/mm/yy",placeholder:e(l)("common.date_format_placeholder"),mask:"99/99/9999"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"])):_("",!0),x.value.includes("region_name")?(d(),h(e(y),{key:6,field:"region_name",header:e(l)("keypads.table.region_name"),sortable:""},{body:c(({data:t})=>[s("span",ts,o(t.region_name),1)]),_:1},8,["header"])):_("",!0),x.value.includes("zone_name")?(d(),h(e(y),{key:7,field:"zone_name",header:e(l)("keypads.table.zone_name"),sortable:""},{body:c(({data:t})=>[s("span",ss,o(t.zone_name),1)]),_:1},8,["header"])):_("",!0),x.value.includes("model")?(d(),h(e(y),{key:8,field:"model",header:e(l)("keypads.table.model")},{body:c(({data:t})=>[s("span",ls,o(t.model||"N/A"),1)]),_:1},8,["header"])):_("",!0),x.value.includes("manufacturer")?(d(),h(e(y),{key:9,field:"manufacturer",header:e(l)("keypads.table.manufacturer")},{body:c(({data:t})=>[s("span",as,o(t.manufacturer||"N/A"),1)]),_:1},8,["header"])):_("",!0),x.value.includes("notes")?(d(),h(e(y),{key:10,field:"notes",header:e(l)("keypads.table.notes"),class:"min-w-[250px]"},{body:c(({data:t})=>[s("p",{class:"text-xs text-slate-500 truncate",title:t.notes},o(t.notes||e(l)("common.notApplicableShort")),9,os)]),_:1},8,["header"])):_("",!0),r(e(y),{header:e(l)("common.actions"),alignFrozen:"right",frozen:""},{body:c(({data:t})=>[s("div",ns,[r(e(f),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:p=>se(t)},null,8,["onClick"]),r(e(f),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:p=>me(t)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","filters","selection","currentPageReportTemplate"])]),r(e(He),{ref_key:"op",ref:G,appendTo:"body",id:"column_op",class:"p-4"},{default:c(()=>[s("h4",is,o(e(l)("common.customize_columns")),1),r(e(Be),{modelValue:x.value,"onUpdate:modelValue":a[6]||(a[6]=t=>x.value=t),options:re.value,optionLabel:"header",optionValue:"field",placeholder:e(l)("common.selectColumns"),display:"chip",class:"w-full max-w-xs"},null,8,["modelValue","options","placeholder"])]),_:1},512)]),r(e(ne),{visible:$.value,"onUpdate:visible":a[20]||(a[20]=t=>$.value=t),modal:"",header:!1,closable:!1,style:{width:"95vw",maxWidth:"650px"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:c(()=>[s("div",ll,[r(e(f),{label:e(l)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[19]||(a[19]=t=>$.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},{loadingicon:c(t=>[]),_:1},8,["label"]),r(e(f),{label:S.value?e(l)("common.update"):e(l)("common.save"),icon:"pi pi-check-circle",severity:"indigo",onClick:pe,loading:e(n).processing,class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs"},null,8,["label","loading"])])]),default:c(()=>[s("div",null,[s("div",rs,[s("div",ds,[cs,s("div",us,[s("h2",ps,o(S.value?e(l)("keypads.dialog.editTitle"):e(l)("keypads.dialog.createTitle")),1),s("span",ms,o(e(l)("keypads.dialog.subtitle")),1)])]),r(e(f),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[7]||(a[7]=t=>$.value=!1),class:"text-white hover:bg-white/10"})]),s("div",_s,[s("div",fs,[s("div",xs,[s("label",bs,o(e(l)("keypads.form.serial_number")),1),r(e(j),{modelValue:e(n).serial_number,"onUpdate:modelValue":a[8]||(a[8]=t=>e(n).serial_number=t),class:"w-full",placeholder:e(l)("keypads.form.serial_number_placeholder"),invalid:e(n).errors.serial_number},null,8,["modelValue","placeholder","invalid"])]),s("div",hs,[s("label",ys,o(e(l)("keypads.form.manufacturer")),1),r(e(j),{modelValue:e(n).manufacturer,"onUpdate:modelValue":a[9]||(a[9]=t=>e(n).manufacturer=t),class:"w-full",placeholder:e(l)("keypads.form.manufacturer_placeholder")},null,8,["modelValue","placeholder"])]),s("div",vs,[s("label",gs,o(e(l)("keypads.form.model")),1),r(e(j),{modelValue:e(n).model,"onUpdate:modelValue":a[10]||(a[10]=t=>e(n).model=t),class:"w-full",placeholder:e(l)("keypads.form.model_placeholder")},null,8,["modelValue","placeholder"])]),s("div",ks,[s("label",ws,o(e(l)("keypads.form.type")),1),r(e(T),{modelValue:e(n).type,"onUpdate:modelValue":a[11]||(a[11]=t=>e(n).type=t),options:P.value,class:"w-full",placeholder:e(l)("keypads.form.type_placeholder")},null,8,["modelValue","options","placeholder"])]),s("div",Vs,[s("label",Cs,o(e(l)("keypads.form.status")),1),r(e(T),{modelValue:e(n).status,"onUpdate:modelValue":a[12]||(a[12]=t=>e(n).status=t),options:ee.value,class:"w-full",placeholder:e(l)("keypads.form.status_placeholder")},null,8,["modelValue","options","placeholder"])]),s("div",Ts,[s("label",Ss,o(e(l)("keypads.form.connection")),1),r(e(T),{modelValue:e(n).connection_id,"onUpdate:modelValue":a[13]||(a[13]=t=>e(n).connection_id=t),options:k.connections,optionValue:"id",filter:"",class:"w-full shadow-sm border-slate-200",placeholder:e(l)("keypads.form.connection_placeholder"),showClear:"","filter-fields":["full_name","first_name","last_name","customer_code"]},{value:c(t=>{var p,b,F;return[t.value?(d(),m("div",zs,[s("div",$s,[s("span",Us,o((p=k.connections.find(D=>D.id===t.value))==null?void 0:p.full_name),1),s("span",js,o((b=k.connections.find(D=>D.id===t.value))==null?void 0:b.customer_code),1),(F=k.connections.find(D=>D.id===t.value))!=null&&F.keypad_id?(d(),m("i",Fs)):_("",!0)])])):(d(),m("span",Ds,o(t.placeholder),1))]}),option:c(t=>[s("div",As,[s("div",Ls,[s("span",Ns,o(t.option.full_name),1),s("div",Rs,[s("span",Es,o(t.option.customer_code),1)])]),s("div",Is,[t.option.zone?(d(),h(e(E),{key:0,value:t.option.zone,severity:"secondary",class:"text-[8px] px-1 h-3.5"},null,8,["value"])):_("",!0),t.option.keypad_id?(d(),h(e(E),{key:1,value:e(l)("keypads.form.has_keypad"),severity:"warning",class:"text-[8px] px-1 h-3.5"},null,8,["value"])):_("",!0)])])]),footer:c(()=>[s("div",Ks,o(k.connections.length)+" "+o(e(l)("connections.headTitle").toLowerCase()),1)]),_:1},8,["modelValue","options","placeholder"])]),s("div",Ms,[s("label",Os,o(e(l)("keypads.form.meter")),1),r(e(T),{modelValue:e(n).meter_id,"onUpdate:modelValue":a[14]||(a[14]=t=>e(n).meter_id=t),options:le.value,optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.meter_placeholder"),showClear:""},{value:c(t=>{var p;return[t.value?(d(),m("div",Hs,o((p=le.value.find(b=>b.id===t.value))==null?void 0:p.serial_number),1)):(d(),m("span",Bs,o(t.placeholder),1))]}),option:c(t=>[s("div",Ws,[s("span",qs,o(t.option.serial_number),1),t.option.connection?(d(),m("div",Qs,[Zs,s("span",null,o(t.option.connection.full_name),1)])):_("",!0)])]),_:1},8,["modelValue","options","placeholder"])]),s("div",Gs,[s("label",Js,o(e(l)("keypads.form.installation_date")),1),r(e(ie),{modelValue:e(n).installation_date,"onUpdate:modelValue":a[15]||(a[15]=t=>e(n).installation_date=t),dateFormat:"dd/mm/yy",showIcon:"",iconDisplay:"input",class:"w-full",placeholder:e(l)("common.date_format_placeholder")},null,8,["modelValue","placeholder"])]),s("div",Xs,[s("label",Ys,o(e(l)("keypads.form.region")),1),r(e(T),{modelValue:e(n).region_id,"onUpdate:modelValue":a[16]||(a[16]=t=>e(n).region_id=t),options:k.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.region_placeholder"),disabled:!!e(n).meter_id},null,8,["modelValue","options","placeholder","disabled"])]),s("div",Ps,[s("label",el,o(e(l)("keypads.form.zone")),1),r(e(T),{modelValue:e(n).zone_id,"onUpdate:modelValue":a[17]||(a[17]=t=>e(n).zone_id=t),options:H.value,optionLabel:"nomenclature",optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.zone_placeholder"),disabled:!!e(n).meter_id||!e(n).region_id||H.value.length===0},null,8,["modelValue","options","placeholder","disabled"])]),s("div",tl,[s("label",sl,o(e(l)("keypads.form.notes")),1),r(e(Oe),{modelValue:e(n).notes,"onUpdate:modelValue":a[18]||(a[18]=t=>e(n).notes=t),rows:"3",class:"w-full",placeholder:e(l)("keypads.form.notes_placeholder")},null,8,["modelValue","placeholder"])])])])])]),_:1},8,["visible"]),r(e(Ee),{position:"bottom-right"}),r(e(Ie))]),_:1}),r(e(ne),{visible:e(R),"onUpdate:visible":a[26]||(a[26]=t=>ae(R)?R.value=t:null),modal:"",header:!1,closable:!1,style:{width:"95vw",maxWidth:"600px"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:c(()=>[s("div",$l,[r(e(f),{label:e(l)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[25]||(a[25]=t=>R.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),r(e(f),{label:e(l)("keypads.actions.confirm_transfer"),icon:"pi pi-check-circle",onClick:e(ye),loading:e(z).processing,class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",disabled:e(I).length===0},null,8,["label","onClick","loading","disabled"])])]),default:c(()=>[s("div",al,[s("div",ol,[nl,s("div",il,[s("h2",rl,o(e(l)("keypads.dialog.transfer_title")),1),dl])]),r(e(f),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[21]||(a[21]=t=>R.value=!1),class:"text-white hover:bg-white/10"})]),s("div",cl,[s("div",ul,[s("label",pl,o(e(l)("keypads.dialog.destination_region")),1),r(e(T),{modelValue:e(z).region_id,"onUpdate:modelValue":a[22]||(a[22]=t=>e(z).region_id=t),options:k.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full",placeholder:e(l)("keypads.form.region_placeholder"),invalid:e(z).errors.region_id},null,8,["modelValue","options","placeholder","invalid"]),e(z).errors.region_id?(d(),m("small",ml,o(e(z).errors.region_id),1)):_("",!0)]),s("div",_l,[s("label",fl,o(e(l)("keypads.dialog.add_by_serial")),1),r(e(Ne),{modelValue:e(O),"onUpdate:modelValue":a[23]||(a[23]=t=>ae(O)?O.value=t:null),suggestions:e(be),onComplete:a[24]||(a[24]=t=>e(ve)(t)),onItemSelect:e(ge),field:"serial_number",placeholder:"Rechercher et ajouter un clavier disponible...",class:"w-full",inputClass:"p-inputtext-lg"},{option:c(t=>{var p,b;return[s("div",xl,[s("div",bl,[s("span",hl,o(t.option.serial_number),1),s("div",yl,[vl,s("span",gl,o(((p=t.option.region)==null?void 0:p.designation)||e(l)("common.notApplicable")),1),kl,s("span",wl,o(e(z).region_id?(b=k.regions.find(F=>F.id===e(z).region_id))==null?void 0:b.designation:"..."),1)])]),s("div",null,[r(e(E),{value:e(l)(`keypads.status.${t.option.status}`),severity:te(t.option.status)},null,8,["value","severity"])])])]}),_:1},8,["modelValue","suggestions","onItemSelect"])]),s("div",Vl,[s("h4",Cl,o(e(l)("keypads.dialog.to_transfer_count",{count:e(I).length})),1),s("div",Tl,[(d(!0),m(K,null,q(e(I),t=>(d(),m("div",{key:t.id,class:"flex items-center justify-between bg-white p-2 rounded-lg border border-slate-200"},[s("span",Sl,o(t.serial_number),1),r(e(f),{icon:"pi pi-times",text:"",rounded:"",severity:"danger",onClick:p=>e(ke)(t.id),class:"w-6 h-6"},null,8,["onClick"])]))),128)),e(I).length===0?(d(),m("div",zl,o(e(l)("keypads.messages.no_keypad_selected")),1)):_("",!0)])])])]),_:1},8,["visible"])],64)}}};export{la as default};
