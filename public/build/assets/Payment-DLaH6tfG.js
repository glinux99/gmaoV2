import{a as K,b as Q,r as y,u as W,ad as Z,T as G,d as S,F as p,c as D,e as J,f as r,o as g,i as s,g as e,Z as X,j as l,t as c,l as $,n as Y,m as ee,k as te,p as le,h as ae}from"./app-gDNqx2_D.js";import{_ as se}from"./AppLayout-SGD7JHFV.js";import{s as u}from"./index-BFXGy4uN.js";import{s as oe}from"./index-DnMOyY1I.js";import{s as v,a as ne}from"./index-C2t85Ev4.js";import{s as ie}from"./index-bSGFH6Vt.js";import{s as w}from"./index-qtJx-Jx6.js";import{s as de}from"./index-DWMCXZ5G.js";import{s as I}from"./index-CadKbAM9.js";import{s as re}from"./index-psDJnd0s.js";import{s as pe}from"./index-D4DTux10.js";import{s as ce}from"./index-BHExvObj.js";import{a as ue,s as me}from"./index-3Y3FmX7C.js";import{s as ye}from"./index-DNoI7EM0.js";import{s as fe}from"./index-5fxx7ZJm.js";import{s as be}from"./index-tkdp3lW-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DIW2SyDI.js";import"./index-E0OnojZQ.js";import"./index-Sf75UUsw.js";import"./index-qcYzN5_Q.js";import"./index-Dqyvdu4C.js";import"./index-C57fO0mp.js";import"./index-CaNPRaEQ.js";const ve={class:"min-h-screen bg-slate-50/50 p-4 lg:p-8"},xe={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8"},_e={class:"flex items-center gap-4"},he=l("div",{class:"flex h-16 w-16 items-center justify-center rounded-[2rem] bg-primary-600 shadow-xl shadow-primary-200"},[l("i",{class:"pi pi-wallet text-2xl text-white"})],-1),ge={class:"text-3xl font-black text-slate-900 tracking-tight"},we={class:"text-slate-500 font-medium"},Ve={class:"flex gap-3"},ke={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Se={class:"flex flex-column gap-2"},$e={class:"text-xs font-black text-slate-400 uppercase tracking-widest"},Ue={class:"flex items-center justify-between"},Ce={class:"text-3xl font-black text-slate-800"},Ne=l("div",{class:"w-10 h-10 rounded-2xl bg-slate-50 flex items-center justify-center"},[l("i",{class:"pi pi-wallet text-slate-400"})],-1),Te={class:"bg-white rounded-[2rem] shadow-xl border border-slate-200 overflow-hidden"},Ae={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},Fe={class:"flex items-center gap-2"},Me={class:"font-black text-slate-800"},De=l("small",null,"USD",-1),Ie={class:"flex items-center gap-3"},je={class:"flex flex-col"},Le={class:"font-bold text-slate-700 text-sm"},Pe={class:"text-slate-400 text-[10px] uppercase font-bold"},Be={class:"flex flex-col gap-2 p-3"},Oe={class:"text-slate-500 font-medium text-sm"},Ee={class:"px-3 pt-2 pb-4"},ze={class:"flex justify-end gap-1"},Re={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50 rounded-xl"},qe=l("div",{class:"flex items-center gap-4"},[l("div",{class:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary-200"},[l("i",{class:"pi pi-dollar text-xl"})]),l("div",null,[l("h4",{class:"font-black text-slate-100 m-0"},"Paramètres financiers"),l("p",{class:"text-xs text-slate-500 m-0"},"Veuillez renseigner les détails du mouvement de fonds")])],-1),He={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth"},Ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Qe={class:"flex flex-col gap-2"},We=l("label",{class:"text-xs font-black text-slate-500 uppercase"},"Montant (USD)",-1),Ze={key:0,class:"text-red-500 font-bold text-[10px]"},Ge={class:"flex flex-col gap-2"},Je=l("label",{class:"text-xs font-black text-slate-500 uppercase"},"Date de valeur",-1),Xe={class:"flex flex-col gap-2"},Ye=l("label",{class:"text-xs font-black text-slate-500 uppercase"},"Type Bénéficiaire",-1),et={class:"flex flex-col gap-2"},tt=l("label",{class:"text-xs font-black text-slate-500 uppercase"},"Bénéficiaire Spécifique",-1),lt={class:"md:col-span-2 flex flex-col gap-2"},at=l("label",{class:"text-xs font-black text-slate-500 uppercase"},"Notes & Références",-1),st={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},Nt={__name:"Payment",props:{payments:Object,filters:Object,users:Array,employees:Array,suppliers:Array,payables:Array},setup(U){var M;const f=U,C=K(),j=Q(),N=y(),m=y(!1),{t:o}=W(),V=y(!1),x=y(!1),h=y(!1),T=y(null),{user:b}=Z().props.auth,i=G({id:null,amount:null,payment_date:new Date,payment_method:"bank_transfer",reference:"",notes:"",status:"completed",paid_by:b==null?void 0:b.id,payable_type:null,payable_id:null,category:"salary"}),L=S(()=>{const n=f.payments.data||[],a=n.reduce((t,d)=>t+(parseFloat(d.amount)||0),0);return{totalFlux:a.toLocaleString("fr-FR")+" USD",transactions:n.length,pending:n.filter(t=>t.status==="pending").length,average:n.length>0?(a/n.length).toFixed(0):0}}),_=y({global:{value:((M=f.filters)==null?void 0:M.search)||null,matchMode:p.CONTAINS},status:{value:null,matchMode:p.IN},category:{value:null,matchMode:p.IN},payment_method:{value:null,matchMode:p.IN},payment_date:{operator:D.AND,constraints:[{value:null,matchMode:p.DATE_IS}]}}),P=()=>{_.value={global:{value:null,matchMode:p.CONTAINS},status:{value:null,matchMode:p.IN},category:{value:null,matchMode:p.IN},payment_method:{value:null,matchMode:p.IN},payment_date:{operator:D.AND,constraints:[{value:null,matchMode:p.DATE_IS}]}}},A=[{label:o("payments.payableTypes.employee"),value:"App\\Models\\Employee",icon:"pi pi-user"},{label:o("payments.payableTypes.supplier"),value:"App\\Models\\Supplier",icon:"pi pi-truck"},{label:o("payments.payableTypes.user"),value:"App\\Models\\User",icon:"pi pi-id-card"}],F=S(()=>{if(!i.payable_type)return[];switch(i.payable_type){case"App\\Models\\Employee":return f.employees;case"App\\Models\\Supplier":return f.suppliers;case"App\\Models\\User":return f.users;default:return[]}}),B=()=>{i.reset(),i.payment_date=new Date,i.paid_by=b==null?void 0:b.id,x.value=!1,i.payable_type=null,V.value=!1,m.value=!0},O=n=>{i.clearErrors(),Object.assign(i,{...n,payment_date:n.payment_date?new Date(n.payment_date):null,payable_type:n.payable_type,paid_by:n.paid_by.id}),x.value=!0,m.value=!0},E=()=>{if(V.value=!0,!i.amount||!i.payable_id)return;h.value=!0;const n=x.value?route("payroll.update",i.id):route("payroll.store");i.transform(a=>({...a,payment_date:a.payment_date?a.payment_date.toISOString().split("T")[0]:null})).submit(x.value?"put":"post",n,{onSuccess:()=>{m.value=!1,C.add({severity:"success",summary:o("common.success"),detail:o("payments.toast.saved"),life:3e3}),h.value=!1},onError:()=>{h.value=!1}})},z=n=>{j.require({message:o("payments.toast.deleteConfirmation",{amount:n.amount.toLocaleString(),beneficiary:k(n.payable_type,n.payable_id)}),header:o("common.attention"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{ae.delete(route("payments.destroy",n.id),{onSuccess:()=>C.add({severity:"info",summary:o("common.info"),detail:o("payments.toast.deleted"),life:3e3})})}})},R=n=>({pending:"warning",completed:"success",failed:"danger"})[n]||"info",q=S(()=>[{label:o("payments.statusTypes.pending"),value:"pending"},{label:o("payments.statusTypes.completed"),value:"completed"},{label:o("payments.statusTypes.failed"),value:"failed"}]),k=(n,a)=>{const t=f.payables.find(d=>d.type===n&&d.id===a);return t?t.name:"N/A"},H=(n,a)=>{const t=k(n,a);return t&&t!=="N/A"?t.charAt(0).toUpperCase():"?"};return(n,a)=>(g(),J(se,null,{default:r(()=>[s(e(X),{title:e(o)("payments.title")},null,8,["title"]),l("div",ve,[l("div",xe,[l("div",_e,[he,l("div",null,[l("h1",ge,c(e(o)("payments.title")),1),l("p",we,c(e(o)("payments.subtitle")),1)])]),l("div",Ve,[s(e(u),{label:e(o)("payments.newTransaction"),icon:"pi pi-plus",raised:"",onClick:B,class:"rounded-xl px-6"},null,8,["label"]),s(e(u),{label:e(o)("common.resetFilters"),icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:P,class:"rounded-xl"},null,8,["label"])])]),l("div",ke,[(g(!0),$(ee,null,Y(L.value,(t,d)=>(g(),$("div",{key:d,class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all"},[l("div",Se,[l("span",$e,c(e(o)(`payments.stats.${d}`)),1),l("div",Ue,[l("span",Ce,c(t),1),Ne])])]))),128))]),l("div",Te,[s(e(ne),{ref_key:"dt",ref:N,value:U.payments.data,selection:T.value,"onUpdate:selection":a[2]||(a[2]=t=>T.value=t),filters:_.value,"onUpdate:filters":a[3]||(a[3]=t=>_.value=t),dataKey:"id",paginator:!0,rows:10,filterDisplay:"menu",class:"p-datatable-custom",removableSort:""},{header:r(()=>[l("div",Ae,[s(e(ue),{iconPosition:"left"},{default:r(()=>[s(e(me),{class:"pi pi-search"}),s(e(oe),{modelValue:_.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=t=>_.value.global.value=t),placeholder:e(o)("common.search"),class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue","placeholder"])]),_:1}),l("div",Fe,[s(e(u),{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:a[1]||(a[1]=t=>N.value.exportCSV())})])])]),default:r(()=>[s(e(v),{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(e(v),{field:"amount",header:e(o)("payments.table.amount"),sortable:""},{body:r(({data:t})=>[l("span",Me,[te(c(t.amount.toLocaleString())+" ",1),De])]),_:1},8,["header"]),s(e(v),{field:"payable_name",header:e(o)("payments.table.beneficiary")},{body:r(({data:t})=>[l("div",Ie,[s(e(ye),{label:H(t.payable_type,t.payable_id),shape:"circle",class:"bg-slate-100 text-slate-600 font-bold"},null,8,["label"]),l("div",je,[l("span",Le,c(k(t.payable_type,t.payable_id)),1),l("small",Pe,c(e(o)(`payments.payableTypes.${t.payable_type.split("\\").pop().toLowerCase()}`)),1)])])]),filter:r(({filterModel:t})=>[l("div",Be,[s(e(w),{modelValue:t.payable_type.value,"onUpdate:modelValue":d=>t.payable_type.value=d,options:A,optionLabel:"label",optionValue:"value",placeholder:"Type Bénéficiaire",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),s(e(w),{modelValue:t.payable_id.value,"onUpdate:modelValue":d=>t.payable_id.value=d,options:F.value,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Bénéficiaire",class:"w-full",disabled:!t.payable_type.value},null,8,["modelValue","onUpdate:modelValue","options","disabled"])])]),_:1},8,["header"]),s(e(v),{field:"status",header:e(o)("payments.table.status"),sortable:"",filterField:"status",showFilterMatchModes:!1},{body:r(({data:t})=>[s(e(ce),{value:e(o)(`payments.statusTypes.${t.status}`),severity:R(t.status),class:"rounded-lg px-3 text-[10px] uppercase"},null,8,["value","severity"])]),filter:r(({filterModel:t})=>[s(e(fe),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,options:q.value,optionLabel:"label",optionValue:"value",placeholder:e(o)("common.total",{item:""}),class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"]),s(e(v),{field:"payment_date",header:e(o)("payments.table.date"),sortable:"",filterField:"payment_date",dataType:"date"},{body:r(({data:t})=>[l("span",Oe,c(new Date(t.payment_date).toLocaleDateString("fr-FR")),1)]),filter:r(({filterModel:t})=>[l("div",Ee,[s(e(I),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,selectionMode:"range",manualInput:!1},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["header"]),s(e(v),{header:e(o)("payments.table.actions"),alignFrozen:"right",frozen:""},{body:r(({data:t})=>[l("div",ze,[s(e(u),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:d=>O(t)},null,8,["onClick"]),s(e(u),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:d=>z(t)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","selection","filters"])])]),s(e(ie),{visible:m.value,"onUpdate:visible":a[11]||(a[11]=t=>m.value=t),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"700px"},contentStyle:{maxHeight:"80vh",overflow:"auto"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:r(()=>[l("div",st,[s(e(u),{label:e(o)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[10]||(a[10]=t=>m.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),s(e(u),{label:x.value?e(o)("common.update"):e(o)("common.save"),icon:"pi pi-check-circle",severity:"indigo",class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs",onClick:E,loading:h.value},null,8,["label","loading"])])]),default:r(()=>[l("div",null,[l("div",Re,[qe,s(e(u),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[4]||(a[4]=t=>m.value=!1),class:"text-white hover:bg-white/10"})]),l("div",He,[l("div",Ke,[l("div",Qe,[We,s(e(de),{modelValue:e(i).amount,"onUpdate:modelValue":a[5]||(a[5]=t=>e(i).amount=t),mode:"decimal",class:"w-full",inputClass:"py-3.5 rounded-xl border-slate-200"},null,8,["modelValue"]),V.value&&!e(i).amount?(g(),$("small",Ze,"Requis")):le("",!0)]),l("div",Ge,[Je,s(e(I),{modelValue:e(i).payment_date,"onUpdate:modelValue":a[6]||(a[6]=t=>e(i).payment_date=t),dateFormat:"dd/mm/yy",showIcon:"",class:"w-full",inputClass:"py-3.5 rounded-xl border-slate-200"},null,8,["modelValue"])]),l("div",Xe,[Ye,s(e(w),{modelValue:e(i).payable_type,"onUpdate:modelValue":a[7]||(a[7]=t=>e(i).payable_type=t),options:A,optionLabel:"label",optionValue:"value",class:"rounded-xl border-slate-200 py-1"},null,8,["modelValue"])]),l("div",et,[tt,s(e(w),{modelValue:e(i).payable_id,"onUpdate:modelValue":a[8]||(a[8]=t=>e(i).payable_id=t),options:F.value,optionLabel:"name",optionValue:"id",filter:"",class:"rounded-xl border-slate-200 py-1",disabled:!e(i).payable_type},null,8,["modelValue","options","disabled"])]),l("div",lt,[at,s(e(be),{modelValue:e(i).notes,"onUpdate:modelValue":a[9]||(a[9]=t=>e(i).notes=t),rows:"3",class:"w-full p-4 rounded-2xl border border-slate-200 bg-slate-50 focus:bg-white transition-all text-sm outline-none"},null,8,["modelValue"])])])])])]),_:1},8,["visible"]),s(e(re),{position:"bottom-right"}),s(e(pe))]),_:1}))}};export{Nt as default};
