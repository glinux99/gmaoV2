import{T as ee}from"./index-BbFIc-qF.js";import{a as te,b as se,u as le,r as _,ad as ae,T as oe,d as k,F as V,e as C,f as c,o as p,i as o,g as e,Z as ie,j as l,t as n,l as v,n as M,m as N,s as $,U as I,q as A,p as q,h as z}from"./app-BRAmWWDK.js";import{_ as re}from"./AppLayout-DcYAlXcr.js";import{s as m}from"./index-BLI3-ZB5.js";import{s as ne}from"./index-BN5aQcOg.js";import{a as de,s as ce}from"./index-BvqM3u8T.js";import{s as f,a as pe}from"./index-6CLnIpjK.js";import{s as ue}from"./index-CsEuBKcf.js";import{s as j}from"./index-BeaEkU56.js";import{s as O}from"./index-B0W91G3B.js";import{s as me}from"./index-Ci1herNU.js";import{s as ve}from"./index-DZHXsoj_.js";import{s as fe}from"./index-CEA3Snwx.js";import{s as he}from"./index-Bodlqhch.js";import{s as xe}from"./index-CNGgL0Kp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-BJ7aGovM.js";import"./index-ClmdxtMW.js";import"./index-CDA2CSiu.js";import"./index-LMQAJ2bo.js";import"./index-RIg7_KOk.js";import"./index-DBlwtJFe.js";import"./index-CcU6oDqo.js";import"./index-D3aGqElX.js";import"./index-V1MWQ6Vd.js";import"./index-_AlfpTFN.js";const be={class:"p-4 lg:p-8 bg-[#F8FAFC] min-h-screen"},_e={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-10"},ge={class:"flex items-center gap-4"},ye=l("div",{class:"w-16 h-16 bg-primary-600 rounded-[2rem] flex items-center justify-center shadow-xl shadow-primary-200"},[l("i",{class:"pi pi-calendar text-white text-xl"})],-1),we={class:"text-3xl font-[900] text-slate-900 tracking-tight"},ke={class:"text-slate-500 font-medium"},Ve={class:"flex gap-3 bg-white p-2 rounded-2xl shadow-sm border border-slate-100"},Ce={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},$e={class:"flex flex-col gap-2"},je={class:"text-xs font-black text-slate-400 uppercase tracking-widest"},Fe={class:"flex items-center justify-between"},Le={class:"text-3xl font-black text-slate-800"},De=l("div",{class:"w-10 h-10 rounded-2xl bg-slate-50 flex items-center justify-center"},[l("i",{class:"pi pi-calendar-plus text-slate-400"})],-1),Se={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-200/60 overflow-hidden"},Ue={class:"flex flex-wrap justify-between items-center gap-4 p-2"},Te={class:"flex items-center gap-3"},Be={class:"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold text-slate-600"},Ee={class:"font-bold text-slate-700"},Me={class:"flex items-center gap-2"},Ne={class:"text-xs uppercase tracking-wider text-slate-500"},Ie={class:"flex flex-col text-sm"},Ae={class:"text-slate-700 font-semibold"},qe={class:"text-slate-400 text-xs font-medium"},ze={key:0,class:"text-sm text-slate-600"},Oe={key:1,class:"text-slate-400"},Pe={key:0,class:"font-semibold text-slate-700"},Re={key:1,class:"text-slate-400"},Ke={class:"flex gap-2 justify-end"},Qe={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50"},We={class:"flex items-center gap-4"},Ze=l("div",{class:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary-200"},[l("i",{class:"pi pi-calendar-plus text-xl"})],-1),Ge={class:"font-black text-slate-100 m-0"},He={class:"text-xs text-slate-500 m-0"},Je={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth space-y-6"},Xe={class:"flex flex-col gap-2"},Ye={class:"text-xs font-black text-slate-500 uppercase"},et={class:"grid grid-cols-2 gap-4"},tt={class:"flex flex-col gap-2"},st={class:"text-xs font-black text-slate-500 uppercase"},lt={class:"flex flex-col gap-2"},at={class:"text-xs font-black text-slate-500 uppercase"},ot={class:"flex flex-col gap-2"},it={class:"text-xs font-black text-slate-500 uppercase"},rt={class:"grid grid-cols-2 lg:grid-cols-4 gap-2"},nt=["onClick"],dt={class:"text-[10px] font-bold uppercase"},ct={class:"flex flex-col gap-2"},pt={class:"text-xs font-black text-slate-500 uppercase"},ut={class:"flex flex-col gap-2"},mt={class:"text-xs font-black text-slate-500 uppercase"},vt={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},zt={__name:"Leaves",props:{leaves:Object,filters:Object,users:Array},setup(g){var T;const F=g,x=te(),L=se(),{t:s}=le(),h=_(!1),b=_(!1),D=_(null),S=_(),{auth:P}=ae().props,r=oe({id:null,user_id:null,type:"annuel",start_date:null,end_date:null,reason:null,status:"pending",document_file:null,notes:null}),y=k(()=>[{label:s("leaves.types.annual"),value:"annuel",icon:"pi-sun",color:"#3B82F6"},{label:s("leaves.types.sick"),value:"maladie",icon:"pi-heart",color:"#EF4444"},{label:s("leaves.types.rtt"),value:"rtt",icon:"pi-clock",color:"#8B5CF6"},{label:s("leaves.types.exceptional"),value:"exceptionnel",icon:"pi-star",color:"#F59E0B"}]),R=k(()=>[{label:s("leaves.status.approved"),value:"approved"},{label:s("leaves.status.pending"),value:"pending"},{label:s("leaves.status.rejected"),value:"rejected"}]),w=_({global:{value:((T=F.filters)==null?void 0:T.search)||null,matchMode:V.CONTAINS},status:{value:null,matchMode:V.IN},type:{value:null,matchMode:V.IN}}),K=k(()=>{const i=F.leaves.data||[];return{total:i.length,pending:i.filter(a=>a.status==="pending").length,approved:i.filter(a=>a.status==="approved").length,rejected:i.filter(a=>a.status==="rejected").length}}),Q=i=>{switch(i){case"approved":return"success";case"pending":return"warning";case"rejected":return"danger";default:return"secondary"}},W=i=>{const a=y.value.find(u=>u.value===i);return["pi",a?a.icon:"pi-calendar"]},Z=i=>{const a=y.value.find(u=>u.value===i);return a?a.color:"#64748B"},G=()=>{var i;r.reset(),b.value=!1,r.user_id=(i=P.user)==null?void 0:i.id,r.start_date=new Date,r.end_date=new Date,h.value=!0},H=i=>{r.clearErrors(),Object.assign(r,{...i,start_date:new Date(i.start_date),end_date:new Date(i.end_date)}),b.value=!0,h.value=!0},J=()=>{const i=b.value?route("leaves.update",r.id):route("leaves.store"),a=b.value?"put":"post";r.transform(u=>({...u})).submit(a,i,{onSuccess:()=>{h.value=!1,x.add({severity:"success",summary:s("common.success"),detail:s("leaves.toast.success"),life:3e3}),r.reset()},onError:u=>{console.error("Erreur lors de la sauvegarde du congÃ©",u),x.add({severity:"error",summary:s("toast.error"),detail:s("toast.genericError"),life:3e3})}})},X=i=>{r.document_file=i.files[0]},Y=i=>{L.require({message:s("confirm.deleteConfirmation"),header:s("common.attention"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{z.delete(route("leaves.destroy",i.id),{onSuccess:()=>x.add({severity:"info",summary:s("common.info"),detail:s("common.delete"),life:3e3})})}})},U=(i,a)=>{L.require({message:s("leaves.confirm.statusChange",{status:s(`leaves.status.${a}`)}),header:s("common.attention"),icon:"pi pi-info-circle",acceptClass:a==="approved"?"p-button-success":"p-button-danger",acceptLabel:s("common.confirm"),rejectLabel:s("common.cancel"),accept:()=>{z.put(route("leaves.updateStatus",i.id),{status:a},{preserveScroll:!0,onSuccess:()=>x.add({severity:"success",summary:s("common.success"),detail:s("leaves.toast.statusUpdated"),life:3e3}),onError:()=>x.add({severity:"error",summary:s("toast.error"),detail:s("toast.genericError"),life:3e3})})}})};return(i,a)=>{const u=ee;return p(),C(re,null,{default:c(()=>{var B;return[o(e(ie),{title:e(s)("leaves.title")},null,8,["title"]),l("div",be,[l("div",_e,[l("div",ge,[ye,l("div",null,[l("h1",we,n(e(s)("leaves.title")),1),l("p",ke,n(e(s)("leaves.subtitle",{count:((B=g.leaves.data)==null?void 0:B.length)||0})),1)])]),l("div",Ve,[o(e(m),{icon:"pi pi-upload",text:"",severity:"secondary",onClick:a[0]||(a[0]=t=>S.value.exportCSV())}),o(e(m),{label:e(s)("leaves.newRequest"),icon:"pi pi-plus",raised:"",onClick:G,class:"rounded-lg font-bold"},null,8,["label"])])]),l("div",Ce,[(p(!0),v(N,null,M(K.value,(t,d)=>(p(),v("div",{key:d,class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all"},[l("div",$e,[l("span",je,n(e(s)(`leaves.stats.${d}`)),1),l("div",Fe,[l("span",Le,n(t),1),De])])]))),128))]),l("div",Se,[o(e(pe),{ref_key:"dt",ref:S,value:g.leaves.data,selection:D.value,"onUpdate:selection":a[2]||(a[2]=t=>D.value=t),filters:w.value,"onUpdate:filters":a[3]||(a[3]=t=>w.value=t),dataKey:"id",paginator:!0,rows:10,filterDisplay:"menu",class:"p-datatable-custom",removableSort:""},{header:c(()=>[l("div",Ue,[o(e(de),{iconPosition:"left"},{default:c(()=>[o(e(ce),{class:"pi pi-search text-slate-400"}),o(e(ne),{modelValue:w.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>w.value.global.value=t),placeholder:e(s)("common.search"),class:"w-full md:w-80 border-none bg-slate-50 rounded-xl"},null,8,["modelValue","placeholder"])]),_:1})])]),default:c(()=>[o(e(f),{selectionMode:"multiple",style:{width:"3rem"}}),o(e(f),{field:"user.name",header:e(s)("leaves.table.applicant"),sortable:""},{body:c(({data:t})=>{var d,E;return[l("div",Te,[l("div",Be,n((d=t.user)==null?void 0:d.name.charAt(0)),1),l("span",Ee,n((E=t.user)==null?void 0:E.name),1)])]}),_:1},8,["header"]),o(e(f),{field:"type",header:e(s)("leaves.table.type"),filterField:"type",showFilterMatchModes:!1},{body:c(({data:t})=>[l("div",Me,[l("i",{class:$(W(t.type)),style:I({color:Z(t.type)})},null,6),l("b",Ne,n(t.type),1)])]),filter:c(({filterModel:t})=>[o(e(j),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,options:y.value,optionLabel:"label",optionValue:"value",placeholder:e(s)("common.total",{item:""}),class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"]),o(e(f),{field:"start_date",header:e(s)("leaves.table.period"),style:{"min-width":"12rem"}},{body:c(({data:t})=>[l("div",Ie,[l("span",Ae,"Du "+n(new Date(t.start_date).toLocaleDateString()),1),l("span",qe,"Au "+n(new Date(t.end_date).toLocaleDateString()),1)])]),_:1},8,["header"]),o(e(f),{field:"status",header:e(s)("leaves.table.status"),filterField:"status",showFilterMatchModes:!1},{body:c(({data:t})=>[o(e(fe),{value:e(s)(`leaves.status.${t.status}`),severity:Q(t.status),class:"rounded-md font-bold text-[10px]"},null,8,["value","severity"])]),filter:c(({filterModel:t})=>[o(e(j),{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,options:R.value,optionLabel:"label",optionValue:"value",placeholder:e(s)("common.total",{item:""}),class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"]),o(e(f),{field:"approval_date",header:e(s)("leaves.table.approvalDate"),sortable:""},{body:c(({data:t})=>[t.approval_date?(p(),v("span",ze,n(new Date(t.approval_date).toLocaleDateString()),1)):(p(),v("span",Oe,"-"))]),_:1},8,["header"]),o(e(f),{field:"approvedBy.name",header:e(s)("leaves.table.approvedBy"),sortable:""},{body:c(({data:t})=>[t.approved_by?(p(),v("span",Pe,n(t.approved_by.name),1)):(p(),v("span",Re,"-"))]),_:1},8,["header"]),o(e(f),{header:"Actions",alignFrozen:"right",frozen:""},{body:c(({data:t})=>[l("div",Ke,[o(e(m),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:d=>H(t)},null,8,["onClick"]),t.status==="pending"?A((p(),C(e(m),{key:0,icon:"pi pi-check",text:"",rounded:"",severity:"success",onClick:d=>U(t,"approved")},null,8,["onClick"])),[[u,e(s)("common.approve"),void 0,{top:!0}]]):q("",!0),t.status==="pending"?A((p(),C(e(m),{key:1,icon:"pi pi-times",text:"",rounded:"",severity:"warning",onClick:d=>U(t,"rejected")},null,8,["onClick"])),[[u,e(s)("common.reject"),void 0,{top:!0}]]):q("",!0),o(e(m),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:d=>Y(t)},null,8,["onClick"])])]),_:1})]),_:1},8,["value","selection","filters"])])]),o(e(ue),{visible:h.value,"onUpdate:visible":a[10]||(a[10]=t=>h.value=t),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"600px"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{default:c(()=>[l("div",Qe,[l("div",We,[Ze,l("div",null,[l("h4",Ge,n(b.value?e(s)("leaves.dialog.editTitle"):e(s)("leaves.dialog.createTitle")),1),l("p",He,n(e(s)("leaves.dialog.headerSubtitle")),1)])]),o(e(m),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:a[4]||(a[4]=t=>h.value=!1),class:"text-white hover:bg-white/10"})]),l("div",Je,[l("div",Xe,[l("label",Ye,n(e(s)("leaves.dialog.applicant")),1),o(e(j),{modelValue:e(r).user_id,"onUpdate:modelValue":a[5]||(a[5]=t=>e(r).user_id=t),options:g.users,optionLabel:"name",optionValue:"id",placeholder:e(s)("leaves.dialog.applicantPlaceholder"),class:"v11-input w-full"},null,8,["modelValue","options","placeholder"])]),l("div",et,[l("div",tt,[l("label",st,n(e(s)("leaves.dialog.startDate")),1),o(e(O),{modelValue:e(r).start_date,"onUpdate:modelValue":a[6]||(a[6]=t=>e(r).start_date=t),dateFormat:"dd/mm/yy",showIcon:"",class:"v11-calendar"},null,8,["modelValue"])]),l("div",lt,[l("label",at,n(e(s)("leaves.dialog.endDate")),1),o(e(O),{modelValue:e(r).end_date,"onUpdate:modelValue":a[7]||(a[7]=t=>e(r).end_date=t),dateFormat:"dd/mm/yy",showIcon:"",class:"v11-calendar"},null,8,["modelValue"])])]),l("div",ot,[l("label",it,n(e(s)("leaves.dialog.leaveType")),1),l("div",rt,[(p(!0),v(N,null,M(y.value,t=>(p(),v("div",{key:t.value,onClick:d=>e(r).type=t.value,class:$(["p-3 border-2 rounded-xl cursor-pointer transition-all flex flex-col items-center gap-2",e(r).type===t.value?"border-primary-500 bg-primary-50":"border-slate-100 bg-white hover:border-slate-200"])},[l("i",{class:$(["pi",t.icon]),style:I({color:t.color})},null,6),l("span",dt,n(t.label),1)],10,nt))),128))])]),l("div",ct,[l("label",pt,n(e(s)("leaves.dialog.reason")),1),o(e(xe),{modelValue:e(r).reason,"onUpdate:modelValue":a[8]||(a[8]=t=>e(r).reason=t),rows:"3",class:"v11-input w-full",placeholder:e(s)("leaves.dialog.reasonPlaceholder")},null,8,["modelValue","placeholder"])]),l("div",ut,[l("label",mt,n(e(s)("leaves.dialog.attachment")),1),o(e(he),{mode:"basic",onSelect:X,auto:!0,chooseLabel:e(s)("leaves.dialog.attachmentChoose"),class:"v11-upload"},null,8,["chooseLabel"])])]),l("div",vt,[o(e(m),{label:e(s)("common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:a[9]||(a[9]=t=>h.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),o(e(m),{label:e(s)("leaves.dialog.sendRequest"),icon:"pi pi-check-circle",class:"px-10 h-14 rounded-2xl shadow-xl shadow-primary-100 font-black uppercase tracking-widest text-xs",onClick:J,loading:e(r).processing},null,8,["label","loading"])])]),_:1},8,["visible"]),o(e(me),{position:"bottom-right"}),o(e(ve))]}),_:1})}}};export{zt as default};
