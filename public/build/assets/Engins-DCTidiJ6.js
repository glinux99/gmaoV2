import{u as z,a as H,b as q,r as h,F as m,c as T,T as W,_ as Q,e as G,f as c,o as K,i as n,g as e,Z,j as o,t as u,U as C,s as J,h as X}from"./app-DlduAWKf.js";import{_ as Y}from"./AppLayout-D_JPO1-D.js";import{s as x}from"./index-CnzqN9d3.js";import{s as U}from"./index-a9PRqMaA.js";import{s as y,a as ee}from"./index-D91TOBxc.js";import{s as te}from"./index-B-_-q9gt.js";import{s as S}from"./index-CNkdB_e-.js";import{s as D}from"./index-C_kRDVS3.js";import{s as le}from"./index-8z2yMFcP.js";import{s as oe}from"./index-wymrxioL.js";import{a as se,s as ie}from"./index-BLVnNnMn.js";import{s as ne}from"./index-DbTmqpmk.js";import{s as ae}from"./index-D4BnT4fz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DF0J99-Y.js";import"./index-C9R50wYM.js";import"./index-Ch-n-CSZ.js";import"./index-BQ2NgWYf.js";import"./index-DEclfOQi.js";import"./index-C4OTDIwl.js";import"./index-B298Qu7_.js";import"./index-BZHgS7zr.js";const r=[];for(let s=0;s<256;++s)r.push((s+256).toString(16).slice(1));function re(s,t=0){return(r[s[t+0]]+r[s[t+1]]+r[s[t+2]]+r[s[t+3]]+"-"+r[s[t+4]]+r[s[t+5]]+"-"+r[s[t+6]]+r[s[t+7]]+"-"+r[s[t+8]]+r[s[t+9]]+"-"+r[s[t+10]]+r[s[t+11]]+r[s[t+12]]+r[s[t+13]]+r[s[t+14]]+r[s[t+15]]).toLowerCase()}let A;const de=new Uint8Array(16);function ce(){if(!A){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");A=crypto.getRandomValues.bind(crypto)}return A(de)}const pe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$={randomUUID:pe};function ue(s,t,w){var k;s=s||{};const g=s.random??((k=s.rng)==null?void 0:k.call(s))??ce();if(g.length<16)throw new Error("Random bytes length must be >= 16");return g[6]=g[6]&15|64,g[8]=g[8]&63|128,re(g)}function me(s,t,w){return $.randomUUID&&!t&&!s?$.randomUUID():ue(s)}const ge={class:"p-4 lg:p-10 bg-[#F8FAFC] min-h-screen"},fe={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-10"},xe={class:"flex items-center gap-4"},ve=o("div",{class:"w-14 h-14 bg-primary-600 rounded-2xl flex items-center justify-center shadow-xl shadow-primary-100 rotate-3"},[o("i",{class:"pi pi-truck text-white text-xl"})],-1),he={class:"text-3xl font-[900] text-slate-900 tracking-tight"},be={class:"text-slate-400 font-bold text-xs uppercase tracking-widest"},_e={class:"flex gap-3 bg-white p-2 rounded-2xl shadow-sm border border-slate-100"},ye={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-200/60 overflow-hidden"},we={class:"flex justify-between items-center p-4"},ke={class:"flex items-center gap-4"},Ve={class:"flex flex-col"},Fe={class:"font-black text-slate-800 leading-none mb-1"},Te={class:"text-[10px] font-mono text-slate-400 tracking-tighter"},Ue={class:"flex items-center gap-2"},Ce=o("i",{class:"pi pi-map-marker text-primary-400 text-xs"},null,-1),Se={class:"text-sm font-bold text-slate-600"},Ae={class:"text-xs font-medium text-slate-500"},Ee={class:"flex gap-2 justify-end"},Pe={class:"px-8 py-5 bg-slate-900 text-white flex justify-between items-center relative z-50"},De={class:"flex items-center gap-4"},$e=o("div",{class:"p-2.5 bg-blue-500/20 rounded-xl border border-blue-500/30"},[o("i",{class:"pi pi-truck text-blue-400 text-xl"})],-1),Me={class:"flex flex-col"},Ie={class:"text-sm font-black uppercase tracking-[0.15em] text-white leading-none"},Ne=o("span",{class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1.5 opacity-80 italic"}," Gestion de la flotte ",-1),Le={class:"p-6 bg-white max-h-[80vh] overflow-y-auto scroll-smooth"},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 py-4"},Be={class:"flex flex-col gap-2"},je={for:"type",class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Oe={class:"flex flex-col gap-2"},ze={for:"designation",class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},He={class:"flex flex-col gap-2"},qe={for:"immat",class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},We={class:"flex flex-col gap-2"},Qe={for:"region",class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Ge={class:"flex flex-col gap-2 md:col-span-2"},Ke={for:"date_service",class:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1"},Ze={class:"flex justify-between items-center w-full px-8 py-5 bg-slate-50 border-t border-slate-100"},bt={__name:"Engins",props:{engins:Array,filters:Object,enginTypes:Array,regions:Array},setup(s){const{t}=z(),w=s,g=H(),k=q(),E=h(),v=h(!1),M=h(!1),f=h(!1);h(!1);const b=h({global:{value:null,matchMode:m.CONTAINS},designation:{operator:T.AND,constraints:[{value:null,matchMode:m.STARTS_WITH}]},type:{value:null,matchMode:m.IN},region_id:{value:null,matchMode:m.EQUALS},date_mise_en_service:{operator:T.AND,constraints:[{value:null,matchMode:m.DATE_IS}]}}),I=()=>{b.value={global:{value:null,matchMode:m.CONTAINS},designation:{operator:T.AND,constraints:[{value:null,matchMode:m.STARTS_WITH}]},type:{value:null,matchMode:m.IN},region_id:{value:null,matchMode:m.EQUALS},date_mise_en_service:{operator:T.AND,constraints:[{value:null,matchMode:m.DATE_IS}]}}},P={camion:{icon:"pi-truck",color:"#3B82F6",bg:"#EFF6FF"},moto:{icon:"pi-th-large",color:"#10B981",bg:"#ECFDF5"},fuso:{icon:"pi-box",color:"#F59E0B",bg:"#FFFBEB"},vehicule:{icon:"pi-car",color:"#8B5CF6",bg:"#F5F3FF"},default:{icon:"pi-cog",color:"#64748B",bg:"#F8FAFC"}},_=d=>P[d]||P.default,V=h([]),N=()=>{var i;const d=[{id:"camion",name:"Camion",prefix:"CAM"},{id:"moto",name:"Moto",prefix:"MOT"},{id:"fuso",name:"Fuso",prefix:"FUS"},{id:"vehicule",name:"VÃ©hicule",prefix:"VEH"}];V.value=(i=w.enginTypes)!=null&&i.length?w.enginTypes:d},a=W({id:null,designation:"",immatriculation:"",date_mise_en_service:null,type:null,description:null,region_id:null}),L=d=>{const i=V.value.find(F=>F.id===d.value);i&&i.prefix&&!f.value&&(a.designation=`${i.prefix}-${me().substring(0,6).toUpperCase()}`)},R=()=>{a.reset(),f.value=!1,v.value=!0},B=d=>{a.clearErrors(),Object.assign(a,{...d,date_mise_en_service:d.date_mise_en_service?new Date(d.date_mise_en_service):null}),f.value=!0,v.value=!0},j=()=>{if(M.value=!0,!a.designation||!a.type||!a.region_id)return;const d=f.value?route("engins.update",a.id):route("engins.store");a.transform(i=>({...i,date_mise_en_service:i.date_mise_en_service?i.date_mise_en_service.toISOString().split("T")[0]:null})).submit(f.value?"put":"post",d,{onSuccess:()=>{v.value=!1,g.add({severity:"success",summary:t("common.success"),detail:f.value?t("engins.toast.updateSuccess"):t("engins.toast.createSuccess"),life:3e3})}})},O=d=>{k.require({message:t("engins.confirm.deleteMessage",{name:d.designation}),header:t("engins.confirm.header"),icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{X.delete(route("engins.destroy",d.id))}})};return Q(()=>N()),(d,i)=>(K(),G(Y,null,{default:c(()=>{var F;return[n(e(Z),{title:e(t)("engins.title")},null,8,["title"]),o("div",ge,[o("div",fe,[o("div",xe,[ve,o("div",null,[o("h1",he,u(e(t)("engins.title")),1),o("p",be,u(e(t)("engins.subtitle",{count:((F=s.engins)==null?void 0:F.length)||0})),1)])]),o("div",_e,[n(e(x),{label:e(t)("engins.toolbar.resetFilters"),icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:I,class:"rounded-xl"},null,8,["label"]),n(e(x),{icon:"pi pi-download",text:"",severity:"secondary",onClick:i[0]||(i[0]=l=>E.value.exportCSV()),"aria-label":e(t)("engins.toolbar.export")},null,8,["aria-label"]),n(e(x),{label:e(t)("engins.toolbar.addEngin"),icon:"pi pi-plus",raised:"",onClick:R,class:"rounded-xl px-6"},null,8,["label"])])]),o("div",ye,[n(e(ee),{ref_key:"dt",ref:E,value:s.engins,filters:b.value,"onUpdate:filters":i[2]||(i[2]=l=>b.value=l),dataKey:"id",paginator:!0,rows:15,filterDisplay:"menu",globalFilterFields:["designation","immatriculation","type"],paginatorTemplate:e(t)("dataTable.paginatorTemplate","FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown"),currentPageReportTemplate:e(t)("dataTable.currentPageReportEngins"),class:"ultimate-table",scrollable:"",scrollHeight:"700px"},{header:c(()=>[o("div",we,[n(e(se),{iconPosition:"left"},{default:c(()=>[n(e(ie),{class:"pi pi-search text-primary-500"}),n(e(U),{modelValue:b.value.global.value,"onUpdate:modelValue":i[1]||(i[1]=l=>b.value.global.value=l),placeholder:e(t)("engins.toolbar.searchPlaceholder"),class:"w-full md:w-96 rounded-2xl border-none bg-slate-100"},null,8,["modelValue","placeholder"])]),_:1})])]),default:c(()=>[n(e(y),{field:"designation",header:e(t)("engins.table.designation"),sortable:"",filterField:"designation",frozen:"",class:"min-w-[280px]"},{body:c(({data:l})=>[o("div",ke,[o("div",{style:C({backgroundColor:_(l.type).bg}),class:"w-12 h-12 rounded-xl flex items-center justify-center transition-all group-hover:scale-110"},[o("i",{class:J(["pi",_(l.type).icon]),style:C({color:_(l.type).color})},null,6)],4),o("div",Ve,[o("span",Fe,u(l.designation),1),o("span",Te,u(l.immatriculation||e(t)("engins.common.noPlate")),1)])])]),filter:c(({filterModel:l})=>[n(e(U),{modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,type:"text",class:"p-column-filter",placeholder:e(t)("engins.toolbar.searchByName")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"]),n(e(y),{field:"type",header:e(t)("engins.table.category"),sortable:"",filterField:"type",showFilterMatchModes:!1},{body:c(({data:l})=>[n(e(ne),{value:l.type,style:C({backgroundColor:_(l.type).bg,color:_(l.type).color}),class:"rounded-lg px-3 font-black text-[10px] uppercase border-none"},null,8,["value","style"])]),filter:c(({filterModel:l})=>[n(e(ae),{modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,options:V.value,optionLabel:"name",optionValue:"id",placeholder:e(t)("engins.form.typePlaceholder"),class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"]),n(e(y),{field:"region_id",header:e(t)("engins.table.assignment"),sortable:"",filterField:"region_id"},{body:c(({data:l})=>{var p;return[o("div",Ue,[Ce,o("span",Se,u(((p=l.region)==null?void 0:p.designation)||"--"),1)])]}),filter:c(({filterModel:l})=>[n(e(S),{modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,options:s.regions,optionLabel:"designation",optionValue:"id",placeholder:e(t)("engins.form.regionPlaceholder"),class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),_:1},8,["header"]),n(e(y),{field:"date_mise_en_service",header:e(t)("engins.form.dateAcquisition"),sortable:"",filterField:"date_mise_en_service",dataType:"date"},{body:c(({data:l})=>[o("span",Ae,u(l.date_mise_en_service?new Date(l.date_mise_en_service).toLocaleDateString("fr-FR",{month:"long",year:"numeric"}):"--"),1)]),filter:c(({filterModel:l})=>[n(e(D),{modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,dateFormat:"dd/mm/yy",placeholder:e(t)("engins.form.datePlaceholder"),mask:"99/99/9999"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["header"]),n(e(y),{header:e(t)("engins.table.actions"),alignFrozen:"right",frozen:""},{body:c(({data:l})=>[o("div",Ee,[n(e(x),{icon:"pi pi-pencil",text:"",rounded:"",severity:"info",onClick:p=>B(l)},null,8,["onClick"]),n(e(x),{icon:"pi pi-trash",text:"",rounded:"",severity:"danger",onClick:p=>O(l)},null,8,["onClick"])])]),_:1},8,["header"])]),_:1},8,["value","filters","paginatorTemplate","currentPageReportTemplate"])])]),n(e(te),{visible:v.value,"onUpdate:visible":i[10]||(i[10]=l=>v.value=l),modal:"",header:!1,closable:!1,style:{width:"90vw",maxWidth:"600px"},pt:{root:{class:"rounded-[3rem] overflow-hidden border-none shadow-2xl"},mask:{style:"backdrop-filter: blur(8px)"}}},{footer:c(()=>[o("div",Ze,[n(e(x),{label:e(t)("engins.common.cancel"),icon:"pi pi-times",text:"",severity:"secondary",onClick:i[9]||(i[9]=l=>v.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"},null,8,["label"]),n(e(x),{label:f.value?e(t)("engins.common.update"):e(t)("engins.common.save"),icon:"pi pi-check-circle",severity:"indigo",onClick:j,loading:e(a).processing,class:"px-10 h-14 rounded-2xl shadow-xl shadow-indigo-100 font-black uppercase tracking-widest text-xs"},null,8,["label","loading"])])]),default:c(()=>[o("div",null,[o("div",Pe,[o("div",De,[$e,o("div",Me,[o("h2",Ie,u(f.value?e(t)("engins.dialog.editTitle"):e(t)("engins.dialog.createTitle")),1),Ne])]),n(e(x),{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:i[3]||(i[3]=l=>v.value=!1),class:"text-white hover:bg-white/10"})]),o("div",Le,[o("div",Re,[o("div",Be,[o("label",je,u(e(t)("engins.form.type")),1),n(e(S),{id:"type",modelValue:e(a).type,"onUpdate:modelValue":i[4]||(i[4]=l=>e(a).type=l),options:V.value,optionLabel:"name",optionValue:"id",onChange:L,class:"v11-input w-full",placeholder:e(t)("engins.form.typePlaceholder")},null,8,["modelValue","options","placeholder"])]),o("div",Oe,[o("label",ze,u(e(t)("engins.form.designation")),1),n(e(U),{id:"designation",modelValue:e(a).designation,"onUpdate:modelValue":i[5]||(i[5]=l=>e(a).designation=l),class:"v11-input w-full",placeholder:"Ex: Camion-benne"},null,8,["modelValue"])]),o("div",He,[o("label",qe,u(e(t)("engins.form.immatriculation")),1),n(e(U),{id:"immat",modelValue:e(a).immatriculation,"onUpdate:modelValue":i[6]||(i[6]=l=>e(a).immatriculation=l),class:"v11-input w-full",placeholder:"Ex: 1234AB/01"},null,8,["modelValue"])]),o("div",We,[o("label",Qe,u(e(t)("engins.form.region")),1),n(e(S),{id:"region",modelValue:e(a).region_id,"onUpdate:modelValue":i[7]||(i[7]=l=>e(a).region_id=l),options:s.regions,optionLabel:"designation",optionValue:"id",class:"v11-input w-full",placeholder:e(t)("engins.form.regionPlaceholder")},null,8,["modelValue","options","placeholder"])]),o("div",Ge,[o("label",Ke,u(e(t)("engins.form.dateAcquisition")),1),n(e(D),{id:"date_service",modelValue:e(a).date_mise_en_service,"onUpdate:modelValue":i[8]||(i[8]=l=>e(a).date_mise_en_service=l),dateFormat:"dd/mm/yy",showIcon:"",iconDisplay:"input",class:"v11-calendar w-full",placeholder:e(t)("engins.form.datePlaceholder")},null,8,["modelValue","placeholder"])])])])])]),_:1},8,["visible"]),n(e(le),{position:"bottom-right"}),n(e(oe))]}),_:1}))}};export{bt as default};
