import{T as lt}from"./index-BeMiMaX7.js";import{s as at}from"./index-J7aFQzQg.js";import{s as ot}from"./index-DecA6guR.js";import{s as rt}from"./index-CZOaMDIN.js";import{s as it}from"./index-DjU5rnlX.js";import{s as nt}from"./index-AWt1AWqV.js";import{s as dt}from"./index-LzhPMz77.js";import{s as ct,a as ut}from"./index-YrJ63t72.js";import{s as pt}from"./index-C20p2cSe.js";import{s as mt}from"./index-BOVQwgbQ.js";import{s as _t}from"./index-D82-jNZI.js";import{s as ft,a as vt}from"./index-Dhf6pfmr.js";import{s as bt}from"./index-DzCpZxvp.js";import{s as ht}from"./index-DVIMWJjq.js";import{s as xt}from"./index-DdT1qFJk.js";import{s as yt}from"./index-JNFFLNI-.js";import{r as _,a as gt,b as kt,F as C,c as ee,T as ge,d as w,w as te,e as A,f as y,o as p,i as n,g as r,Z as wt,j as e,t as h,p as T,q as Y,l as f,m as N,n as P,U as Vt,s as F,k as U,h as Z,x as Tt,y as qt}from"./app-B4oSAkVP.js";import{s as Ct}from"./index-CRfXkZE2.js";import{s as St}from"./index-WjAcbiK8.js";import{s as re}from"./index-DzuzenO3.js";import{s as At}from"./index-DTLAliIa.js";import{_ as Ut}from"./AppLayout-CEyAmMP5.js";import{_ as Et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BM7dsjYe.js";import"./index-W2upbyuC.js";import"./index-gwiffqIQ.js";import"./index-DZohkDvD.js";import"./DropdownLink-B59JWmkM.js";const c=R=>(Tt("data-v-d8391372"),R=R(),qt(),R),Dt={class:"quantum-v11-container p-4 lg:p-8 bg-[#f8fafc] min-h-screen"},jt={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},Mt=c(()=>e("div",{class:"flex items-center gap-4"},[e("div",{class:"flex h-16 w-16 items-center justify-center rounded-[1rem] bg-primary-600 shadow-xl shadow-primary-200"},[e("i",{class:"pi pi-briefcase text-2xl text-white"})]),e("div",null,[e("h1",{class:"text-2xl font-black tracking-tighter text-slate-900 uppercase"},[U(" Ordres de Travail "),e("span",{class:"text-primary-600"},"GMAO")]),e("p",{class:"text-slate-500 text-xs font-medium uppercase tracking-widest"},"Planification & Suivi des Tâches")])],-1)),Ot={class:"flex gap-2"},$t={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"},It={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Nt=c(()=>e("div",{class:"w-14 h-14 rounded-xl bg-slate-100 flex items-center justify-center"},[e("i",{class:"pi pi-briefcase text-2xl text-slate-500"})],-1)),Pt={class:"text-2xl font-black text-slate-800"},Ft=c(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Tâches Totales",-1)),Lt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Rt=c(()=>e("div",{class:"w-14 h-14 rounded-xl bg-amber-50 flex items-center justify-center"},[e("i",{class:"pi pi-spin pi-spinner text-2xl text-amber-500"})],-1)),Bt={class:"text-2xl font-black text-slate-800"},zt=c(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"En Cours",-1)),Wt={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm flex items-center gap-5"},Ht=c(()=>e("div",{class:"w-14 h-14 rounded-xl bg-green-50 flex items-center justify-center"},[e("i",{class:"pi pi-check-circle text-2xl text-green-500"})],-1)),Qt={class:"text-2xl font-black text-slate-800"},Gt=c(()=>e("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Terminées",-1)),Jt={class:"card-v11 overflow-hidden border border-slate-200 rounded-2xl bg-white shadow-sm"},Kt={class:"flex flex-col md:flex-row justify-between items-center gap-4 p-4"},Yt={class:"flex items-center gap-2"},Zt=["onClick"],Xt={key:0,class:"flex flex-wrap gap-1"},es={key:0,class:"flex w-fit items-center gap-3 rounded-full bg-slate-50 p-1 pr-4 border border-slate-100"},ts={class:"text-sm font-bold text-slate-700"},ss={key:1,class:"text-slate-400 text-xs italic"},ls={class:"flex items-center gap-2"},as={class:"text-xs font-medium"},os={class:"font-mono text-sm bg-blue-50 text-blue-600 px-2 py-1 rounded-md"},rs={class:"flex justify-end gap-2"},is={class:"p-2 space-y-3"},ns=c(()=>e("span",{class:"text-[10px] font-black uppercase text-slate-400 block border-b pb-2"},"Colonnes actives",-1)),ds={class:"flex flex-col h-[90vh]"},cs={class:"px-8 py-4 bg-slate-900 text-white flex justify-between items-center shrink-0"},us={class:"flex items-center gap-4"},ps=c(()=>e("div",{class:"p-2 bg-blue-500/20 rounded-lg border border-blue-500/30"},[e("i",{class:"pi pi-shield text-blue-400 text-xl"})],-1)),ms={class:"flex flex-col"},_s={class:"text-sm font-black uppercase tracking-widest text-white leading-none"},fs=c(()=>e("span",{class:"text-[9px] text-blue-300 font-bold uppercase tracking-tighter mt-1 italic"},"Console d'administration GMAO v2025",-1)),vs={class:"flex items-center gap-6"},bs={class:"flex flex-col items-end mr-4"},hs=c(()=>e("span",{class:"text-[9px] font-bold text-slate-400 uppercase mb-1"},"Niveau d'urgence",-1)),xs={class:"flex-grow p-8 grid grid-cols-12 gap-8 overflow-y-auto bg-slate-50"},ys={class:"col-span-12 md:col-span-4 space-y-6"},gs={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm space-y-5"},ks=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-primary-600 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-tag"}),U(" Contexte Mission ")],-1)),ws={class:"field"},Vs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Objet de l'intervention",-1)),Ts={class:"field"},qs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Nature des travaux",-1)),Cs={class:"field"},Ss=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Actifs Concernés (Équipements)",-1)),As={class:"field"},Us=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Région Administrative",-1)),Es={class:"field"},Ds=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Département Bénéficiaire",-1)),js={class:"col-span-12 md:col-span-4 space-y-6"},Ms={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm space-y-5"},Os=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-purple-600 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-calendar-clock"}),U(" Planification ")],-1)),$s={class:"field"},Is=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Début Planifié",-1)),Ns={class:"field"},Ps=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Échéance de fin",-1)),Fs={class:"field"},Ls=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Récurrence",-1)),Rs={key:0,class:"field"},Bs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-500 mb-1 block ml-1"},"Intervalle",-1)),zs={class:"p-6 bg-white rounded-2xl border border-slate-200 shadow-sm space-y-4"},Ws=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-slate-600 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-align-left"}),U(" Description ")],-1)),Hs={class:"col-span-12 md:col-span-4 space-y-6"},Qs={class:"p-6 bg-slate-800 text-white rounded-2xl border border-slate-700 shadow-lg space-y-5"},Gs=c(()=>e("h3",{class:"text-xs font-black uppercase tracking-widest text-blue-400 mb-2 flex items-center gap-2"},[e("i",{class:"pi pi-users"}),U(" Logistique & Assignation ")],-1)),Js={class:"field"},Ks=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Responsable",-1)),Ys={class:"flex gap-2"},Zs={class:"field"},Xs=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Statut Opérationnel",-1)),el={class:"field"},tl=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Budget Estimé",-1)),sl={class:"field"},ll=c(()=>e("label",{class:"text-[10px] font-bold uppercase text-slate-400 mb-1 block ml-1"},"Temps d'exécution (min)",-1)),al={class:"pt-4 border-t border-slate-700"},ol={class:"flex items-center gap-3"},rl=c(()=>e("span",{class:"text-xs font-black uppercase tracking-tight"},"Consignation (LOTO)",-1)),il={class:"col-span-12 mt-6"},nl={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"},dl=c(()=>e("div",{class:"px-5 py-3 bg-slate-50/80 border-b border-slate-200 flex items-center justify-between"},[e("h3",{class:"text-xs font-bold uppercase tracking-wider text-slate-600 flex items-center gap-2"},[e("i",{class:"pi pi-wrench text-emerald-500"}),U(" Protocole & Pièces Détachées ")])],-1)),cl={class:"p-5 grid grid-cols-1 lg:grid-cols-2 gap-10"},ul={class:"flex flex-col"},pl={class:"flex justify-between items-center mb-4"},ml={class:"text-sm font-semibold text-slate-800 flex items-center gap-2"},_l={class:"px-2 py-0.5 bg-slate-100 text-slate-500 rounded-full text-[10px]"},fl={key:0,class:"flex-grow flex flex-col items-center justify-center py-10 border-2 border-dashed border-slate-100 rounded-xl bg-slate-50/30"},vl=c(()=>e("i",{class:"pi pi-box text-slate-300 text-3xl mb-2"},null,-1)),bl=c(()=>e("p",{class:"text-xs text-slate-400"},"Aucune pièce requise pour cette intervention",-1)),hl=[vl,bl],xl={key:1,class:"space-y-2 overflow-y-auto max-h-[400px] pr-2"},yl={class:"flex-grow grid grid-cols-12 gap-2"},gl={class:"col-span-8"},kl={key:0,class:"text-xs font-medium truncate"},wl={key:1,class:"text-xs text-slate-400"},Vl={class:"flex flex-col min-w-0"},Tl={class:"text-xs font-bold truncate"},ql={class:"text-[10px] text-slate-500"},Cl={class:"col-span-4"},Sl={class:"p-inputgroup"},Al=c(()=>e("span",{class:"p-inputgroup-addon bg-slate-50 text-[10px]"},"Qté",-1)),Ul={class:"mt-4 pt-4 border-t border-slate-100 flex items-center justify-between"},El={class:"text-right"},Dl=c(()=>e("span",{class:"text-[10px] uppercase font-bold text-slate-400 block tracking-wider"},"Coût Total Estimé",-1)),jl={class:"text-xl font-black text-emerald-600"},Ml={class:"flex flex-col border-l border-slate-100 pl-4 lg:pl-10"},Ol={class:"flex justify-between items-center mb-4"},$l=c(()=>e("h4",{class:"text-sm font-semibold text-slate-800"},"Protocole d'intervention",-1)),Il={class:"flex items-center gap-3 bg-slate-100 px-3 py-1.5 rounded-full"},Nl=c(()=>e("label",{for:"advanced-instr",class:"text-[10px] font-bold text-slate-600 uppercase"},"Mode Avancé",-1)),Pl={class:"flex-grow"},Fl={key:0,class:"h-full flex flex-col items-center justify-center py-10 bg-slate-50/50 rounded-xl border-2 border-dashed border-slate-100"},Ll=c(()=>e("p",{class:"text-xs text-slate-400 text-center max-w-[200px]"},"Activez le mode avancé pour définir les étapes techniques.",-1)),Rl=[Ll],Bl={key:1,class:"space-y-4 max-h-[450px] overflow-y-auto pr-2"},zl=["onClick"],Wl={class:"text-xs font-bold text-slate-700 uppercase"},Hl={key:0,class:"p-3 bg-slate-50/50 space-y-3 border-t border-slate-100"},Ql={class:"flex justify-between items-center mb-3"},Gl={class:"text-xs font-extrabold text-emerald-700"},Jl={class:"flex gap-1"},Kl={class:"space-y-2"},Yl={class:"flex-grow space-y-2"},Zl={class:"flex gap-2"},Xl={class:"flex items-center gap-2 px-2 bg-white border border-slate-200 rounded text-[10px] w-[80px]"},ea=c(()=>e("span",null,"Requis",-1)),ta={class:"shrink-0 flex justify-between items-center w-full px-8 py-4 bg-white/50 backdrop-blur-md border-t border-slate-200"},sa={key:0},la={class:"mb-4"},aa={class:"max-h-64 overflow-y-auto space-y-3 p-3 bg-slate-100 rounded-lg"},oa={key:0,class:"text-center text-sm text-slate-500 py-4"},ra={class:"font-bold text-sm mb-2"},ia={class:"pl-4 space-y-2"},na=["for"],da={class:"p-fluid"},ca={class:"field"},ua=c(()=>e("label",{for:"spare_part_name",class:"font-semibold"},"Nom",-1)),pa={class:"p-error"},ma={class:"field"},_a=c(()=>e("label",{for:"spare_part_reference",class:"font-semibold"},"Référence",-1)),fa={class:"p-error"},va={class:"field"},ba=c(()=>e("label",{for:"spare_part_category",class:"font-semibold"},"Catégorie",-1)),ha={class:"p-error"},xa={class:"field"},ya=c(()=>e("label",{for:"spare_part_stock_quantity",class:"font-semibold"},"Quantité en stock",-1)),ga={class:"p-error"},ka={class:"field"},wa=c(()=>e("label",{for:"spare_part_unit_estimated_cost",class:"font-semibold"},"Coût unitaire",-1)),Va={class:"p-error"},Ta={__name:"Tasks",props:{tasks:Object,filters:Object,equipments:Array,users:Array,teams:Object,regions:Array,departments:Array,equipmentTree:Array,spareParts:Array,categories:Array},setup(R){var be;_(1);const g=R,S=gt(),ie=kt(),E=_(!1),ne=_(!1),X=_(!1),ke=_(((be=g.filters)==null?void 0:be.search)||""),de=_(),D=_([]),ce=_(),ue=_([{field:"title",header:"Titre"},{field:"equipments",header:"Équipement(s)"},{field:"assignable",header:"Assigné à"},{field:"status",header:"Statut"},{field:"priority",header:"Priorité"},{field:"planned_start_date",header:"Début Planifié"}]),j=_(ue.value.map(s=>s.field)),B=_({global:{value:null,matchMode:C.CONTAINS},title:{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},"assignable.name":{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},status:{value:null,matchMode:C.EQUALS},priority:{value:null,matchMode:C.EQUALS}}),we=()=>{B.value={global:{value:null,matchMode:C.CONTAINS},title:{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},"assignable.name":{operator:ee.AND,constraints:[{value:null,matchMode:C.STARTS_WITH}]},status:{value:null,matchMode:C.EQUALS},priority:{value:null,matchMode:C.EQUALS}},ke.value=""};_([]);const z=_({}),W=_(!1),H=_(!1),M=_(null),$=_({}),se=_({}),Q=_(!1),x=ge({name:"",reference:"",category_id:null,stock_quantity:0,unit_estimated_cost:0}),l=ge({id:null,title:"",description:"",assignable_type:null,assignable_id:null,maintenance_type:"Préventive",status:"Planifiée",priority:"Moyenne",planned_start_date:null,planned_end_date:null,time_spent:null,estimated_cost:null,region_id:null,recurrence_type:null,recurrence_interval:null,recurrence_month_interval:null,recurrence_days:[],recurrence_day_of_month:null,recurrence_month:null,reminder_days:null,custom_recurrence_config:null,requester_department:null,department:"",requires_shutdown:!0,instructions:{},equipment_ids:[],related_equipments:{},jobber:0,service_order_description:"x",service_order_cost:0,spare_parts:[]}),Ve=_(["Préventive","Corrective","Améliorative","Périodique"]),pe=_(["Planifiée","En cours","En attente","Terminée","Annulée","En retard"]),Te=_(["Basse","Moyenne","Haute","Urgente"]),qe=_([{label:"Aucun",value:null},{label:"Technicien",value:"App\\Models\\User"},{label:"Équipe",value:"App\\Models\\Team"}]),Ce=w(()=>l.assignable_type==="App\\Models\\User"?g.users:l.assignable_type==="App\\Models\\Team"?g.teams:[]),Se=_([{label:"Aucune",value:null},{label:"Quotidienne",value:"daily"},{label:"Hebdomadaire",value:"weekly"},{label:"Mensuelle",value:"monthly"},{label:"Trimestrielle",value:"quarterly"},{label:"Semestrielle",value:"biannual"},{label:"Annuelle",value:"annual"},{label:"Personnalisée",value:"custom"}]);_([{label:"Lundi",value:1},{label:"Mardi",value:2},{label:"Mercredi",value:3},{label:"Jeudi",value:4},{label:"Vendredi",value:5},{label:"Samedi",value:6},{label:"Dimanche",value:0}]);const Ae=_([{label:"Texte",value:"text"},{label:"Nombre",value:"number"},{label:"Date",value:"date"},{label:"Image",value:"image"},{label:"Signature",value:"signature"},{label:"Booléen",value:"boolean"}]);_([{label:"Janvier",value:1},{label:"Février",value:2},{label:"Mars",value:3},{label:"Avril",value:4},{label:"Mai",value:5},{label:"Juin",value:6},{label:"Juillet",value:7},{label:"Août",value:8},{label:"Septembre",value:9},{label:"Octobre",value:10},{label:"Novembre",value:11},{label:"Décembre",value:12}]),te(()=>l.recurrence_type,s=>{l.recurrence_interval=null,l.recurrence_days=[],l.recurrence_day_of_month=null,l.recurrence_month_interval=null,l.recurrence_month=null}),te(()=>l.related_equipments,(s,t)=>{const d=s?Object.keys(s):[];(t?Object.keys(t):[]).forEach(i=>{d.includes(i)||delete l.instructions[i]})}),te(()=>l.related_equipments,s=>{const t={};if(s){const d=Object.keys(s).filter(o=>s[o].checked);I.value.forEach(o=>{d.includes(o.key)&&(t[o.key]=!0)})}z.value=t,s&&Object.keys(s).forEach(d=>{s[d].checked})},{deep:!0});const Ue=()=>{l.reset(),X.value=!1,ne.value=!1,W.value=!1,E.value=!0,z.value={};const s=new Date,t=new Date(s.getFullYear(),s.getMonth(),s.getDate(),7,0),d=new Date(s.getFullYear(),s.getMonth(),s.getDate(),16,0);l.planned_start_date=t,l.planned_end_date=d},me=s=>{l.id=s.id,l.title=s.title,l.description=s.description,l.assignable_type=s.assignable_type,l.assignable_id=s.assignable_id,l.maintenance_type=s.maintenance_type,l.status=s.status,l.priority=s.priority,l.planned_start_date=s.planned_start_date?new Date(s.planned_start_date):null,l.planned_end_date=s.planned_end_date?new Date(s.planned_end_date):null,l.time_spent=s.time_spent,l.estimated_cost=s.estimated_cost,l.region_id=s.region_id,l.recurrence_type=s.recurrence_type,l.recurrence_interval=s.recurrence_interval,l.recurrence_days=s.recurrence_days||[],l.recurrence_day_of_month=s.recurrence_day_of_month,l.recurrence_month_interval=s.recurrence_month_interval,l.recurrence_month=s.recurrence_month,l.reminder_days=s.reminder_days,l.custom_recurrence_config=s.custom_recurrence_config,l.requester_department=s.requester_department,l.department=s.department,l.requires_shutdown=s.requires_shutdown??!0;const t={};s.instructions&&Array.isArray(s.instructions)&&s.instructions.length>0&&s.instructions.forEach(o=>{const i=String(o.equipment_id);t[i]||(t[i]=[]),t[i].push({...o})}),l.instructions=t,l.images=s.images||[];const d={};s.equipments&&s.equipments.forEach(o=>{d[String(o.id)]={checked:!0,partialChecked:!1}}),l.related_equipments=d,s.spare_parts&&Array.isArray(s.spare_parts)?l.spare_parts=s.spare_parts.map(o=>{var i;return{id:o.id,quantity_used:((i=o.pivot)==null?void 0:i.quantity_used)||1}}):l.spare_parts=[],console.log(l.assignable_id),W.value=!1,X.value=!0,E.value=!0},Ee=()=>{if(ne.value=!0,!l.title||!l.related_equipments||!l.maintenance_type){S.add({severity:"error",summary:"Erreur",detail:"Veuillez remplir les champs obligatoires.",life:3e3});return}const s=l.related_equipments,t=Object.keys(l.instructions).flatMap(o=>l.instructions[o].map(i=>({...i,equipment_id:parseInt(o)}))),d={...l.data(),spare_parts:l.spare_parts.map(o=>({id:o.id,quantity_used:o.quantity_used})),related_equipments:s,equipment_ids:Object.keys(s).filter(o=>s[o].checked).map(o=>parseInt(o)),instructions:t,planned_start_date:l.planned_start_date?new Date(l.planned_start_date).toISOString().slice(0,19).replace("T"," "):null,planned_end_date:l.planned_end_date?new Date(l.planned_end_date).toISOString().slice(0,19).replace("T"," "):null};console.log("data"),console.log(d),l.assignable_type||(d.assignable_id=null),d.instructions=t,X.value?Z.put(route("tasks.update",l.id),d,{onSuccess:()=>{E.value=!1,S.add({severity:"success",summary:"Succès",detail:"Ordre de Travail mise à jour avec succès.",life:3e3}),l.reset()},onError:o=>{console.error("Erreur lors de la mise à jour de la maintenance",o),S.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue.",life:3e3}),l.errors=o}}):(console.log(d),Z.post(route("tasks.store"),d,{onSuccess:()=>{E.value=!1,S.add({severity:"success",summary:"Succès",detail:"Ordre de Travail créée avec succès.",life:3e3}),l.reset()},onError:o=>{console.error("Erreur lors de la sauvegarde de la maintenance",o),S.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue.",life:3e3}),l.errors=o}}))},De=s=>{ie.require({message:`Êtes-vous sûr de vouloir supprimer la tâche "${s.title}" ?`,header:"Confirmation de suppression",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{Z.delete(route("tasks.destroy",s.id),{onSuccess:()=>{S.add({severity:"success",summary:"Succès",detail:"Ordre de Travail supprimée.",life:3e3})}})}})},je=()=>{ie.require({message:`Êtes-vous sûr de vouloir supprimer les ${D.value.length} tâches sélectionnées ?`,header:"Confirmation de suppression",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{Z.post(route("tasks.bulkDestroy"),{ids:D.value.map(s=>s.id)},{onSuccess:()=>{S.add({severity:"success",summary:"Succès",detail:"Tâches supprimées avec succès.",life:3e3}),D.value=[]}})}})},Me=()=>{de.value.exportCSV()},Oe=s=>({Planifiée:"info","En cours":"warning",Terminée:"success",Annulée:"secondary","En retard":"danger","En attente":"contrast"})[s]||null,le=s=>({Basse:"info",Moyenne:"success",Haute:"warning",Urgente:"danger"})[s]||null,$e=w(()=>X.value?"Modifier la Ordre de Travail":"Créer une nouvelle Ordre de Travail"),Ie=w(()=>!D.value||D.value.length<2),ae=w(()=>{const s=g.tasks.data.length,t=g.tasks.data.filter(o=>o.status==="En cours").length,d=g.tasks.data.filter(o=>o.status==="Terminée").length;return{total:s,inProgress:t,completed:d}}),I=w(()=>{if(!l.related_equipments||Object.keys(l.related_equipments).length===0)return[];const s=Object.keys(l.related_equipments).filter(o=>l.related_equipments[o]),t=new Map,d=(o,i)=>{if(o.key===i)return o.children&&o.children.length>0?o.children.forEach(u=>{t.has(u.key)||t.set(u.key,u)}):t.has(o.key)||t.set(o.key,o),o;if(o.children)for(const u of o.children){const v=d(u,i);if(v)return v}return null};return s.forEach(o=>{G.value.forEach(i=>d(i,o))}),Array.from(t.values())}),Ne=w(()=>{if(!I.value.length)return[];const s=new Map,t=(d,o)=>{for(const i of d){if(i.children&&i.children.some(u=>u.key===o))return i;if(i.children){const u=t(i.children,o);if(u)return u}}return null};return I.value.forEach(d=>{const o=t(G.value,d.key),i=o?o.key:"root",u=o?o.label:"Équipements de premier niveau";s.has(i)||s.set(i,{parent:{key:i,label:u},children:[]}),s.get(i).children.push(d)}),Array.from(s.values())}),Pe=s=>{se.value[s]=!(se.value[s]??!0)},_e=s=>se.value[s]??!0,Fe=s=>{l.instructions[s]||(l.instructions[s]=[]),l.instructions[s].push({label:"",type:"text",is_required:!1})},Le=(s,t)=>{l.instructions[s]&&l.instructions[s][t]&&l.instructions[s].splice(t,1)},Re=s=>{M.value=s,$.value={},H.value=!0},fe=w(()=>M.value?I.value.find(s=>s.key===M.value):null),Be=w(()=>{const s=M.value;if(!s)return[];const t=new Set(I.value.filter(o=>o.key!==s&&z.value[o.key]).map(o=>o.key)),d=o=>o.map(i=>{const u=i.children?d(i.children):[];return t.has(i.key)||u.length>0?{...i,children:u.length>0?u:void 0}:null}).filter(Boolean);return d(G.value)}),ze=w(()=>{const s=M.value;if(!s)return[];const t=I.value.filter(i=>i.key!==s&&z.value[i.key]),d=new Map,o=(i,u)=>{for(const v of i){if(v.children&&v.children.some(k=>k.key===u))return v;if(v.children){const k=o(v.children,u);if(k)return k}}return null};return t.forEach(i=>{const u=o(G.value,i.key);u&&(d.has(u.key)||d.set(u.key,{parent:u,children:[]}),d.get(u.key).children.push(i))}),Array.from(d.values())}),We=w(()=>M.value?I.value.filter(s=>s.key!==M.value&&z.value[s.key]):[]),He=()=>{const s=l.instructions[M.value];if(!s)return;const t=new Set,d=Object.keys($.value).filter(u=>$.value[u].checked),o=(u,v)=>{for(const k of u){if(k.key===v)return k;if(k.children){const V=o(k.children,v);if(V)return V}}return null},i=u=>{let v=[];return!u.children||u.children.length===0?v.push(u.key):u.children.forEach(k=>{v.push(...i(k))}),v};d.forEach(u=>{const v=o(Be.value,u);v&&i(v).forEach(V=>t.add(V))}),t.forEach(u=>{u&&(l.instructions[u]=JSON.parse(JSON.stringify(s)))}),H.value=!1},Qe=w(()=>Object.keys($.value).filter(s=>$.value[s]).length),G=w(()=>{if(!g.equipmentTree||typeof g.equipmentTree!="object")return[];const s=t=>t?{key:String(t.id),label:t.label,icon:"pi pi-fw pi-cog",children:t.children?t.children.map(s).filter(d=>d):[]}:null;return Object.values(g.equipmentTree).map(s).filter(t=>t)}),Ge=w(()=>{if(!g.departments||!Array.isArray(g.departments))return[];const s=t=>t?{key:t.label,label:t.label,children:t.children?t.children.map(s).filter(d=>d):[]}:null;return g.departments.map(s).filter(t=>t)}),Je=()=>{l.spare_parts.push({id:null,quantity_used:1})},Ke=s=>{l.spare_parts.splice(s,1)},Ye=()=>{x.reset(),Q.value=!0},Ze=()=>{x.post(route("spare-parts.store"),{onSuccess:()=>{Q.value=!1,S.add({severity:"success",summary:"Succès",detail:"Pièce détachée créée avec succès.",life:3e3}),Z.reload({only:["spareParts"]})},onError:s=>{S.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue lors de la création de la pièce détachée.",life:3e3})}})},ve=w(()=>l.spare_parts.reduce((s,t)=>{if(!t.id)return s;const d=g.spareParts.find(i=>i.id===t.id),o=(d==null?void 0:d.unit_estimated_cost)||0;return s+o*(t.quantity_used||0)},0));return te(ve,s=>{l.service_order_cost=s,s>0&&!l.service_order_description&&(l.service_order_description="Paiement des pièces détachées et autres")}),(s,t)=>{const d=yt,o=xt,i=ht,u=ft,v=bt,k=vt,V=ct,he=_t,Xe=mt,q=pt,et=ut,tt=dt,xe=nt,ye=it,L=rt,oe=ot,st=at,J=lt;return p(),A(Ut,{title:"Gestion des Ordre de Travails"},{default:y(()=>[n(r(wt),{title:"Ordres de Travail"}),n(d),n(o),e("div",Dt,[e("div",jt,[Mt,e("div",Ot,[n(i,{label:"Nouvel Ordre de Travail",icon:"pi pi-plus",class:"shadow-lg shadow-primary-200",onClick:Ue})])]),e("div",$t,[e("div",It,[Nt,e("div",null,[e("div",Pt,h(ae.value.total),1),Ft])]),e("div",Lt,[Rt,e("div",null,[e("div",Bt,h(ae.value.inProgress),1),zt])]),e("div",Wt,[Ht,e("div",null,[e("div",Qt,h(ae.value.completed),1),Gt])])]),e("div",Jt,[n(et,{value:g.tasks.data,ref_key:"dt",ref:de,dataKey:"id",selection:D.value,"onUpdate:selection":t[2]||(t[2]=a=>D.value=a),paginator:!0,rows:10,filters:B.value,"onUpdate:filters":t[3]||(t[3]=a=>B.value=a),filterDisplay:"menu",globalFilterFields:["title","assignable.name","status","priority"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:"{first} à {last} sur {totalRecords}",class:"p-datatable-sm quantum-table"},{header:y(()=>[e("div",Kt,[n(k,{iconPosition:"left"},{default:y(()=>[n(u,{class:"pi pi-search text-slate-400"}),n(v,{modelValue:B.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=a=>B.value.global.value=a),placeholder:"Rechercher une tâche...",class:"w-full md:w-80 rounded-2xl border-slate-200 bg-slate-50/50 focus:bg-white"},null,8,["modelValue"])]),_:1}),e("div",Yt,[Ie.value?T("",!0):(p(),A(i,{key:0,label:`Supprimer (${D.value.length})`,icon:"pi pi-trash",severity:"danger",onClick:je},null,8,["label"])),Y(n(i,{icon:"pi pi-filter-slash",outlined:"",severity:"secondary",onClick:we,class:"rounded-xl"},null,512),[[J,"Réinitialiser les filtres",void 0,{bottom:!0}]]),Y(n(i,{icon:"pi pi-download",text:"",rounded:"",severity:"secondary",onClick:Me},null,512),[[J,"Exporter",void 0,{bottom:!0}]]),Y(n(i,{icon:"pi pi-columns",text:"",rounded:"",severity:"secondary",onClick:t[1]||(t[1]=a=>ce.value.toggle(a))},null,512),[[J,"Colonnes",void 0,{bottom:!0}]])])])]),default:y(()=>[n(V,{selectionMode:"multiple",headerStyle:"width: 3rem"}),j.value.includes("title")?(p(),A(V,{key:0,header:"Titre de la tâche",minWidth:"300px"},{body:y(({data:a})=>[e("div",{class:"font-bold text-slate-800 tracking-tight cursor-pointer",onClick:m=>me(a)},h(a.title),9,Zt)]),_:1})):T("",!0),j.value.includes("equipments")?(p(),A(V,{key:1,header:"Équipement(s)",minWidth:"250px"},{body:y(a=>{var m;return[(m=a.data.equipments)!=null&&m.length?(p(),f("div",Xt,[(p(!0),f(N,null,P(a.data.equipments,b=>(p(),A(he,{key:b.id,value:b.designation,class:"!bg-slate-200 !text-slate-700 !font-bold"},null,8,["value"]))),128))])):T("",!0)]}),_:1})):T("",!0),j.value.includes("assignable")?(p(),A(V,{key:2,field:"assignable.name",header:"Assigné à",minWidth:"200px"},{body:y(a=>[a.data.assignable?(p(),f("div",es,[n(Xe,{label:a.data.assignable.name[0],shape:"circle",class:"!bg-slate-900 !text-white !font-black"},null,8,["label"]),e("span",ts,h(a.data.assignable.name),1)])):(p(),f("span",ss,"Non assigné"))]),filter:y(({filterModel:a})=>[n(v,{modelValue:a.constraints[0].value,"onUpdate:modelValue":m=>a.constraints[0].value=m,type:"text",class:"p-column-filter",placeholder:"Filtrer par assigné"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})):T("",!0),j.value.includes("status")?(p(),A(V,{key:3,field:"status",header:"Statut",minWidth:"150px"},{body:y(a=>[n(he,{value:a.data.status,severity:Oe(a.data.status),class:"uppercase text-[9px] px-2"},null,8,["value","severity"])]),filter:y(({filterModel:a})=>[n(q,{modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,options:pe.value,placeholder:"Filtrer par statut",class:"p-column-filter",showClear:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1})):T("",!0),j.value.includes("priority")?(p(),A(V,{key:4,field:"priority",header:"Priorité",minWidth:"150px"},{body:y(({data:a})=>[e("div",ls,[e("div",{class:"w-2 h-2 rounded-full",style:Vt({backgroundColor:le(a.priority)==="danger"?"#ef4444":le(a.priority)==="warning"?"#f59e0b":le(a.priority)==="success"?"#10b981":"#64748b"})},null,4),e("span",as,h(a.priority),1)])]),_:1})):T("",!0),j.value.includes("planned_start_date")?(p(),A(V,{key:5,field:"planned_start_date",header:"Début Planifié",minWidth:"200px"},{body:y(a=>[e("span",os,h(new Date(a.data.planned_start_date).toLocaleString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),_:1})):T("",!0),n(V,{header:"Actions",alignFrozen:"right",frozen:"",class:"pr-8"},{body:y(({data:a})=>[e("div",rs,[Y(n(i,{icon:"pi pi-pencil",text:"",rounded:"",onClick:m=>me(a),class:"!text-slate-400 hover:!bg-primary-50 hover:!text-primary-600 transition-all"},null,8,["onClick"]),[[J,"Modifier",void 0,{top:!0}]]),Y(n(i,{icon:"pi pi-trash",text:"",rounded:"",onClick:m=>De(a),class:"!text-slate-400 hover:!bg-red-50 hover:!text-red-500 transition-all"},null,8,["onClick"]),[[J,"Supprimer",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","selection","filters"])])]),n(r(Ct),{ref_key:"op",ref:ce,class:"quantum-overlay"},{default:y(()=>[e("div",is,[ns,n(r(St),{modelValue:j.value,"onUpdate:modelValue":t[4]||(t[4]=a=>j.value=a),options:ue.value,optionLabel:"header",optionValue:"field",display:"chip",class:"w-64 quantum-multiselect"},null,8,["modelValue","options"])])]),_:1},512),n(r(re),{visible:E.value,"onUpdate:visible":t[26]||(t[26]=a=>E.value=a),modal:"",header:!1,closable:!1,class:"quantum-dialog w-full max-w-7xl overflow-hidden",pt:{root:{class:"border-none shadow-3xl bg-white rounded-xl"},mask:{style:"backdrop-filter: blur(15px); background: rgba(15, 23, 42, 0.8)"}}},{default:y(()=>[e("div",ds,[e("div",cs,[e("div",us,[ps,e("div",ms,[e("h2",_s,h($e.value),1),fs])]),e("div",vs,[e("div",bs,[hs,n(tt,{modelValue:r(l).priority,"onUpdate:modelValue":t[5]||(t[5]=a=>r(l).priority=a),options:Te.value,class:"p-selectbutton-sm custom-dark-priority"},null,8,["modelValue","options"])]),n(i,{icon:"pi pi-times",variant:"text",severity:"secondary",rounded:"",onClick:t[6]||(t[6]=a=>E.value=!1),class:"text-white hover:bg-white/10"})])]),e("div",xs,[e("div",ys,[e("div",gs,[ks,e("div",ws,[Vs,n(v,{modelValue:r(l).title,"onUpdate:modelValue":t[7]||(t[7]=a=>r(l).title=a),class:"w-full",placeholder:"Ex: Remplacement des filtres..."},null,8,["modelValue"])]),e("div",Ts,[qs,n(q,{modelValue:r(l).maintenance_type,"onUpdate:modelValue":t[8]||(t[8]=a=>r(l).maintenance_type=a),options:Ve.value,class:"w-full"},null,8,["modelValue","options"])]),e("div",Cs,[Ss,n(xe,{modelValue:r(l).related_equipments,"onUpdate:modelValue":t[9]||(t[9]=a=>r(l).related_equipments=a),options:G.value,selectionMode:"checkbox",display:"chip",placeholder:"Choisir les équipements",class:"w-full"},null,8,["modelValue","options"])]),e("div",As,[Us,n(q,{modelValue:r(l).region_id,"onUpdate:modelValue":t[10]||(t[10]=a=>r(l).region_id=a),options:g.regions,optionLabel:"designation",optionValue:"id",filter:"",class:"w-full"},null,8,["modelValue","options"])]),e("div",Es,[Ds,n(xe,{modelValue:r(l).department,"onUpdate:modelValue":t[11]||(t[11]=a=>r(l).department=a),options:Ge.value,placeholder:"Service",class:"w-full"},null,8,["modelValue","options"])])])]),e("div",js,[e("div",Ms,[Os,e("div",$s,[Is,n(ye,{modelValue:r(l).planned_start_date,"onUpdate:modelValue":t[12]||(t[12]=a=>r(l).planned_start_date=a),showTime:"",hourFormat:"24",class:"w-full"},null,8,["modelValue"])]),e("div",Ns,[Ps,n(ye,{modelValue:r(l).planned_end_date,"onUpdate:modelValue":t[13]||(t[13]=a=>r(l).planned_end_date=a),showTime:"",hourFormat:"24",class:"w-full"},null,8,["modelValue"])]),e("div",Fs,[Ls,n(q,{modelValue:r(l).recurrence_type,"onUpdate:modelValue":t[14]||(t[14]=a=>r(l).recurrence_type=a),options:Se.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),r(l).recurrence_type?(p(),f("div",Rs,[Bs,n(L,{modelValue:r(l).recurrence_interval,"onUpdate:modelValue":t[15]||(t[15]=a=>r(l).recurrence_interval=a),class:"w-full",suffix:" cycles"},null,8,["modelValue"])])):T("",!0)]),e("div",zs,[Ws,n(r(At),{modelValue:r(l).description,"onUpdate:modelValue":t[16]||(t[16]=a=>r(l).description=a),rows:"5",class:"w-full text-sm",placeholder:"Notes additionnelles pour l'équipe terrain..."},null,8,["modelValue"])])]),e("div",Hs,[e("div",Qs,[Gs,e("div",Js,[Ks,e("div",Ys,[n(q,{modelValue:r(l).assignable_type,"onUpdate:modelValue":t[17]||(t[17]=a=>r(l).assignable_type=a),options:qe.value,optionLabel:"label",optionValue:"value",class:"w-1/2"},null,8,["modelValue","options"]),n(q,{modelValue:r(l).assignable_id,"onUpdate:modelValue":t[18]||(t[18]=a=>r(l).assignable_id=a),options:Ce.value,optionLabel:"name",optionValue:"id",filter:"",class:"w-1/2"},null,8,["modelValue","options"])])]),e("div",Zs,[Xs,n(q,{modelValue:r(l).status,"onUpdate:modelValue":t[19]||(t[19]=a=>r(l).status=a),options:pe.value,class:"w-full"},null,8,["modelValue","options"])]),e("div",el,[tl,n(L,{modelValue:r(l).estimated_cost,"onUpdate:modelValue":t[20]||(t[20]=a=>r(l).estimated_cost=a),mode:"currency",currency:"USD",locale:"fr-FR",class:"w-full"},null,8,["modelValue"])]),e("div",sl,[ll,n(L,{modelValue:r(l).time_spent,"onUpdate:modelValue":t[21]||(t[21]=a=>r(l).time_spent=a),suffix:" min",class:"w-full"},null,8,["modelValue"])]),e("div",al,[e("div",{class:F(["p-4 rounded-xl border-2 transition-all duration-300 cursor-pointer",r(l).requires_shutdown?"bg-red-900/50 border-red-700":"bg-slate-700/50 border-transparent"]),onClick:t[23]||(t[23]=a=>r(l).requires_shutdown=!r(l).requires_shutdown)},[e("div",ol,[n(oe,{modelValue:r(l).requires_shutdown,"onUpdate:modelValue":t[22]||(t[22]=a=>r(l).requires_shutdown=a),binary:!0},null,8,["modelValue"]),rl])],2)])])]),e("div",il,[e("div",nl,[dl,e("div",cl,[e("div",ul,[e("div",pl,[e("h4",ml,[U(" Inventaire des pièces "),e("span",_l,h(r(l).spare_parts.length),1)]),n(i,{icon:"pi pi-plus",label:"Ajouter",severity:"primary",size:"small",onClick:Je,class:"p-button-sm"})]),r(l).spare_parts.length===0?(p(),f("div",fl,hl)):(p(),f("div",xl,[(p(!0),f(N,null,P(r(l).spare_parts,(a,m)=>(p(),f("div",{key:m,class:"group flex items-start gap-2 p-3 bg-white border border-slate-200 rounded-lg hover:border-emerald-200 transition-colors shadow-sm"},[e("div",yl,[e("div",gl,[n(q,{modelValue:a.id,"onUpdate:modelValue":b=>a.id=b,options:g.spareParts,optionValue:"id",filter:"",placeholder:"Rechercher une pièce...",class:"w-full p-inputtext-sm custom-dropdown",scrollHeight:"250px"},{value:y(b=>{var K;return[b.value?(p(),f("div",kl,h(((K=g.spareParts.find(O=>O.id===b.value))==null?void 0:K.reference)||"Sélectionné"),1)):(p(),f("span",wl,h(b.placeholder),1))]}),option:y(b=>[e("div",Vl,[e("span",Tl,h(b.option.designation),1),e("span",ql,h(b.option.reference),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),e("div",Cl,[e("div",Sl,[Al,n(L,{modelValue:a.quantity_used,"onUpdate:modelValue":b=>a.quantity_used=b,min:1,class:"p-inputtext-sm w-full"},null,8,["modelValue","onUpdate:modelValue"])])])]),n(i,{icon:"pi pi-trash",severity:"danger",text:"",size:"small",onClick:b=>Ke(m),class:"opacity-0 group-hover:opacity-100 transition-opacity"},null,8,["onClick"])]))),128))])),e("div",Ul,[n(i,{label:"Créer nouveau",icon:"pi pi-external-link",severity:"secondary",text:"",size:"small",onClick:Ye}),e("div",El,[Dl,e("p",jl,h(new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(ve.value)),1)])])]),e("div",Ml,[e("div",Ol,[$l,e("div",Il,[Nl,n(st,{modelValue:W.value,"onUpdate:modelValue":t[24]||(t[24]=a=>W.value=a),scale:"0.8"},null,8,["modelValue"])])]),e("div",Pl,[W.value?(p(),f("div",Bl,[(p(!0),f(N,null,P(Ne.value,a=>(p(),f("div",{key:a.parent.key,class:"border border-slate-200 rounded-xl overflow-hidden shadow-sm"},[e("div",{onClick:m=>Pe(a.parent.key),class:"flex justify-between items-center px-4 py-3 bg-white hover:bg-slate-50 cursor-pointer transition-colors"},[e("span",Wl,h(a.parent.label),1),e("i",{class:F(["pi text-[10px] transition-transform duration-200",_e(a.parent.key)?"pi-chevron-down":"pi-chevron-right"])},null,2)],8,zl),_e(a.parent.key)?(p(),f("div",Hl,[(p(!0),f(N,null,P(a.children,m=>(p(),f("div",{key:m.key,class:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm"},[e("div",Ql,[e("span",Gl,h(m.label),1),e("div",Jl,[n(i,{icon:"pi pi-plus",size:"small",severity:"success",text:"",rounded:"",onClick:b=>Fe(m.key)},null,8,["onClick"]),n(i,{icon:"pi pi-copy",size:"small",severity:"secondary",text:"",rounded:"",onClick:b=>Re(m.key)},null,8,["onClick"])])]),e("div",Kl,[(p(!0),f(N,null,P(r(l).instructions[m.key],(b,K)=>(p(),f("div",{key:K,class:"flex gap-2 items-start bg-slate-50 p-2 rounded border border-slate-100"},[e("div",Yl,[n(v,{modelValue:b.label,"onUpdate:modelValue":O=>b.label=O,placeholder:"Action à réaliser...",class:"w-full p-inputtext-sm text-xs"},null,8,["modelValue","onUpdate:modelValue"]),e("div",Zl,[n(q,{modelValue:b.type,"onUpdate:modelValue":O=>b.type=O,options:Ae.value,optionLabel:"label",optionValue:"value",class:"flex-1 p-inputtext-sm text-xs"},null,8,["modelValue","onUpdate:modelValue","options"]),e("div",Xl,[n(oe,{modelValue:b.is_required,"onUpdate:modelValue":O=>b.is_required=O,binary:!0},null,8,["modelValue","onUpdate:modelValue"]),ea])])]),n(i,{icon:"pi pi-times",severity:"danger",text:"",size:"small",onClick:O=>Le(m.key,K)},null,8,["onClick"])]))),128))])]))),128))])):T("",!0)]))),128))])):(p(),f("div",Fl,Rl))])])])])])]),e("div",ta,[n(i,{label:"Annuler",icon:"pi pi-times",severity:"secondary",text:"",onClick:t[25]||(t[25]=a=>E.value=!1),class:"font-bold uppercase text-[10px] tracking-widest"}),n(i,{label:"Enregistrer l'Ordre",icon:"pi pi-check-circle",severity:"primary",onClick:Ee,loading:r(l).processing,class:"px-8 h-12 rounded-xl shadow-lg shadow-primary-100 font-black uppercase text-xs"},null,8,["loading"])])])]),_:1},8,["visible"]),n(r(re),{visible:H.value,"onUpdate:visible":t[28]||(t[28]=a=>H.value=a),modal:"",header:"Copier les instructions",style:{width:"40rem"}},{footer:y(()=>[n(i,{label:"Annuler",icon:"pi pi-times",onClick:t[27]||(t[27]=a=>H.value=!1),class:"p-button-text"}),n(i,{label:"Appliquer la copie",icon:"pi pi-check",onClick:He,disabled:!Qe.value},null,8,["disabled"])]),default:y(()=>[fe.value?(p(),f("div",sa,[e("p",la,[U("Copier les instructions de "),e("strong",null,h(fe.value.label),1),U(" vers :")]),e("div",aa,[We.value.length===0?(p(),f("div",oa," Aucune autre destination disponible. ")):T("",!0),(p(!0),f(N,null,P(ze.value,a=>(p(),f("div",{key:a.parent.key},[e("div",ra,h(a.parent.label),1),e("div",ia,[(p(!0),f(N,null,P(a.children,m=>(p(),f("div",{key:m.key,class:"flex items-center"},[n(oe,{modelValue:$.value[m.key],"onUpdate:modelValue":b=>$.value[m.key]=b,inputId:`target-${m.key}`,binary:!0},null,8,["modelValue","onUpdate:modelValue","inputId"]),e("label",{for:`target-${m.key}`,class:"ml-2"},h(m.label),9,na)]))),128))])]))),128))])])):T("",!0)]),_:1},8,["visible"]),n(r(re),{visible:Q.value,"onUpdate:visible":t[35]||(t[35]=a=>Q.value=a),modal:"",header:"Créer une nouvelle pièce détachée",style:{width:"30rem"}},{footer:y(()=>[n(i,{label:"Annuler",icon:"pi pi-times",onClick:t[34]||(t[34]=a=>Q.value=!1),class:"p-button-text"}),n(i,{label:"Créer",icon:"pi pi-check",onClick:Ze,loading:r(x).processing},null,8,["loading"])]),default:y(()=>[e("div",da,[e("div",ca,[ua,n(v,{id:"spare_part_name",modelValue:r(x).name,"onUpdate:modelValue":t[29]||(t[29]=a=>r(x).name=a),modelModifiers:{trim:!0},class:F({"p-invalid":r(x).errors.name})},null,8,["modelValue","class"]),e("small",pa,h(r(x).errors.name),1)]),e("div",ma,[_a,n(v,{id:"spare_part_reference",modelValue:r(x).reference,"onUpdate:modelValue":t[30]||(t[30]=a=>r(x).reference=a),modelModifiers:{trim:!0},class:F({"p-invalid":r(x).errors.reference})},null,8,["modelValue","class"]),e("small",fa,h(r(x).errors.reference),1)]),e("div",va,[ba,n(q,{id:"spare_part_category",modelValue:r(x).category_id,"onUpdate:modelValue":t[31]||(t[31]=a=>r(x).category_id=a),options:g.categories,optionLabel:"designation",optionValue:"id",placeholder:"Sélectionner une catégorie",class:F({"p-invalid":r(x).errors.category_id})},null,8,["modelValue","options","class"]),e("small",ha,h(r(x).errors.category_id),1)]),e("div",xa,[ya,n(L,{id:"spare_part_stock_quantity",modelValue:r(x).stock_quantity,"onUpdate:modelValue":t[32]||(t[32]=a=>r(x).stock_quantity=a),min:0,class:F({"p-invalid":r(x).errors.stock_quantity})},null,8,["modelValue","class"]),e("small",ga,h(r(x).errors.stock_quantity),1)]),e("div",ka,[wa,n(L,{id:"spare_part_unit_estimated_cost",modelValue:r(x).unit_estimated_cost,"onUpdate:modelValue":t[33]||(t[33]=a=>r(x).unit_estimated_cost=a),mode:"currency",currency:"USD",locale:"fr-FR",min:0,class:F({"p-invalid":r(x).errors.unit_estimated_cost})},null,8,["modelValue","class"]),e("small",Va,h(r(x).errors.unit_estimated_cost),1)])])]),_:1},8,["visible"])]),_:1})}}},eo=Et(Ta,[["__scopeId","data-v-d8391372"]]);export{eo as default};
